import{Fragment as e,__plugin_vue_export_helper_default as t,computed as n,createApp as r,createBaseVNode as i,createCommentVNode as a,createElementBlock as o,createPinia as s,defineComponent as c,nextTick as l,normalizeClass as u,onMounted as d,onUnmounted as f,openBlock as p,reactive as m,ref as h,renderList as g,toDisplayString as _}from"./_plugin-vue_export-helper-VRlke_gh.js";var v=Object.create,y=Object.defineProperty,b=Object.getOwnPropertyDescriptor,x=Object.getOwnPropertyNames,S=Object.getPrototypeOf,C=Object.prototype.hasOwnProperty,w=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),T=(e,t,n,r)=>{if(t&&typeof t==`object`||typeof t==`function`)for(var i=x(t),a=0,o=i.length,s;a<o;a++)s=i[a],!C.call(e,s)&&s!==n&&y(e,s,{get:(e=>t[e]).bind(null,s),enumerable:!(r=b(t,s))||r.enumerable});return e},E=(e,t,n)=>(n=e==null?{}:v(S(e)),T(t||!e||!e.__esModule?y(n,`default`,{value:e,enumerable:!0}):n,e)),D=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports._registerNode=exports.Konva=exports.glob=void 0;let t=Math.PI/180;function n(){return typeof window<`u`&&({}.toString.call(window)===`[object Window]`||{}.toString.call(window)===`[object global]`)}exports.glob=typeof global<`u`?global:typeof window<`u`?window:typeof WorkerGlobalScope<`u`?self:{},exports.Konva={_global:exports.glob,version:`9.3.22`,isBrowser:n(),isUnminified:/param/.test(function(e){}.toString()),dblClickWindow:400,getAngle(n){return exports.Konva.angleDeg?n*t:n},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<`u`&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return exports.Konva.DD.isDragging},isTransforming(){var t;return(t=exports.Konva.Transformer)?.isTransforming()},isDragReady(){return!!exports.Konva.DD.node},releaseCanvasOnDestroy:!0,document:exports.glob.document,_injectGlobal(t){exports.glob.Konva=t}};let r=t=>{exports.Konva[t.prototype.getClassName()]=t};exports._registerNode=r,exports.Konva._injectGlobal(exports.Konva)}),O=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Util=exports.Transform=void 0;let t=D();var n=class t{constructor(e=[1,0,0,1,0,0]){this.dirty=!1,this.m=e&&e.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new t(this.m)}copyInto(e){e.m[0]=this.m[0],e.m[1]=this.m[1],e.m[2]=this.m[2],e.m[3]=this.m[3],e.m[4]=this.m[4],e.m[5]=this.m[5]}point(e){let t=this.m;return{x:t[0]*e.x+t[2]*e.y+t[4],y:t[1]*e.x+t[3]*e.y+t[5]}}translate(e,t){return this.m[4]+=this.m[0]*e+this.m[2]*t,this.m[5]+=this.m[1]*e+this.m[3]*t,this}scale(e,t){return this.m[0]*=e,this.m[1]*=e,this.m[2]*=t,this.m[3]*=t,this}rotate(e){let t=Math.cos(e),n=Math.sin(e),r=this.m[0]*t+this.m[2]*n,i=this.m[1]*t+this.m[3]*n,a=this.m[0]*-n+this.m[2]*t,o=this.m[1]*-n+this.m[3]*t;return this.m[0]=r,this.m[1]=i,this.m[2]=a,this.m[3]=o,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(e,t){let n=this.m[0]+this.m[2]*t,r=this.m[1]+this.m[3]*t,i=this.m[2]+this.m[0]*e,a=this.m[3]+this.m[1]*e;return this.m[0]=n,this.m[1]=r,this.m[2]=i,this.m[3]=a,this}multiply(e){let t=this.m[0]*e.m[0]+this.m[2]*e.m[1],n=this.m[1]*e.m[0]+this.m[3]*e.m[1],r=this.m[0]*e.m[2]+this.m[2]*e.m[3],i=this.m[1]*e.m[2]+this.m[3]*e.m[3],a=this.m[0]*e.m[4]+this.m[2]*e.m[5]+this.m[4],o=this.m[1]*e.m[4]+this.m[3]*e.m[5]+this.m[5];return this.m[0]=t,this.m[1]=n,this.m[2]=r,this.m[3]=i,this.m[4]=a,this.m[5]=o,this}invert(){let e=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),t=this.m[3]*e,n=-this.m[1]*e,r=-this.m[2]*e,i=this.m[0]*e,a=e*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),o=e*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=t,this.m[1]=n,this.m[2]=r,this.m[3]=i,this.m[4]=a,this.m[5]=o,this}getMatrix(){return this.m}decompose(){let t=this.m[0],n=this.m[1],r=this.m[2],i=this.m[3],a=this.m[4],o=this.m[5],s=t*i-n*r,c={x:a,y:o,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!=0||n!=0){let e=Math.sqrt(t*t+n*n);c.rotation=n>0?Math.acos(t/e):-Math.acos(t/e),c.scaleX=e,c.scaleY=s/e,c.skewX=(t*r+n*i)/s,c.skewY=0}else if(r!=0||i!=0){let e=Math.sqrt(r*r+i*i);c.rotation=Math.PI/2-(i>0?Math.acos(-r/e):-Math.acos(r/e)),c.scaleX=s/e,c.scaleY=e,c.skewX=0,c.skewY=(t*r+n*i)/s}return c.rotation=exports.Util._getRotation(c.rotation),c}};exports.Transform=n;let r=`[object Array]`,i=`[object Number]`,a=`[object String]`,o=`[object Boolean]`,s=Math.PI/180,c=180/Math.PI,l=`#`,u=``,d=`0`,f=`Konva warning: `,p=`Konva error: `,m=`rgb(`,h={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},g=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/,_=[],v=typeof requestAnimationFrame<`u`&&requestAnimationFrame||function(e){setTimeout(e,60)};exports.Util={_isElement(e){return!!(e&&e.nodeType==1)},_isFunction(e){return!!(e&&e.constructor&&e.call&&e.apply)},_isPlainObject(e){return!!e&&e.constructor===Object},_isArray(e){return Object.prototype.toString.call(e)===r},_isNumber(e){return Object.prototype.toString.call(e)===i&&!isNaN(e)&&isFinite(e)},_isString(e){return Object.prototype.toString.call(e)===a},_isBoolean(e){return Object.prototype.toString.call(e)===o},isObject(e){return e instanceof Object},isValidSelector(e){if(typeof e!=`string`)return!1;let t=e[0];return t===`#`||t===`.`||t===t.toUpperCase()},_sign(e){return e===0||e>0?1:-1},requestAnimFrame(e){_.push(e),_.length===1&&v(function(){let e=_;_=[],e.forEach(function(e){e()})})},createCanvasElement(){let e=document.createElement(`canvas`);try{e.style=e.style||{}}catch{}return e},createImageElement(){return document.createElement(`img`)},_isInDocument(e){for(;e=e.parentNode;)if(e==document)return!0;return!1},_urlToImage(t,n){let r=exports.Util.createImageElement();r.onload=function(){n(r)},r.src=t},_rgbToHex(e,t,n){return((1<<24)+(e<<16)+(t<<8)+n).toString(16).slice(1)},_hexToRgb(e){e=e.replace(l,u);let t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:t&255}},getRandomColor(){let e=(Math.random()*16777215<<0).toString(16);for(;e.length<6;)e=d+e;return l+e},getRGB(e){let t;return e in h?(t=h[e],{r:t[0],g:t[1],b:t[2]}):e[0]===l?this._hexToRgb(e.substring(1)):e.substr(0,4)===m?(t=g.exec(e.replace(/ /g,``)),{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}):{r:0,g:0,b:0}},colorToRGBA(t){return t||=`black`,exports.Util._namedColorToRBA(t)||exports.Util._hex3ColorToRGBA(t)||exports.Util._hex4ColorToRGBA(t)||exports.Util._hex6ColorToRGBA(t)||exports.Util._hex8ColorToRGBA(t)||exports.Util._rgbColorToRGBA(t)||exports.Util._rgbaColorToRGBA(t)||exports.Util._hslColorToRGBA(t)},_namedColorToRBA(e){let t=h[e.toLowerCase()];return t?{r:t[0],g:t[1],b:t[2],a:1}:null},_rgbColorToRGBA(e){if(e.indexOf(`rgb(`)===0){e=e.match(/rgb\(([^)]+)\)/)[1];let t=e.split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:1}}},_rgbaColorToRGBA(e){if(e.indexOf(`rgba(`)===0){e=e.match(/rgba\(([^)]+)\)/)[1];let t=e.split(/ *, */).map((e,t)=>e.slice(-1)===`%`?t===3?parseInt(e)/100:parseInt(e)/100*255:Number(e));return{r:t[0],g:t[1],b:t[2],a:t[3]}}},_hex8ColorToRGBA(e){if(e[0]===`#`&&e.length===9)return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:parseInt(e.slice(7,9),16)/255}},_hex6ColorToRGBA(e){if(e[0]===`#`&&e.length===7)return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:1}},_hex4ColorToRGBA(e){if(e[0]===`#`&&e.length===5)return{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16),a:parseInt(e[4]+e[4],16)/255}},_hex3ColorToRGBA(e){if(e[0]===`#`&&e.length===4)return{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16),a:1}},_hslColorToRGBA(e){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(e)){let[t,...n]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e),r=Number(n[0])/360,i=Number(n[1])/100,a=Number(n[2])/100,o,s,c;if(i===0)return c=a*255,{r:Math.round(c),g:Math.round(c),b:Math.round(c),a:1};o=a<.5?a*(1+i):a+i-a*i;let l=2*a-o,u=[0,0,0];for(let e=0;e<3;e++)s=r+1/3*-(e-1),s<0&&s++,s>1&&s--,c=6*s<1?l+(o-l)*6*s:2*s<1?o:3*s<2?l+(o-l)*(2/3-s)*6:l,u[e]=c*255;return{r:Math.round(u[0]),g:Math.round(u[1]),b:Math.round(u[2]),a:1}}},haveIntersection(e,t){return!(t.x>e.x+e.width||t.x+t.width<e.x||t.y>e.y+e.height||t.y+t.height<e.y)},cloneObject(e){let t={};for(let n in e)this._isPlainObject(e[n])?t[n]=this.cloneObject(e[n]):this._isArray(e[n])?t[n]=this.cloneArray(e[n]):t[n]=e[n];return t},cloneArray(e){return e.slice(0)},degToRad(e){return e*s},radToDeg(e){return e*c},_degToRad(t){return exports.Util.warn(`Util._degToRad is removed. Please use public Util.degToRad instead.`),exports.Util.degToRad(t)},_radToDeg(t){return exports.Util.warn(`Util._radToDeg is removed. Please use public Util.radToDeg instead.`),exports.Util.radToDeg(t)},_getRotation(n){return t.Konva.angleDeg?exports.Util.radToDeg(n):n},_capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)},throw(e){throw Error(p+e)},error(e){console.error(p+e)},warn(e){t.Konva.showWarnings&&console.warn(f+e)},each(e,t){for(let n in e)t(n,e[n])},_inRange(e,t,n){return t<=e&&e<n},_getProjectionToSegment(e,t,n,r,i,a){let o,s,c,l=(e-n)*(e-n)+(t-r)*(t-r);if(l==0)o=e,s=t,c=(i-n)*(i-n)+(a-r)*(a-r);else{let u=((i-e)*(n-e)+(a-t)*(r-t))/l;u<0?(o=e,s=t,c=(e-i)*(e-i)+(t-a)*(t-a)):u>1?(o=n,s=r,c=(n-i)*(n-i)+(r-a)*(r-a)):(o=e+u*(n-e),s=t+u*(r-t),c=(o-i)*(o-i)+(s-a)*(s-a))}return[o,s,c]},_getProjectionToLine(t,n,r){let i=exports.Util.cloneObject(t),a=Number.MAX_VALUE;return n.forEach(function(o,s){if(!r&&s===n.length-1)return;let c=n[(s+1)%n.length],l=exports.Util._getProjectionToSegment(o.x,o.y,c.x,c.y,t.x,t.y),u=l[0],d=l[1],f=l[2];f<a&&(i.x=u,i.y=d,a=f)}),i},_prepareArrayForTween(t,n,r){let i=[],a=[];if(t.length>n.length){let e=n;n=t,t=e}for(let e=0;e<t.length;e+=2)i.push({x:t[e],y:t[e+1]});for(let e=0;e<n.length;e+=2)a.push({x:n[e],y:n[e+1]});let o=[];return a.forEach(function(t){let n=exports.Util._getProjectionToLine(t,i,r);o.push(n.x),o.push(n.y)}),o},_prepareToStringify(t){let n;for(let r in t.visitedByCircularReferenceRemoval=!0,t){if(!(t.hasOwnProperty(r)&&t[r]&&typeof t[r]==`object`))continue;if(n=Object.getOwnPropertyDescriptor(t,r),t[r].visitedByCircularReferenceRemoval||exports.Util._isElement(t[r]))if(n.configurable)delete t[r];else return null;else if(exports.Util._prepareToStringify(t[r])===null)if(n.configurable)delete t[r];else return null}return delete t.visitedByCircularReferenceRemoval,t},_assign(e,t){for(let n in t)e[n]=t[n];return e},_getFirstPointerId(e){return e.touches?e.changedTouches[0].identifier:e.pointerId||999},releaseCanvas(...e){t.Konva.releaseCanvasOnDestroy&&e.forEach(e=>{e.width=0,e.height=0})},drawRoundedRectPath(e,t,n,r){let i=0,a=0,o=0,s=0;typeof r==`number`?i=a=o=s=Math.min(r,t/2,n/2):(i=Math.min(r[0]||0,t/2,n/2),a=Math.min(r[1]||0,t/2,n/2),s=Math.min(r[2]||0,t/2,n/2),o=Math.min(r[3]||0,t/2,n/2)),e.moveTo(i,0),e.lineTo(t-a,0),e.arc(t-a,a,a,Math.PI*3/2,0,!1),e.lineTo(t,n-s),e.arc(t-s,n-s,s,0,Math.PI/2,!1),e.lineTo(o,n),e.arc(o,n-o,o,Math.PI/2,Math.PI,!1),e.lineTo(0,i),e.arc(i,i,i,Math.PI,Math.PI*3/2,!1)}}}),k=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.HitContext=exports.SceneContext=exports.Context=void 0;let t=O(),n=D();function r(e){let n=[],r=e.length,i=t.Util;for(let t=0;t<r;t++){let r=e[t];i._isNumber(r)?r=Math.round(r*1e3)/1e3:i._isString(r)||(r+=``),n.push(r)}return n}let i=`,`,a=`(`,o=`)`,s=`([`,c=`])`,l=`;`,u=`()`,d=`=`,f=`arc.arcTo.beginPath.bezierCurveTo.clearRect.clip.closePath.createLinearGradient.createPattern.createRadialGradient.drawImage.ellipse.fill.fillText.getImageData.createImageData.lineTo.moveTo.putImageData.quadraticCurveTo.rect.roundRect.restore.rotate.save.scale.setLineDash.setTransform.stroke.strokeText.transform.translate`.split(`.`),p=[`fillStyle`,`strokeStyle`,`shadowColor`,`shadowBlur`,`shadowOffsetX`,`shadowOffsetY`,`letterSpacing`,`lineCap`,`lineDashOffset`,`lineJoin`,`lineWidth`,`miterLimit`,`direction`,`font`,`textAlign`,`textBaseline`,`globalAlpha`,`globalCompositeOperation`,`imageSmoothingEnabled`],m=100;var h=class{constructor(e){this.canvas=e,n.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,n){let r=this.traceArr,f=r.length,p=``,m,h,g,_;for(m=0;m<f;m++)h=r[m],g=h.method,g?(_=h.args,p+=g,e?p+=u:t.Util._isArray(_[0])?p+=s+_.join(i)+c:(n&&(_=_.map(e=>typeof e==`number`?Math.floor(e):e)),p+=a+_.join(i)+o)):(p+=h.property,e||(p+=d+h.val)),p+=l;return p}clearTrace(){this.traceArr=[]}_trace(e){let t=this.traceArr,n;t.push(e),n=t.length,n>=m&&t.shift()}reset(){let e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){let t=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,t.getWidth()/t.pixelRatio,t.getHeight()/t.pixelRatio)}_applyLineCap(e){let t=e.attrs.lineCap;t&&this.setAttr(`lineCap`,t)}_applyOpacity(e){let t=e.getAbsoluteOpacity();t!==1&&this.setAttr(`globalAlpha`,t)}_applyLineJoin(e){let t=e.attrs.lineJoin;t&&this.setAttr(`lineJoin`,t)}setAttr(e,t){this._context[e]=t}arc(e,t,n,r,i,a){this._context.arc(e,t,n,r,i,a)}arcTo(e,t,n,r,i){this._context.arcTo(e,t,n,r,i)}beginPath(){this._context.beginPath()}bezierCurveTo(e,t,n,r,i,a){this._context.bezierCurveTo(e,t,n,r,i,a)}clearRect(e,t,n,r){this._context.clearRect(e,t,n,r)}clip(...e){this._context.clip.apply(this._context,e)}closePath(){this._context.closePath()}createImageData(e,t){let n=arguments;if(n.length===2)return this._context.createImageData(e,t);if(n.length===1)return this._context.createImageData(e)}createLinearGradient(e,t,n,r){return this._context.createLinearGradient(e,t,n,r)}createPattern(e,t){return this._context.createPattern(e,t)}createRadialGradient(e,t,n,r,i,a){return this._context.createRadialGradient(e,t,n,r,i,a)}drawImage(e,t,n,r,i,a,o,s,c){let l=arguments,u=this._context;l.length===3?u.drawImage(e,t,n):l.length===5?u.drawImage(e,t,n,r,i):l.length===9&&u.drawImage(e,t,n,r,i,a,o,s,c)}ellipse(e,t,n,r,i,a,o,s){this._context.ellipse(e,t,n,r,i,a,o,s)}isPointInPath(e,t,n,r){return n?this._context.isPointInPath(n,e,t,r):this._context.isPointInPath(e,t,r)}fill(...e){this._context.fill.apply(this._context,e)}fillRect(e,t,n,r){this._context.fillRect(e,t,n,r)}strokeRect(e,t,n,r){this._context.strokeRect(e,t,n,r)}fillText(e,t,n,r){r?this._context.fillText(e,t,n,r):this._context.fillText(e,t,n)}measureText(e){return this._context.measureText(e)}getImageData(e,t,n,r){return this._context.getImageData(e,t,n,r)}lineTo(e,t){this._context.lineTo(e,t)}moveTo(e,t){this._context.moveTo(e,t)}rect(e,t,n,r){this._context.rect(e,t,n,r)}roundRect(e,t,n,r,i){this._context.roundRect(e,t,n,r,i)}putImageData(e,t,n){this._context.putImageData(e,t,n)}quadraticCurveTo(e,t,n,r){this._context.quadraticCurveTo(e,t,n,r)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,t){this._context.scale(e,t)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):`mozDash`in this._context?this._context.mozDash=e:`webkitLineDash`in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,t,n,r,i,a){this._context.setTransform(e,t,n,r,i,a)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,t,n,r){this._context.strokeText(e,t,n,r)}transform(e,t,n,r,i,a){this._context.transform(e,t,n,r,i,a)}translate(e,t){this._context.translate(e,t)}_enableTrace(){let e=this,t=f.length,n=this.setAttr,i,a,o=function(t){let n=e[t],i;e[t]=function(){return a=r(Array.prototype.slice.call(arguments,0)),i=n.apply(e,arguments),e._trace({method:t,args:a}),i}};for(i=0;i<t;i++)o(f[i]);e.setAttr=function(){n.apply(e,arguments);let t=arguments[0],r=arguments[1];(t===`shadowOffsetX`||t===`shadowOffsetY`||t===`shadowBlur`)&&(r/=this.canvas.getPixelRatio()),e._trace({property:t,val:r})}}_applyGlobalCompositeOperation(e){let t=e.attrs.globalCompositeOperation,n=!t||t===`source-over`;n||this.setAttr(`globalCompositeOperation`,t)}};exports.Context=h,p.forEach(function(e){Object.defineProperty(h.prototype,e,{get(){return this._context[e]},set(t){this._context[e]=t}})});var g=class extends h{constructor(e,{willReadFrequently:t=!1}={}){super(e),this._context=e._canvas.getContext(`2d`,{willReadFrequently:t})}_fillColor(e){let t=e.fill();this.setAttr(`fillStyle`,t),e._fillFunc(this)}_fillPattern(e){this.setAttr(`fillStyle`,e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){let t=e._getLinearGradient();t&&(this.setAttr(`fillStyle`,t),e._fillFunc(this))}_fillRadialGradient(e){let t=e._getRadialGradient();t&&(this.setAttr(`fillStyle`,t),e._fillFunc(this))}_fill(e){let t=e.fill(),n=e.getFillPriority();if(t&&n===`color`){this._fillColor(e);return}let r=e.getFillPatternImage();if(r&&n===`pattern`){this._fillPattern(e);return}let i=e.getFillLinearGradientColorStops();if(i&&n===`linear-gradient`){this._fillLinearGradient(e);return}let a=e.getFillRadialGradientColorStops();if(a&&n===`radial-gradient`){this._fillRadialGradient(e);return}t?this._fillColor(e):r?this._fillPattern(e):i?this._fillLinearGradient(e):a&&this._fillRadialGradient(e)}_strokeLinearGradient(e){let t=e.getStrokeLinearGradientStartPoint(),n=e.getStrokeLinearGradientEndPoint(),r=e.getStrokeLinearGradientColorStops(),i=this.createLinearGradient(t.x,t.y,n.x,n.y);if(r){for(let e=0;e<r.length;e+=2)i.addColorStop(r[e],r[e+1]);this.setAttr(`strokeStyle`,i)}}_stroke(e){let t=e.dash(),n=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!n){this.save();let e=this.getCanvas().getPixelRatio();this.setTransform(e,0,0,e,0,0)}this._applyLineCap(e),t&&e.dashEnabled()&&(this.setLineDash(t),this.setAttr(`lineDashOffset`,e.dashOffset())),this.setAttr(`lineWidth`,e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr(`shadowColor`,`rgba(0,0,0,0)`);let r=e.getStrokeLinearGradientColorStops();r?this._strokeLinearGradient(e):this.setAttr(`strokeStyle`,e.stroke()),e._strokeFunc(this),n||this.restore()}}_applyShadow(e){var t,n,r;let i=(t=e.getShadowRGBA())??`black`,a=(n=e.getShadowBlur())??5,o=(r=e.getShadowOffset())??{x:0,y:0},s=e.getAbsoluteScale(),c=this.canvas.getPixelRatio(),l=s.x*c,u=s.y*c;this.setAttr(`shadowColor`,i),this.setAttr(`shadowBlur`,a*Math.min(Math.abs(l),Math.abs(u))),this.setAttr(`shadowOffsetX`,o.x*l),this.setAttr(`shadowOffsetY`,o.y*u)}};exports.SceneContext=g;var _=class extends h{constructor(e){super(e),this._context=e._canvas.getContext(`2d`,{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr(`fillStyle`,e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){let t=e.getStrokeScaleEnabled();if(!t){this.save();let e=this.getCanvas().getPixelRatio();this.setTransform(e,0,0,e,0,0)}this._applyLineCap(e);let n=e.hitStrokeWidth(),r=n===`auto`?e.strokeWidth():n;this.setAttr(`lineWidth`,r),this.setAttr(`strokeStyle`,e.colorKey),e._strokeFuncHit(this),t||this.restore()}}};exports.HitContext=_}),A=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.HitCanvas=exports.SceneCanvas=exports.Canvas=void 0;let t=O(),n=k(),r=D(),i;function a(){if(i)return i;let e=t.Util.createCanvasElement(),n=e.getContext(`2d`);return i=function(){let e=r.Konva._global.devicePixelRatio||1,t=n.webkitBackingStorePixelRatio||n.mozBackingStorePixelRatio||n.msBackingStorePixelRatio||n.oBackingStorePixelRatio||n.backingStorePixelRatio||1;return e/t}(),t.Util.releaseCanvas(e),i}var o=class{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;let n=e||{},i=n.pixelRatio||r.Konva.pixelRatio||a();this.pixelRatio=i,this._canvas=t.Util.createCanvasElement(),this._canvas.style.padding=`0`,this._canvas.style.margin=`0`,this._canvas.style.border=`0`,this._canvas.style.background=`transparent`,this._canvas.style.position=`absolute`,this._canvas.style.top=`0`,this._canvas.style.left=`0`}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){let t=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/t,this.getHeight()/t)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+`px`;let t=this.pixelRatio,n=this.getContext()._context;n.scale(t,t)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+`px`;let t=this.pixelRatio,n=this.getContext()._context;n.scale(t,t)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,t){this.setWidth(e||0),this.setHeight(t||0)}toDataURL(e,n){try{return this._canvas.toDataURL(e,n)}catch{try{return this._canvas.toDataURL()}catch(e){return t.Util.error(`Unable to get data URL. `+e.message+` For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html.`),``}}}};exports.Canvas=o;var s=class extends o{constructor(e={width:0,height:0,willReadFrequently:!1}){super(e),this.context=new n.SceneContext(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}};exports.SceneCanvas=s;var c=class extends o{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new n.HitContext(this),this.setSize(e.width,e.height)}};exports.HitCanvas=c}),j=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.DD=void 0;let t=D(),n=O();exports.DD={get isDragging(){let t=!1;return exports.DD._dragElements.forEach(e=>{e.dragStatus===`dragging`&&(t=!0)}),t},justDragged:!1,get node(){let t;return exports.DD._dragElements.forEach(e=>{t=e.node}),t},_dragElements:new Map,_drag(t){let r=[];exports.DD._dragElements.forEach((e,i)=>{let{node:a}=e,o=a.getStage();o.setPointersPositions(t),e.pointerId===void 0&&(e.pointerId=n.Util._getFirstPointerId(t));let s=o._changedPointerPositions.find(t=>t.id===e.pointerId);if(s){if(e.dragStatus!==`dragging`){let n=a.dragDistance(),r=Math.max(Math.abs(s.x-e.startPointerPos.x),Math.abs(s.y-e.startPointerPos.y));if(r<n||(a.startDrag({evt:t}),!a.isDragging()))return}a._setDragPosition(t,e),r.push(a)}}),r.forEach(e=>{e.fire(`dragmove`,{type:`dragmove`,target:e,evt:t},!0)})},_endDragBefore(n){let r=[];exports.DD._dragElements.forEach(i=>{let{node:a}=i,o=a.getStage();n&&o.setPointersPositions(n);let s=o._changedPointerPositions.find(e=>e.id===i.pointerId);if(!s)return;(i.dragStatus===`dragging`||i.dragStatus===`stopped`)&&(exports.DD.justDragged=!0,t.Konva._mouseListenClick=!1,t.Konva._touchListenClick=!1,t.Konva._pointerListenClick=!1,i.dragStatus=`stopped`);let c=i.node.getLayer()||i.node instanceof t.Konva.Stage&&i.node;c&&r.indexOf(c)===-1&&r.push(c)}),r.forEach(e=>{e.draw()})},_endDragAfter(t){exports.DD._dragElements.forEach((n,r)=>{n.dragStatus===`stopped`&&n.node.fire(`dragend`,{type:`dragend`,target:n.node,evt:t},!0),n.dragStatus!==`dragging`&&exports.DD._dragElements.delete(r)})}},t.Konva.isBrowser&&(window.addEventListener(`mouseup`,exports.DD._endDragBefore,!0),window.addEventListener(`touchend`,exports.DD._endDragBefore,!0),window.addEventListener(`touchcancel`,exports.DD._endDragBefore,!0),window.addEventListener(`mousemove`,exports.DD._drag),window.addEventListener(`touchmove`,exports.DD._drag),window.addEventListener(`mouseup`,exports.DD._endDragAfter,!1),window.addEventListener(`touchend`,exports.DD._endDragAfter,!1),window.addEventListener(`touchcancel`,exports.DD._endDragAfter,!1))}),M=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.RGBComponent=i,exports.alphaComponent=a,exports.getNumberValidator=o,exports.getNumberOrArrayOfNumbersValidator=s,exports.getNumberOrAutoValidator=c,exports.getStringValidator=l,exports.getStringOrGradientValidator=u,exports.getFunctionValidator=d,exports.getNumberArrayValidator=f,exports.getBooleanValidator=p,exports.getComponentValidator=m;let t=D(),n=O();function r(e){return n.Util._isString(e)?`"`+e+`"`:Object.prototype.toString.call(e)===`[object Number]`||n.Util._isBoolean(e)?e:Object.prototype.toString.call(e)}function i(e){return e>255?255:e<0?0:Math.round(e)}function a(e){return e>1?1:e<1e-4?1e-4:e}function o(){if(t.Konva.isUnminified)return function(e,t){return n.Util._isNumber(e)||n.Util.warn(r(e)+` is a not valid value for "`+t+`" attribute. The value should be a number.`),e}}function s(e){if(t.Konva.isUnminified)return function(t,i){let a=n.Util._isNumber(t),o=n.Util._isArray(t)&&t.length==e;return!a&&!o&&n.Util.warn(r(t)+` is a not valid value for "`+i+`" attribute. The value should be a number or Array<number>(`+e+`)`),t}}function c(){if(t.Konva.isUnminified)return function(e,t){let i=n.Util._isNumber(e),a=e===`auto`;return i||a||n.Util.warn(r(e)+` is a not valid value for "`+t+`" attribute. The value should be a number or "auto".`),e}}function l(){if(t.Konva.isUnminified)return function(e,t){return n.Util._isString(e)||n.Util.warn(r(e)+` is a not valid value for "`+t+`" attribute. The value should be a string.`),e}}function u(){if(t.Konva.isUnminified)return function(e,t){let i=n.Util._isString(e),a=Object.prototype.toString.call(e)===`[object CanvasGradient]`||e&&e.addColorStop;return i||a||n.Util.warn(r(e)+` is a not valid value for "`+t+`" attribute. The value should be a string or a native gradient.`),e}}function d(){if(t.Konva.isUnminified)return function(e,t){return n.Util._isFunction(e)||n.Util.warn(r(e)+` is a not valid value for "`+t+`" attribute. The value should be a function.`),e}}function f(){if(t.Konva.isUnminified)return function(e,t){let i=Int8Array?Object.getPrototypeOf(Int8Array):null;return i&&e instanceof i||(n.Util._isArray(e)?e.forEach(function(e){n.Util._isNumber(e)||n.Util.warn(`"`+t+`" attribute has non numeric element `+e+`. Make sure that all elements are numbers.`)}):n.Util.warn(r(e)+` is a not valid value for "`+t+`" attribute. The value should be a array of numbers.`)),e}}function p(){if(t.Konva.isUnminified)return function(e,t){let i=e===!0||e===!1;return i||n.Util.warn(r(e)+` is a not valid value for "`+t+`" attribute. The value should be a boolean.`),e}}function m(e){if(t.Konva.isUnminified)return function(t,i){return t==null||n.Util.isObject(t)||n.Util.warn(r(t)+` is a not valid value for "`+i+`" attribute. The value should be an object with properties `+e),t}}}),N=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Factory=void 0;let t=O(),n=M(),r=`get`,i=`set`;exports.Factory={addGetterSetter(t,n,r,i,a){exports.Factory.addGetter(t,n,r),exports.Factory.addSetter(t,n,i,a),exports.Factory.addOverloadedGetterSetter(t,n)},addGetter(e,n,i){let a=r+t.Util._capitalize(n);e.prototype[a]=e.prototype[a]||function(){let e=this.attrs[n];return e===void 0?i:e}},addSetter(n,r,a,o){let s=i+t.Util._capitalize(r);n.prototype[s]||exports.Factory.overWriteSetter(n,r,a,o)},overWriteSetter(e,n,r,a){let o=i+t.Util._capitalize(n);e.prototype[o]=function(e){return r&&e!=null&&(e=r.call(this,e,n)),this._setAttr(n,e),a&&a.call(this),this}},addComponentsGetterSetter(a,o,s,c,l){let u=s.length,d=t.Util._capitalize,f=r+d(o),p=i+d(o);a.prototype[f]=function(){let e={};for(let t=0;t<u;t++){let n=s[t];e[n]=this.getAttr(o+d(n))}return e};let m=(0,n.getComponentValidator)(s);a.prototype[p]=function(e){let t=this.attrs[o];for(let t in c&&(e=c.call(this,e,o)),m&&m.call(this,e,o),e){if(!e.hasOwnProperty(t))continue;this._setAttr(o+d(t),e[t])}return e||s.forEach(e=>{this._setAttr(o+d(e),void 0)}),this._fireChangeEvent(o,t,e),l&&l.call(this),this},exports.Factory.addOverloadedGetterSetter(a,o)},addOverloadedGetterSetter(e,n){let a=t.Util._capitalize(n),o=i+a,s=r+a;e.prototype[n]=function(){return arguments.length?(this[o](arguments[0]),this):this[s]()}},addDeprecatedGetterSetter(n,i,a,o){t.Util.error(`Adding deprecated `+i);let s=r+t.Util._capitalize(i),c=i+` property is deprecated and will be removed soon. Look at Konva change log for more information.`;n.prototype[s]=function(){t.Util.error(c);let e=this.attrs[i];return e===void 0?a:e},exports.Factory.addSetter(n,i,o,function(){t.Util.error(c)}),exports.Factory.addOverloadedGetterSetter(n,i)},backCompat(e,n){t.Util.each(n,function(n,a){let o=e.prototype[a],s=r+t.Util._capitalize(n),c=i+t.Util._capitalize(n);function l(){o.apply(this,arguments),t.Util.error(`"`+n+`" method is deprecated and will be removed soon. Use ""`+a+`" instead.`)}e.prototype[n]=l,e.prototype[s]=l,e.prototype[c]=l})},afterSetFilter(){this._filterUpToDate=!1}}}),P=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Node=void 0;let t=A(),n=j(),r=N(),i=D(),a=O(),o=M(),s=`absoluteOpacity`,c=`allEventListeners`,l=`absoluteTransform`,u=`absoluteScale`,d=`canvas`,f=`Change`,p=`children`,m=`konva`,h=`listening`,g=`mouseenter`,_=`mouseleave`,v=`pointerenter`,y=`pointerleave`,b=`touchenter`,x=`touchleave`,S=`name`,C=`set`,w=`Shape`,T=` `,E=`stage`,k=`transform`,P=`Stage`,F=`visible`,I=[`xChange.konva`,`yChange.konva`,`scaleXChange.konva`,`scaleYChange.konva`,`skewXChange.konva`,`skewYChange.konva`,`rotationChange.konva`,`offsetXChange.konva`,`offsetYChange.konva`,`transformsEnabledChange.konva`].join(T),L=1;var R=class e{constructor(e){this._id=L++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===k||e===l)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,t){let n=this._cache.get(e),r=e===k||e===l,i=n===void 0||r&&n.dirty===!0;return i&&(n=t.call(this),this._cache.set(e,n)),n}_calculate(e,t,n){if(!this._attachedDepsListeners.get(e)){let n=t.map(e=>e+`Change.konva`).join(T);this.on(n,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,n)}_getCanvasCache(){return this._cache.get(d)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===l&&this.fire(`absoluteTransformChange`)}clearCache(){if(this._cache.has(d)){let{scene:e,filter:t,hit:n,buffer:r}=this._cache.get(d);a.Util.releaseCanvas(e,t,n,r),this._cache.delete(d)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){let n=e||{},r={};(n.x===void 0||n.y===void 0||n.width===void 0||n.height===void 0)&&(r=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let i=Math.ceil(n.width||r.width),o=Math.ceil(n.height||r.height),c=n.pixelRatio,l=n.x===void 0?Math.floor(r.x):n.x,f=n.y===void 0?Math.floor(r.y):n.y,p=n.offset||0,m=n.drawBorder||!1,h=n.hitCanvasPixelRatio||1;if(!i||!o){a.Util.error(`Can not cache the node. Width or height of the node equals 0. Caching is skipped.`);return}let g=Math.abs(Math.round(r.x)-l)>.5?1:0,_=Math.abs(Math.round(r.y)-f)>.5?1:0;i+=p*2+g,o+=p*2+_,l-=p,f-=p;let v=new t.SceneCanvas({pixelRatio:c,width:i,height:o}),y=new t.SceneCanvas({pixelRatio:c,width:0,height:0,willReadFrequently:!0}),b=new t.HitCanvas({pixelRatio:h,width:i,height:o}),x=v.getContext(),S=b.getContext(),C=new t.SceneCanvas({width:v.width/v.pixelRatio+Math.abs(l),height:v.height/v.pixelRatio+Math.abs(f),pixelRatio:v.pixelRatio}),w=C.getContext();return b.isCache=!0,v.isCache=!0,this._cache.delete(d),this._filterUpToDate=!1,n.imageSmoothingEnabled===!1&&(v.getContext()._context.imageSmoothingEnabled=!1,y.getContext()._context.imageSmoothingEnabled=!1),x.save(),S.save(),w.save(),x.translate(-l,-f),S.translate(-l,-f),w.translate(-l,-f),C.x=l,C.y=f,this._isUnderCache=!0,this._clearSelfAndDescendantCache(s),this._clearSelfAndDescendantCache(u),this.drawScene(v,this,C),this.drawHit(b,this),this._isUnderCache=!1,x.restore(),S.restore(),m&&(x.save(),x.beginPath(),x.rect(0,0,i,o),x.closePath(),x.setAttr(`strokeStyle`,`red`),x.setAttr(`lineWidth`,5),x.stroke(),x.restore()),this._cache.set(d,{scene:v,filter:y,hit:b,buffer:C,x:l,y:f}),this._requestDraw(),this}isCached(){return this._cache.has(d)}getClientRect(e){throw Error(`abstract "getClientRect" method call`)}_transformedRect(e,t){let n=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}],r=1/0,i=1/0,a=-1/0,o=-1/0,s=this.getAbsoluteTransform(t);return n.forEach(function(e){let t=s.point(e);r===void 0&&(r=a=t.x,i=o=t.y),r=Math.min(r,t.x),i=Math.min(i,t.y),a=Math.max(a,t.x),o=Math.max(o,t.y)}),{x:r,y:i,width:a-r,height:o-i}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);let t=this._getCanvasCache();e.translate(t.x,t.y);let n=this._getCachedSceneCanvas(),r=n.pixelRatio;e.drawImage(n._canvas,0,0,n.width/r,n.height/r),e.restore()}_drawCachedHitCanvas(e){let t=this._getCanvasCache(),n=t.hit;e.save(),e.translate(t.x,t.y),e.drawImage(n._canvas,0,0,n.width/n.pixelRatio,n.height/n.pixelRatio),e.restore()}_getCachedSceneCanvas(){let e=this.filters(),t=this._getCanvasCache(),n=t.scene,r=t.filter,i=r.getContext(),o,s,c,l;if(e){if(!this._filterUpToDate){let t=n.pixelRatio;r.setSize(n.width/n.pixelRatio,n.height/n.pixelRatio);try{for(o=e.length,i.clear(),i.drawImage(n._canvas,0,0,n.getWidth()/t,n.getHeight()/t),s=i.getImageData(0,0,r.getWidth(),r.getHeight()),c=0;c<o;c++){if(l=e[c],typeof l!=`function`){a.Util.error(`Filter should be type of function, but got `+typeof l+` instead. Please check correct filters`);continue}l.call(this,s),i.putImageData(s,0,0)}}catch(e){a.Util.error(`Unable to apply filter. `+e.message+` This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.`)}this._filterUpToDate=!0}return r}return n}on(e,t){if(this._cache&&this._cache.delete(c),arguments.length===3)return this._delegate.apply(this,arguments);let n=e.split(T);for(let e=0;e<n.length;e++){let r=n[e],i=r.split(`.`),a=i[0],o=i[1]||``;this.eventListeners[a]||(this.eventListeners[a]=[]),this.eventListeners[a].push({name:o,handler:t})}return this}off(e,t){let n=(e||``).split(T),r=n.length,i,a,o,s,l,u;if(this._cache&&this._cache.delete(c),!e)for(a in this.eventListeners)this._off(a);for(i=0;i<r;i++)if(o=n[i],s=o.split(`.`),l=s[0],u=s[1],l)this.eventListeners[l]&&this._off(l,u,t);else for(a in this.eventListeners)this._off(a,u,t);return this}dispatchEvent(e){let t={target:this,type:e.type,evt:e};return this.fire(e.type,t),this}addEventListener(e,t){return this.on(e,function(e){t.call(this,e.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,t,n){let r=this;this.on(e,function(e){let i=e.target.findAncestors(t,!0,r);for(let t=0;t<i.length;t++)e=a.Util.cloneObject(e),e.currentTarget=i[t],n.call(i[t],e)})}remove(){return this.isDragging()&&this.stopDrag(),n.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(l),this._clearSelfAndDescendantCache(s),this._clearSelfAndDescendantCache(u),this._clearSelfAndDescendantCache(E),this._clearSelfAndDescendantCache(F),this._clearSelfAndDescendantCache(h)}_remove(){this._clearCaches();let e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){let t=`get`+a.Util._capitalize(e);return a.Util._isFunction(this[t])?this[t]():this.attrs[e]}getAncestors(){let e=this.getParent(),t=[];for(;e;)t.push(e),e=e.getParent();return t}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{let t,n;if(!e)return this;for(t in e){if(t===p)continue;n=C+a.Util._capitalize(t),a.Util._isFunction(this[n])?this[n](e[t]):this._setAttr(t,e[t])}}),this}isListening(){return this._getCache(h,this._isListening)}_isListening(e){let t=this.listening();if(!t)return!1;let n=this.getParent();return n&&n!==e&&this!==e?n._isListening(e):!0}isVisible(){return this._getCache(F,this._isVisible)}_isVisible(e){let t=this.visible();if(!t)return!1;let n=this.getParent();return n&&n!==e&&this!==e?n._isVisible(e):!0}shouldDrawHit(e,t=!1){if(e)return this._isVisible(e)&&this._isListening(e);let r=this.getLayer(),a=!1;n.DD._dragElements.forEach(e=>{e.dragStatus===`dragging`&&(e.node.nodeType===`Stage`||e.node.getLayer()===r)&&(a=!0)});let o=!t&&!i.Konva.hitOnDragEnabled&&(a||i.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!o}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let e=this.getDepth(),t=this,n=0,r,i,a,o;function s(c){for(r=[],i=c.length,a=0;a<i;a++)o=c[a],n++,o.nodeType!==w&&(r=r.concat(o.getChildren().slice())),o._id===t._id&&(a=i);r.length>0&&r[0].getDepth()<=e&&s(r)}let c=this.getStage();return t.nodeType!==P&&c&&s(c.getChildren()),n}getDepth(){let e=0,t=this.parent;for(;t;)e++,t=t.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(k),this._clearSelfAndDescendantCache(l)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){let e=this.getStage();if(!e)return null;let t=e.getPointerPosition();if(!t)return null;let n=this.getAbsoluteTransform().copy();return n.invert(),n.point(t)}getAbsolutePosition(e){let t=!1,n=this.parent;for(;n;){if(n.isCached()){t=!0;break}n=n.parent}t&&!e&&(e=!0);let r=this.getAbsoluteTransform(e).getMatrix(),i=new a.Transform,o=this.offset();return i.m=r.slice(),i.translate(o.x,o.y),i.getTranslation()}setAbsolutePosition(e){let{x:t,y:n,...r}=this._clearTransform();this.attrs.x=t,this.attrs.y=n,this._clearCache(k);let i=this._getAbsoluteTransform().copy();return i.invert(),i.translate(e.x,e.y),e={x:this.attrs.x+i.getTranslation().x,y:this.attrs.y+i.getTranslation().y},this._setTransform(r),this.setPosition({x:e.x,y:e.y}),this._clearCache(k),this._clearSelfAndDescendantCache(l),this}_setTransform(e){let t;for(t in e)this.attrs[t]=e[t]}_clearTransform(){let e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){let t=e.x,n=e.y,r=this.x(),i=this.y();return t!==void 0&&(r+=t),n!==void 0&&(i+=n),this.setPosition({x:r,y:i}),this}_eachAncestorReverse(e,t){let n=[],r=this.getParent(),i,a;if(!(t&&t._id===this._id)){for(n.unshift(this);r&&(!t||r._id!==t._id);)n.unshift(r),r=r.parent;for(i=n.length,a=0;a<i;a++)e(n[a])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return a.Util.warn(`Node has no parent. moveToTop function is ignored.`),!1;let e=this.index,t=this.parent.getChildren().length;return e<t-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return a.Util.warn(`Node has no parent. moveUp function is ignored.`),!1;let e=this.index,t=this.parent.getChildren().length;return e<t-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return a.Util.warn(`Node has no parent. moveDown function is ignored.`),!1;let e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return a.Util.warn(`Node has no parent. moveToBottom function is ignored.`),!1;let e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return a.Util.warn(`Node has no parent. zIndex parameter is ignored.`),this;(e<0||e>=this.parent.children.length)&&a.Util.warn(`Unexpected value `+e+` for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to `+(this.parent.children.length-1)+`.`);let t=this.index;return this.parent.children.splice(t,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(s,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let e=this.opacity(),t=this.getParent();return t&&!t._isUnderCache&&(e*=t.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){let e=this.getAttrs(),t,n,r,i,o,s={attrs:{},className:this.getClassName()};for(t in e){if(n=e[t],o=a.Util.isObject(n)&&!a.Util._isPlainObject(n)&&!a.Util._isArray(n),o)continue;r=typeof this[t]==`function`&&this[t],delete e[t],i=r?r.call(this):null,e[t]=n,i!==n&&(s.attrs[t]=n)}return a.Util._prepareToStringify(s)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,t,n){let r=[];t&&this._isMatch(e)&&r.push(this);let i=this.parent;for(;i;){if(i===n)return r;i._isMatch(e)&&r.push(i),i=i.parent}return r}isAncestorOf(e){return!1}findAncestor(e,t,n){return this.findAncestors(e,t,n)[0]}_isMatch(e){if(!e)return!1;if(typeof e==`function`)return e(this);let t=e.replace(/ /g,``).split(`,`),n=t.length,r,i;for(r=0;r<n;r++)if(i=t[r],a.Util.isValidSelector(i)||(a.Util.warn(`Selector "`+i+`" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".`),a.Util.warn(`If you have a custom shape with such className, please change it to start with upper letter like "Triangle".`),a.Util.warn(`Konva is awesome, right?`)),i.charAt(0)===`#`){if(this.id()===i.slice(1))return!0}else if(i.charAt(0)===`.`){if(this.hasName(i.slice(1)))return!0}else if(this.className===i||this.nodeType===i)return!0;return!1}getLayer(){let e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(E,this._getStage)}_getStage(){let e=this.getParent();return e?e.getStage():null}fire(e,t={},n){return t.target=t.target||this,n?this._fireAndBubble(e,t):this._fire(e,t),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(l,this._getAbsoluteTransform)}_getAbsoluteTransform(e){let t;if(e)return t=new a.Transform,this._eachAncestorReverse(function(e){let n=e.transformsEnabled();n===`all`?t.multiply(e.getTransform()):n===`position`&&t.translate(e.x()-e.offsetX(),e.y()-e.offsetY())},e),t;{t=this._cache.get(l)||new a.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(t):t.reset();let e=this.transformsEnabled();if(e===`all`)t.multiply(this.getTransform());else if(e===`position`){let e=this.attrs.x||0,n=this.attrs.y||0,r=this.attrs.offsetX||0,i=this.attrs.offsetY||0;t.translate(e-r,n-i)}return t.dirty=!1,t}}getAbsoluteScale(e){let t=this;for(;t;)t._isUnderCache&&(e=t),t=t.getParent();let n=this.getAbsoluteTransform(e),r=n.decompose();return{x:r.scaleX,y:r.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(k,this._getTransform)}_getTransform(){var e,t;let n=this._cache.get(k)||new a.Transform;n.reset();let r=this.x(),o=this.y(),s=i.Konva.getAngle(this.rotation()),c=(e=this.attrs.scaleX)??1,l=(t=this.attrs.scaleY)??1,u=this.attrs.skewX||0,d=this.attrs.skewY||0,f=this.attrs.offsetX||0,p=this.attrs.offsetY||0;return(r!==0||o!==0)&&n.translate(r,o),s!==0&&n.rotate(s),(u!==0||d!==0)&&n.skew(u,d),(c!==1||l!==1)&&n.scale(c,l),(f!==0||p!==0)&&n.translate(-1*f,-1*p),n.dirty=!1,n}clone(e){let t=a.Util.cloneObject(this.attrs),n,r,i,o,s;for(n in e)t[n]=e[n];let c=new this.constructor(t);for(n in this.eventListeners)for(r=this.eventListeners[n],i=r.length,o=0;o<i;o++)s=r[o],s.name.indexOf(m)<0&&(c.eventListeners[n]||(c.eventListeners[n]=[]),c.eventListeners[n].push(s));return c}_toKonvaCanvas(e){e||={};let n=this.getClientRect(),r=this.getStage(),i=e.x===void 0?Math.floor(n.x):e.x,a=e.y===void 0?Math.floor(n.y):e.y,o=e.pixelRatio||1,s=new t.SceneCanvas({width:e.width||Math.ceil(n.width)||(r?r.width():0),height:e.height||Math.ceil(n.height)||(r?r.height():0),pixelRatio:o}),c=s.getContext(),l=new t.SceneCanvas({width:s.width/s.pixelRatio+Math.abs(i),height:s.height/s.pixelRatio+Math.abs(a),pixelRatio:s.pixelRatio});return e.imageSmoothingEnabled===!1&&(c._context.imageSmoothingEnabled=!1),c.save(),(i||a)&&c.translate(-1*i,-1*a),this.drawScene(s,void 0,l),c.restore(),s}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e||={};let t=e.mimeType||null,n=e.quality||null,r=this._toKonvaCanvas(e).toDataURL(t,n);return e.callback&&e.callback(r),r}toImage(e){return new Promise((t,n)=>{try{let n=e?.callback;n&&delete e.callback,a.Util._urlToImage(this.toDataURL(e),function(e){t(e),n?.(e)})}catch(e){n(e)}})}toBlob(e){return new Promise((t,n)=>{try{let n=e?.callback;n&&delete e.callback,this.toCanvas(e).toBlob(e=>{t(e),n?.(e)},e?.mimeType,e?.quality)}catch(e){n(e)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance===void 0?this.parent?this.parent.getDragDistance():i.Konva.dragDistance:this.attrs.dragDistance}_off(e,t,n){let r=this.eventListeners[e],i,a,o;for(i=0;i<r.length;i++)if(a=r[i].name,o=r[i].handler,(a!==`konva`||t===`konva`)&&(!t||a===t)&&(!n||n===o)){if(r.splice(i,1),r.length===0){delete this.eventListeners[e];break}i--}}_fireChangeEvent(e,t,n){this._fire(e+f,{oldVal:t,newVal:n})}addName(e){if(!this.hasName(e)){let t=this.name(),n=t?t+` `+e:e;this.name(n)}return this}hasName(e){if(!e)return!1;let t=this.name();if(!t)return!1;let n=(t||``).split(/\s/g);return n.indexOf(e)!==-1}removeName(e){let t=(this.name()||``).split(/\s/g),n=t.indexOf(e);return n!==-1&&(t.splice(n,1),this.name(t.join(` `))),this}setAttr(e,t){let n=this[C+a.Util._capitalize(e)];return a.Util._isFunction(n)?n.call(this,t):this._setAttr(e,t),this}_requestDraw(){if(i.Konva.autoDrawEnabled){let e=this.getLayer()||this.getStage();e?.batchDraw()}}_setAttr(e,t){let n=this.attrs[e];n===t&&!a.Util.isObject(t)||(t==null?delete this.attrs[e]:this.attrs[e]=t,this._shouldFireChangeEvents&&this._fireChangeEvent(e,n,t),this._requestDraw())}_setComponentAttr(e,t,n){let r;n!==void 0&&(r=this.attrs[e],r||(this.attrs[e]=this.getAttr(e)),this.attrs[e][t]=n,this._fireChangeEvent(e,r,n))}_fireAndBubble(e,t,n){t&&this.nodeType===w&&(t.target=this);let r=[g,_,v,y,b,x],i=r.indexOf(e)!==-1&&(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||this.nodeType===`Stage`&&!n);if(!i){this._fire(e,t);let i=r.indexOf(e)!==-1&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(t&&!t.cancelBubble||!t)&&this.parent&&this.parent.isListening()&&!i&&(n&&n.parent?this._fireAndBubble.call(this.parent,e,t,n):this._fireAndBubble.call(this.parent,e,t))}}_getProtoListeners(e){var t,n,r;let i=(t=this._cache.get(c))??{},a=i?.[e];if(a===void 0){a=[];let t=Object.getPrototypeOf(this);for(;t;){let i=(r=(n=t.eventListeners)?.[e])??[];a.push(...i),t=Object.getPrototypeOf(t)}i[e]=a,this._cache.set(c,i)}return a}_fire(e,t){t||={},t.currentTarget=this,t.type=e;let n=this._getProtoListeners(e);if(n)for(let e=0;e<n.length;e++)n[e].handler.call(this,t);let r=this.eventListeners[e];if(r)for(let e=0;e<r.length;e++)r[e].handler.call(this,t)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){let t=e?e.pointerId:void 0,r=this.getStage(),i=this.getAbsolutePosition();if(!r)return;let a=r._getPointerById(t)||r._changedPointerPositions[0]||i;n.DD._dragElements.set(this._id,{node:this,startPointerPos:a,offset:{x:a.x-i.x,y:a.y-i.y},dragStatus:`ready`,pointerId:t})}startDrag(e,t=!0){n.DD._dragElements.has(this._id)||this._createDragElement(e);let r=n.DD._dragElements.get(this._id);r.dragStatus=`dragging`,this.fire(`dragstart`,{type:`dragstart`,target:this,evt:e&&e.evt},t)}_setDragPosition(e,t){let n=this.getStage()._getPointerById(t.pointerId);if(!n)return;let r={x:n.x-t.offset.x,y:n.y-t.offset.y},i=this.dragBoundFunc();if(i!==void 0){let t=i.call(this,r,e);t?r=t:a.Util.warn(`dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.`)}(!this._lastPos||this._lastPos.x!==r.x||this._lastPos.y!==r.y)&&(this.setAbsolutePosition(r),this._requestDraw()),this._lastPos=r}stopDrag(e){let t=n.DD._dragElements.get(this._id);t&&(t.dragStatus=`stopped`),n.DD._endDragBefore(e),n.DD._endDragAfter(e)}setDraggable(e){this._setAttr(`draggable`,e),this._dragChange()}isDragging(){let e=n.DD._dragElements.get(this._id);return e?e.dragStatus===`dragging`:!1}_listenDrag(){this._dragCleanup(),this.on(`mousedown.konva touchstart.konva`,function(e){let t=e.evt.button!==void 0,r=!t||i.Konva.dragButtons.indexOf(e.evt.button)>=0;if(!r||this.isDragging())return;let a=!1;n.DD._dragElements.forEach(e=>{this.isAncestorOf(e.node)&&(a=!0)}),a||this._createDragElement(e)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{this._dragCleanup();let e=this.getStage();if(!e)return;let t=n.DD._dragElements.get(this._id),r=t&&t.dragStatus===`dragging`,i=t&&t.dragStatus===`ready`;r?this.stopDrag():i&&n.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off(`mousedown.konva`),this.off(`touchstart.konva`)}isClientRectOnScreen(e={x:0,y:0}){let t=this.getStage();if(!t)return!1;let n={x:-e.x,y:-e.y,width:t.width()+2*e.x,height:t.height()+2*e.y};return a.Util.haveIntersection(n,this.getClientRect())}static create(e,t){return a.Util._isString(e)&&(e=JSON.parse(e)),this._createNode(e,t)}static _createNode(t,n){let r=e.prototype.getClassName.call(t),o=t.children,s,c,l;n&&(t.attrs.container=n),i.Konva[r]||(a.Util.warn(`Can not find a node with class name "`+r+`". Fallback to "Shape".`),r=`Shape`);let u=i.Konva[r];if(s=new u(t.attrs),o)for(c=o.length,l=0;l<c;l++)s.add(e._createNode(o[l]));return s}};exports.Node=R,R.prototype.nodeType=`Node`,R.prototype._attrsAffectingSize=[],R.prototype.eventListeners={},R.prototype.on.call(R.prototype,I,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(k),this._clearSelfAndDescendantCache(l)}),R.prototype.on.call(R.prototype,`visibleChange.konva`,function(){this._clearSelfAndDescendantCache(F)}),R.prototype.on.call(R.prototype,`listeningChange.konva`,function(){this._clearSelfAndDescendantCache(h)}),R.prototype.on.call(R.prototype,`opacityChange.konva`,function(){this._clearSelfAndDescendantCache(s)});let z=r.Factory.addGetterSetter;z(R,`zIndex`),z(R,`absolutePosition`),z(R,`position`),z(R,`x`,0,(0,o.getNumberValidator)()),z(R,`y`,0,(0,o.getNumberValidator)()),z(R,`globalCompositeOperation`,`source-over`,(0,o.getStringValidator)()),z(R,`opacity`,1,(0,o.getNumberValidator)()),z(R,`name`,``,(0,o.getStringValidator)()),z(R,`id`,``,(0,o.getStringValidator)()),z(R,`rotation`,0,(0,o.getNumberValidator)()),r.Factory.addComponentsGetterSetter(R,`scale`,[`x`,`y`]),z(R,`scaleX`,1,(0,o.getNumberValidator)()),z(R,`scaleY`,1,(0,o.getNumberValidator)()),r.Factory.addComponentsGetterSetter(R,`skew`,[`x`,`y`]),z(R,`skewX`,0,(0,o.getNumberValidator)()),z(R,`skewY`,0,(0,o.getNumberValidator)()),r.Factory.addComponentsGetterSetter(R,`offset`,[`x`,`y`]),z(R,`offsetX`,0,(0,o.getNumberValidator)()),z(R,`offsetY`,0,(0,o.getNumberValidator)()),z(R,`dragDistance`,void 0,(0,o.getNumberValidator)()),z(R,`width`,0,(0,o.getNumberValidator)()),z(R,`height`,0,(0,o.getNumberValidator)()),z(R,`listening`,!0,(0,o.getBooleanValidator)()),z(R,`preventDefault`,!0,(0,o.getBooleanValidator)()),z(R,`filters`,void 0,function(e){return this._filterUpToDate=!1,e}),z(R,`visible`,!0,(0,o.getBooleanValidator)()),z(R,`transformsEnabled`,`all`,(0,o.getStringValidator)()),z(R,`size`),z(R,`dragBoundFunc`),z(R,`draggable`,!1,(0,o.getBooleanValidator)()),r.Factory.backCompat(R,{rotateDeg:`rotate`,setRotationDeg:`setRotation`,getRotationDeg:`getRotation`})}),F=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Container=void 0;let t=N(),n=P(),r=M();var i=class extends n.Node{constructor(){super(...arguments),this.children=[]}getChildren(e){let t=this.children||[];return e?t.filter(e):t}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(let t=0;t<e.length;t++)this.add(e[t]);return this}let t=e[0];return t.getParent()?(t.moveTo(this),this):(this._validateAdd(t),t.index=this.getChildren().length,t.parent=this,t._clearCaches(),this.getChildren().push(t),this._fire(`add`,{child:t}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){let t=this._generalFind(e,!0);return t.length>0?t[0]:void 0}_generalFind(e,t){let n=[];return this._descendants(r=>{let i=r._isMatch(e);return i&&n.push(r),!!(i&&t)}),n}_descendants(e){let t=!1,n=this.getChildren();for(let r of n){if(t=e(r),t)return!0;if(!r.hasChildren())continue;if(t=r._descendants(e),t)return!0}return!1}toObject(){let e=n.Node.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(t=>{e.children.push(t.toObject())}),e}isAncestorOf(e){let t=e.getParent();for(;t;){if(t._id===this._id)return!0;t=t.getParent()}return!1}clone(e){let t=n.Node.prototype.clone.call(this,e);return this.getChildren().forEach(function(e){t.add(e.clone())}),t}getAllIntersections(e){let t=[];return this.find(`Shape`).forEach(n=>{n.isVisible()&&n.intersects(e)&&t.push(n)}),t}_clearSelfAndDescendantCache(e){var t;super._clearSelfAndDescendantCache(e),!this.isCached()&&((t=this.children)==null||t.forEach(function(t){t._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)==null||e.forEach(function(e,t){e.index=t}),this._requestDraw()}drawScene(e,t,n){let r=this.getLayer(),i=e||r&&r.getCanvas(),a=i&&i.getContext(),o=this._getCanvasCache(),s=o&&o.scene,c=i&&i.isCache;if(!this.isVisible()&&!c)return this;if(s){a.save();let e=this.getAbsoluteTransform(t).getMatrix();a.transform(e[0],e[1],e[2],e[3],e[4],e[5]),this._drawCachedSceneCanvas(a),a.restore()}else this._drawChildren(`drawScene`,i,t,n);return this}drawHit(e,t){if(!this.shouldDrawHit(t))return this;let n=this.getLayer(),r=e||n&&n.hitCanvas,i=r&&r.getContext(),a=this._getCanvasCache(),o=a&&a.hit;if(o){i.save();let e=this.getAbsoluteTransform(t).getMatrix();i.transform(e[0],e[1],e[2],e[3],e[4],e[5]),this._drawCachedHitCanvas(i),i.restore()}else this._drawChildren(`drawHit`,r,t);return this}_drawChildren(e,t,n,r){var i;let a=t&&t.getContext(),o=this.clipWidth(),s=this.clipHeight(),c=this.clipFunc(),l=typeof o==`number`&&typeof s==`number`||c,u=n===this;if(l){a.save();let e=this.getAbsoluteTransform(n),t=e.getMatrix();a.transform(t[0],t[1],t[2],t[3],t[4],t[5]),a.beginPath();let r;if(c)r=c.call(this,a,this);else{let e=this.clipX(),t=this.clipY();a.rect(e||0,t||0,o,s)}a.clip.apply(a,r),t=e.copy().invert().getMatrix(),a.transform(t[0],t[1],t[2],t[3],t[4],t[5])}let d=!u&&this.globalCompositeOperation()!==`source-over`&&e===`drawScene`;d&&(a.save(),a._applyGlobalCompositeOperation(this)),(i=this.children)==null||i.forEach(function(i){i[e](t,n,r)}),d&&a.restore(),l&&a.restore()}getClientRect(e={}){var t;let n=e.skipTransform,r=e.relativeTo,i,a,o,s,c={x:1/0,y:1/0,width:0,height:0},l=this;(t=this.children)==null||t.forEach(function(t){if(!t.visible())return;let n=t.getClientRect({relativeTo:l,skipShadow:e.skipShadow,skipStroke:e.skipStroke});n.width===0&&n.height===0||(i===void 0?(i=n.x,a=n.y,o=n.x+n.width,s=n.y+n.height):(i=Math.min(i,n.x),a=Math.min(a,n.y),o=Math.max(o,n.x+n.width),s=Math.max(s,n.y+n.height)))});let u=this.find(`Shape`),d=!1;for(let e=0;e<u.length;e++){let t=u[e];if(t._isVisible(this)){d=!0;break}}return c=d&&i!==void 0?{x:i,y:a,width:o-i,height:s-a}:{x:0,y:0,width:0,height:0},n?c:this._transformedRect(c,r)}};exports.Container=i,t.Factory.addComponentsGetterSetter(i,`clip`,[`x`,`y`,`width`,`height`]),t.Factory.addGetterSetter(i,`clipX`,void 0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(i,`clipY`,void 0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(i,`clipWidth`,void 0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(i,`clipHeight`,void 0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(i,`clipFunc`)}),I=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.getCapturedShape=i,exports.createEvent=a,exports.hasPointerCapture=o,exports.setPointerCapture=s,exports.releaseCapture=c;let t=D(),n=new Map,r=t.Konva._global.PointerEvent!==void 0;function i(e){return n.get(e)}function a(e){return{evt:e,pointerId:e.pointerId}}function o(e,t){return n.get(e)===t}function s(e,t){c(e);let i=t.getStage();i&&(n.set(e,t),r&&t._fire(`gotpointercapture`,a(new PointerEvent(`gotpointercapture`))))}function c(e,t){let i=n.get(e);if(!i)return;let o=i.getStage();o&&o.content,n.delete(e),r&&i._fire(`lostpointercapture`,a(new PointerEvent(`lostpointercapture`)))}}),L=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Stage=exports.stages=void 0;let t=O(),n=N(),r=F(),i=D(),a=A(),o=j(),s=D(),c=I(),l=`Stage`,u=`string`,d=`px`,f=`mouseout`,p=`mouseleave`,m=`mouseover`,h=`mouseenter`,g=`mousemove`,_=`mousedown`,v=`mouseup`,y=`pointermove`,b=`pointerdown`,x=`pointerup`,S=`pointercancel`,C=`lostpointercapture`,w=`pointerout`,T=`pointerleave`,E=`pointerover`,k=`pointerenter`,M=`contextmenu`,P=`touchstart`,L=`touchend`,R=`touchmove`,z=`touchcancel`,B=`wheel`,V=5,H=[[h,`_pointerenter`],[_,`_pointerdown`],[g,`_pointermove`],[v,`_pointerup`],[p,`_pointerleave`],[P,`_pointerdown`],[R,`_pointermove`],[L,`_pointerup`],[z,`_pointercancel`],[m,`_pointerover`],[B,`_wheel`],[M,`_contextmenu`],[b,`_pointerdown`],[y,`_pointermove`],[x,`_pointerup`],[S,`_pointercancel`],[T,`_pointerleave`],[C,`_lostpointercapture`]],U={mouse:{[w]:f,[T]:p,[E]:m,[k]:h,[y]:g,[b]:_,[x]:v,[S]:`mousecancel`,pointerclick:`click`,pointerdblclick:`dblclick`},touch:{[w]:`touchout`,[T]:`touchleave`,[E]:`touchover`,[k]:`touchenter`,[y]:R,[b]:P,[x]:L,[S]:z,pointerclick:`tap`,pointerdblclick:`dbltap`},pointer:{[w]:w,[T]:T,[E]:E,[k]:k,[y]:y,[b]:b,[x]:x,[S]:S,pointerclick:`pointerclick`,pointerdblclick:`pointerdblclick`}},W=e=>e.indexOf(`pointer`)>=0?`pointer`:e.indexOf(`touch`)>=0?`touch`:`mouse`,G=e=>{let t=W(e);if(t===`pointer`)return i.Konva.pointerEventsEnabled&&U.pointer;if(t===`touch`)return U.touch;if(t===`mouse`)return U.mouse};function K(e={}){return(e.clipFunc||e.clipWidth||e.clipHeight)&&t.Util.warn(`Stage does not support clipping. Please use clip for Layers or Groups.`),e}let q=`Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);`;exports.stages=[];var J=class extends r.Container{constructor(t){super(K(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),exports.stages.push(this),this.on(`widthChange.konva heightChange.konva`,this._resizeDOM),this.on(`visibleChange.konva`,this._checkVisibility),this.on(`clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva`,()=>{K(this.attrs)}),this._checkVisibility()}_validateAdd(e){let n=e.getType()===`Layer`,r=e.getType()===`FastLayer`,i=n||r;i||t.Util.throw(`You may only add layers to the stage.`)}_checkVisibility(){if(!this.content)return;let e=this.visible()?``:`none`;this.content.style.display=e}setContainer(e){if(typeof e===u){let t;if(e.charAt(0)===`.`){let t=e.slice(1);e=document.getElementsByClassName(t)[0]}else t=e.charAt(0)===`#`?e.slice(1):e,e=document.getElementById(t);if(!e)throw`Can not find container in document with id `+t}return this._setAttr(`container`,e),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),e.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){let e=this.children,t=e.length;for(let n=0;n<t;n++)e[n].clear();return this}clone(e){return e||={},e.container=typeof document<`u`&&document.createElement(`div`),r.Container.prototype.clone.call(this,e)}destroy(){super.destroy();let n=this.content;n&&t.Util._isInDocument(n)&&this.container().removeChild(n);let r=exports.stages.indexOf(this);return r>-1&&exports.stages.splice(r,1),t.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){let e=this._pointerPositions[0]||this._changedPointerPositions[0];return e?{x:e.x,y:e.y}:(t.Util.warn(q),null)}_getPointerById(e){return this._pointerPositions.find(t=>t.id===e)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(e){e||={},e.x=e.x||0,e.y=e.y||0,e.width=e.width||this.width(),e.height=e.height||this.height();let t=new a.SceneCanvas({width:e.width,height:e.height,pixelRatio:e.pixelRatio||1}),n=t.getContext()._context,r=this.children;return(e.x||e.y)&&n.translate(-1*e.x,-1*e.y),r.forEach(function(t){if(!t.isVisible())return;let r=t._toKonvaCanvas(e);n.drawImage(r._canvas,e.x,e.y,r.getWidth()/r.getPixelRatio(),r.getHeight()/r.getPixelRatio())}),t}getIntersection(e){if(!e)return null;let t=this.children,n=t.length,r=n-1;for(let n=r;n>=0;n--){let r=t[n].getIntersection(e);if(r)return r}return null}_resizeDOM(){let e=this.width(),t=this.height();this.content&&(this.content.style.width=e+d,this.content.style.height=t+d),this.bufferCanvas.setSize(e,t),this.bufferHitCanvas.setSize(e,t),this.children.forEach(n=>{n.setSize({width:e,height:t}),n.draw()})}add(e,...n){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}super.add(e);let r=this.children.length;return r>V&&t.Util.warn(`The stage has `+r+` layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group.`),e.setSize({width:this.width(),height:this.height()}),e.draw(),i.Konva.isBrowser&&this.content.appendChild(e.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(e){return c.hasPointerCapture(e,this)}setPointerCapture(e){c.setPointerCapture(e,this)}releaseCapture(e){c.releaseCapture(e,this)}getLayers(){return this.children}_bindContentEvents(){i.Konva.isBrowser&&H.forEach(([e,t])=>{this.content.addEventListener(e,e=>{this[t](e)},{passive:!1})})}_pointerenter(e){this.setPointersPositions(e);let t=G(e.type);t&&this._fire(t.pointerenter,{evt:e,target:this,currentTarget:this})}_pointerover(e){this.setPointersPositions(e);let t=G(e.type);t&&this._fire(t.pointerover,{evt:e,target:this,currentTarget:this})}_getTargetShape(e){let t=this[e+`targetShape`];return t&&!t.getStage()&&(t=null),t}_pointerleave(e){let t=G(e.type),n=W(e.type);if(!t)return;this.setPointersPositions(e);let r=this._getTargetShape(n),a=!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled;r&&a?(r._fireAndBubble(t.pointerout,{evt:e}),r._fireAndBubble(t.pointerleave,{evt:e}),this._fire(t.pointerleave,{evt:e,target:this,currentTarget:this}),this[n+`targetShape`]=null):a&&(this._fire(t.pointerleave,{evt:e,target:this,currentTarget:this}),this._fire(t.pointerout,{evt:e,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(e){let t=G(e.type),n=W(e.type);if(!t)return;this.setPointersPositions(e);let r=!1;this._changedPointerPositions.forEach(a=>{let s=this.getIntersection(a);if(o.DD.justDragged=!1,i.Konva[`_`+n+`ListenClick`]=!0,!s||!s.isListening()){this[n+`ClickStartShape`]=void 0;return}i.Konva.capturePointerEventsEnabled&&s.setPointerCapture(a.id),this[n+`ClickStartShape`]=s,s._fireAndBubble(t.pointerdown,{evt:e,pointerId:a.id}),r=!0;let c=e.type.indexOf(`touch`)>=0;s.preventDefault()&&e.cancelable&&c&&e.preventDefault()}),r||this._fire(t.pointerdown,{evt:e,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(e){let t=G(e.type),n=W(e.type);if(!t)return;i.Konva.isDragging()&&o.DD.node.preventDefault()&&e.cancelable&&e.preventDefault(),this.setPointersPositions(e);let r=!(i.Konva.isDragging()||i.Konva.isTransforming())||i.Konva.hitOnDragEnabled;if(!r)return;let a={},s=!1,l=this._getTargetShape(n);this._changedPointerPositions.forEach(r=>{let i=c.getCapturedShape(r.id)||this.getIntersection(r),o=r.id,u={evt:e,pointerId:o},d=l!==i;if(d&&l&&(l._fireAndBubble(t.pointerout,{...u},i),l._fireAndBubble(t.pointerleave,{...u},i)),i){if(a[i._id])return;a[i._id]=!0}i&&i.isListening()?(s=!0,d&&(i._fireAndBubble(t.pointerover,{...u},l),i._fireAndBubble(t.pointerenter,{...u},l),this[n+`targetShape`]=i),i._fireAndBubble(t.pointermove,{...u})):l&&(this._fire(t.pointerover,{evt:e,target:this,currentTarget:this,pointerId:o}),this[n+`targetShape`]=null)}),s||this._fire(t.pointermove,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(e){let t=G(e.type),n=W(e.type);if(!t)return;this.setPointersPositions(e);let r=this[n+`ClickStartShape`],a=this[n+`ClickEndShape`],s={},l=!1;this._changedPointerPositions.forEach(u=>{let d=c.getCapturedShape(u.id)||this.getIntersection(u);if(d){if(d.releaseCapture(u.id),s[d._id])return;s[d._id]=!0}let f=u.id,p={evt:e,pointerId:f},m=!1;i.Konva[`_`+n+`InDblClickWindow`]?(m=!0,clearTimeout(this[n+`DblTimeout`])):o.DD.justDragged||(i.Konva[`_`+n+`InDblClickWindow`]=!0,clearTimeout(this[n+`DblTimeout`])),this[n+`DblTimeout`]=setTimeout(function(){i.Konva[`_`+n+`InDblClickWindow`]=!1},i.Konva.dblClickWindow),d&&d.isListening()?(l=!0,this[n+`ClickEndShape`]=d,d._fireAndBubble(t.pointerup,{...p}),i.Konva[`_`+n+`ListenClick`]&&r&&r===d&&(d._fireAndBubble(t.pointerclick,{...p}),m&&a&&a===d&&d._fireAndBubble(t.pointerdblclick,{...p}))):(this[n+`ClickEndShape`]=null,i.Konva[`_`+n+`ListenClick`]&&this._fire(t.pointerclick,{evt:e,target:this,currentTarget:this,pointerId:f}),m&&this._fire(t.pointerdblclick,{evt:e,target:this,currentTarget:this,pointerId:f}))}),l||this._fire(t.pointerup,{evt:e,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),i.Konva[`_`+n+`ListenClick`]=!1,e.cancelable&&n!==`touch`&&n!==`pointer`&&e.preventDefault()}_contextmenu(e){this.setPointersPositions(e);let t=this.getIntersection(this.getPointerPosition());t&&t.isListening()?t._fireAndBubble(M,{evt:e}):this._fire(M,{evt:e,target:this,currentTarget:this})}_wheel(e){this.setPointersPositions(e);let t=this.getIntersection(this.getPointerPosition());t&&t.isListening()?t._fireAndBubble(B,{evt:e}):this._fire(B,{evt:e,target:this,currentTarget:this})}_pointercancel(e){this.setPointersPositions(e);let t=c.getCapturedShape(e.pointerId)||this.getIntersection(this.getPointerPosition());t&&t._fireAndBubble(x,c.createEvent(e)),c.releaseCapture(e.pointerId)}_lostpointercapture(e){c.releaseCapture(e.pointerId)}setPointersPositions(e){let n=this._getContentPosition(),r=null,i=null;e||=window.event,e.touches===void 0?(r=(e.clientX-n.left)/n.scaleX,i=(e.clientY-n.top)/n.scaleY,this.pointerPos={x:r,y:i},this._pointerPositions=[{x:r,y:i,id:t.Util._getFirstPointerId(e)}],this._changedPointerPositions=[{x:r,y:i,id:t.Util._getFirstPointerId(e)}]):(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(e.touches,e=>{this._pointerPositions.push({id:e.identifier,x:(e.clientX-n.left)/n.scaleX,y:(e.clientY-n.top)/n.scaleY})}),Array.prototype.forEach.call(e.changedTouches||e.touches,e=>{this._changedPointerPositions.push({id:e.identifier,x:(e.clientX-n.left)/n.scaleX,y:(e.clientY-n.top)/n.scaleY})}))}_setPointerPosition(e){t.Util.warn(`Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.`),this.setPointersPositions(e)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};let e=this.content.getBoundingClientRect();return{top:e.top,left:e.left,scaleX:e.width/this.content.clientWidth||1,scaleY:e.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new a.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new a.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!i.Konva.isBrowser)return;let e=this.container();if(!e)throw`Stage has no container. A container is required.`;e.innerHTML=``,this.content=document.createElement(`div`),this.content.style.position=`relative`,this.content.style.userSelect=`none`,this.content.className=`konvajs-content`,this.content.setAttribute(`role`,`presentation`),e.appendChild(this.content),this._resizeDOM()}cache(){return t.Util.warn(`Cache function is not allowed for stage. You may use cache only for layers, groups and shapes.`),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(e){e.batchDraw()}),this}};exports.Stage=J,J.prototype.nodeType=l,(0,s._registerNode)(J),n.Factory.addGetterSetter(J,`container`),i.Konva.isBrowser&&document.addEventListener(`visibilitychange`,()=>{exports.stages.forEach(e=>{e.batchDraw()})})}),R=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Shape=exports.shapes=void 0;let t=D(),n=O(),r=N(),i=P(),a=M(),o=D(),s=I(),c=`hasShadow`,l=`shadowRGBA`,u=`patternImage`,d=`linearGradient`,f=`radialGradient`,p;function m(){return p||(p=n.Util.createCanvasElement().getContext(`2d`),p)}exports.shapes={};function h(e){let t=this.attrs.fillRule;t?e.fill(t):e.fill()}function g(e){e.stroke()}function _(e){let t=this.attrs.fillRule;t?e.fill(t):e.fill()}function v(e){e.stroke()}function y(){this._clearCache(c)}function b(){this._clearCache(l)}function x(){this._clearCache(u)}function S(){this._clearCache(d)}function C(){this._clearCache(f)}var w=class extends i.Node{constructor(t){super(t);let r;for(;r=n.Util.getRandomColor(),!(r&&!(r in exports.shapes)););this.colorKey=r,exports.shapes[r]=this}getContext(){return n.Util.warn(`shape.getContext() method is deprecated. Please do not use it.`),this.getLayer().getContext()}getCanvas(){return n.Util.warn(`shape.getCanvas() method is deprecated. Please do not use it.`),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(c,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(u,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){let e=m(),r=e.createPattern(this.fillPatternImage(),this.fillPatternRepeat()||`repeat`);if(r&&r.setTransform){let e=new n.Transform;e.translate(this.fillPatternX(),this.fillPatternY()),e.rotate(t.Konva.getAngle(this.fillPatternRotation())),e.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),e.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());let i=e.getMatrix(),a=typeof DOMMatrix>`u`?{a:i[0],b:i[1],c:i[2],d:i[3],e:i[4],f:i[5]}:new DOMMatrix(i);r.setTransform(a)}return r}}_getLinearGradient(){return this._getCache(d,this.__getLinearGradient)}__getLinearGradient(){let e=this.fillLinearGradientColorStops();if(e){let t=m(),n=this.fillLinearGradientStartPoint(),r=this.fillLinearGradientEndPoint(),i=t.createLinearGradient(n.x,n.y,r.x,r.y);for(let t=0;t<e.length;t+=2)i.addColorStop(e[t],e[t+1]);return i}}_getRadialGradient(){return this._getCache(f,this.__getRadialGradient)}__getRadialGradient(){let e=this.fillRadialGradientColorStops();if(e){let t=m(),n=this.fillRadialGradientStartPoint(),r=this.fillRadialGradientEndPoint(),i=t.createRadialGradient(n.x,n.y,this.fillRadialGradientStartRadius(),r.x,r.y,this.fillRadialGradientEndRadius());for(let t=0;t<e.length;t+=2)i.addColorStop(e[t],e[t+1]);return i}}getShadowRGBA(){return this._getCache(l,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;let e=n.Util.colorToRGBA(this.shadowColor());if(e)return`rgba(`+e.r+`,`+e.g+`,`+e.b+`,`+e.a*(this.shadowOpacity()||1)+`)`}hasFill(){return this._calculate(`hasFill`,[`fillEnabled`,`fill`,`fillPatternImage`,`fillLinearGradientColorStops`,`fillRadialGradientColorStops`],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate(`hasStroke`,[`strokeEnabled`,`strokeWidth`,`stroke`,`strokeLinearGradientColorStops`],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){let e=this.hitStrokeWidth();return e===`auto`?this.hasStroke():this.strokeEnabled()&&!!e}intersects(e){let t=this.getStage();if(!t)return!1;let n=t.bufferHitCanvas;n.getContext().clear(),this.drawHit(n,void 0,!0);let r=n.context.getImageData(Math.round(e.x),Math.round(e.y),1,1).data;return r[3]>0}destroy(){return i.Node.prototype.destroy.call(this),delete exports.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(e){var t;let n=(t=this.attrs.perfectDrawEnabled)??!0;if(!n)return!1;let r=e||this.hasFill(),i=this.hasStroke(),a=this.getAbsoluteOpacity()!==1;if(r&&i&&a)return!0;let o=this.hasShadow(),s=this.shadowForStrokeEnabled();return!!(r&&i&&o&&s)}setStrokeHitEnabled(e){n.Util.warn(`strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead.`),e?this.hitStrokeWidth(`auto`):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){let e=this.size();return{x:this._centroid?-e.width/2:0,y:this._centroid?-e.height/2:0,width:e.width,height:e.height}}getClientRect(e={}){let t=!1,n=this.getParent();for(;n;){if(n.isCached()){t=!0;break}n=n.getParent()}let r=e.skipTransform,i=e.relativeTo||t&&this.getStage()||void 0,a=this.getSelfRect(),o=!e.skipStroke&&this.hasStroke(),s=o&&this.strokeWidth()||0,c=a.width+s,l=a.height+s,u=!e.skipShadow&&this.hasShadow(),d=u?this.shadowOffsetX():0,f=u?this.shadowOffsetY():0,p=c+Math.abs(d),m=l+Math.abs(f),h=u&&this.shadowBlur()||0,g=p+h*2,_=m+h*2,v={width:g,height:_,x:-(s/2+h)+Math.min(d,0)+a.x,y:-(s/2+h)+Math.min(f,0)+a.y};return r?v:this._transformedRect(v,i)}drawScene(e,t,n){let r=this.getLayer(),i=e||r.getCanvas(),a=i.getContext(),o=this._getCanvasCache(),s=this.getSceneFunc(),c=this.hasShadow(),l,u=!1,d=t===this;if(!this.isVisible()&&!d)return this;if(o){a.save();let e=this.getAbsoluteTransform(t).getMatrix();return a.transform(e[0],e[1],e[2],e[3],e[4],e[5]),this._drawCachedSceneCanvas(a),a.restore(),this}if(!s)return this;if(a.save(),this._useBufferCanvas()){l=this.getStage();let e=n||l.bufferCanvas,r=e.getContext();r.clear(),r.save(),r._applyLineJoin(this);let i=this.getAbsoluteTransform(t).getMatrix();r.transform(i[0],i[1],i[2],i[3],i[4],i[5]),s.call(this,r,this),r.restore();let o=e.pixelRatio;c&&a._applyShadow(this),a._applyOpacity(this),a._applyGlobalCompositeOperation(this),a.drawImage(e._canvas,e.x||0,e.y||0,e.width/o,e.height/o)}else{if(a._applyLineJoin(this),!d){let e=this.getAbsoluteTransform(t).getMatrix();a.transform(e[0],e[1],e[2],e[3],e[4],e[5]),a._applyOpacity(this),a._applyGlobalCompositeOperation(this)}c&&a._applyShadow(this),s.call(this,a,this)}return a.restore(),this}drawHit(e,t,r=!1){if(!this.shouldDrawHit(t,r))return this;let i=this.getLayer(),a=e||i.hitCanvas,o=a&&a.getContext(),s=this.hitFunc()||this.sceneFunc(),c=this._getCanvasCache(),l=c&&c.hit;if(this.colorKey||n.Util.warn(`Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()`),l){o.save();let e=this.getAbsoluteTransform(t).getMatrix();return o.transform(e[0],e[1],e[2],e[3],e[4],e[5]),this._drawCachedHitCanvas(o),o.restore(),this}if(!s)return this;o.save(),o._applyLineJoin(this);let u=this===t;if(!u){let e=this.getAbsoluteTransform(t).getMatrix();o.transform(e[0],e[1],e[2],e[3],e[4],e[5])}return s.call(this,o,this),o.restore(),this}drawHitFromCache(e=0){let t=this._getCanvasCache(),r=this._getCachedSceneCanvas(),i=t.hit,a=i.getContext(),o=i.getWidth(),s=i.getHeight();a.clear(),a.drawImage(r._canvas,0,0,o,s);try{let t=a.getImageData(0,0,o,s),r=t.data,i=r.length,c=n.Util._hexToRgb(this.colorKey);for(let t=0;t<i;t+=4){let n=r[t+3];n>e?(r[t]=c.r,r[t+1]=c.g,r[t+2]=c.b,r[t+3]=255):r[t+3]=0}a.putImageData(t,0,0)}catch(e){n.Util.error(`Unable to draw hit graph from cached scene canvas. `+e.message)}return this}hasPointerCapture(e){return s.hasPointerCapture(e,this)}setPointerCapture(e){s.setPointerCapture(e,this)}releaseCapture(e){s.releaseCapture(e,this)}};exports.Shape=w,w.prototype._fillFunc=h,w.prototype._strokeFunc=g,w.prototype._fillFuncHit=_,w.prototype._strokeFuncHit=v,w.prototype._centroid=!1,w.prototype.nodeType=`Shape`,(0,o._registerNode)(w),w.prototype.eventListeners={},w.prototype.on.call(w.prototype,`shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva`,y),w.prototype.on.call(w.prototype,`shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva`,b),w.prototype.on.call(w.prototype,`fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva`,x),w.prototype.on.call(w.prototype,`fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva`,S),w.prototype.on.call(w.prototype,`fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva`,C),r.Factory.addGetterSetter(w,`stroke`,void 0,(0,a.getStringOrGradientValidator)()),r.Factory.addGetterSetter(w,`strokeWidth`,2,(0,a.getNumberValidator)()),r.Factory.addGetterSetter(w,`fillAfterStrokeEnabled`,!1),r.Factory.addGetterSetter(w,`hitStrokeWidth`,`auto`,(0,a.getNumberOrAutoValidator)()),r.Factory.addGetterSetter(w,`strokeHitEnabled`,!0,(0,a.getBooleanValidator)()),r.Factory.addGetterSetter(w,`perfectDrawEnabled`,!0,(0,a.getBooleanValidator)()),r.Factory.addGetterSetter(w,`shadowForStrokeEnabled`,!0,(0,a.getBooleanValidator)()),r.Factory.addGetterSetter(w,`lineJoin`),r.Factory.addGetterSetter(w,`lineCap`),r.Factory.addGetterSetter(w,`sceneFunc`),r.Factory.addGetterSetter(w,`hitFunc`),r.Factory.addGetterSetter(w,`dash`),r.Factory.addGetterSetter(w,`dashOffset`,0,(0,a.getNumberValidator)()),r.Factory.addGetterSetter(w,`shadowColor`,void 0,(0,a.getStringValidator)()),r.Factory.addGetterSetter(w,`shadowBlur`,0,(0,a.getNumberValidator)()),r.Factory.addGetterSetter(w,`shadowOpacity`,1,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(w,`shadowOffset`,[`x`,`y`]),r.Factory.addGetterSetter(w,`shadowOffsetX`,0,(0,a.getNumberValidator)()),r.Factory.addGetterSetter(w,`shadowOffsetY`,0,(0,a.getNumberValidator)()),r.Factory.addGetterSetter(w,`fillPatternImage`),r.Factory.addGetterSetter(w,`fill`,void 0,(0,a.getStringOrGradientValidator)()),r.Factory.addGetterSetter(w,`fillPatternX`,0,(0,a.getNumberValidator)()),r.Factory.addGetterSetter(w,`fillPatternY`,0,(0,a.getNumberValidator)()),r.Factory.addGetterSetter(w,`fillLinearGradientColorStops`),r.Factory.addGetterSetter(w,`strokeLinearGradientColorStops`),r.Factory.addGetterSetter(w,`fillRadialGradientStartRadius`,0),r.Factory.addGetterSetter(w,`fillRadialGradientEndRadius`,0),r.Factory.addGetterSetter(w,`fillRadialGradientColorStops`),r.Factory.addGetterSetter(w,`fillPatternRepeat`,`repeat`),r.Factory.addGetterSetter(w,`fillEnabled`,!0),r.Factory.addGetterSetter(w,`strokeEnabled`,!0),r.Factory.addGetterSetter(w,`shadowEnabled`,!0),r.Factory.addGetterSetter(w,`dashEnabled`,!0),r.Factory.addGetterSetter(w,`strokeScaleEnabled`,!0),r.Factory.addGetterSetter(w,`fillPriority`,`color`),r.Factory.addComponentsGetterSetter(w,`fillPatternOffset`,[`x`,`y`]),r.Factory.addGetterSetter(w,`fillPatternOffsetX`,0,(0,a.getNumberValidator)()),r.Factory.addGetterSetter(w,`fillPatternOffsetY`,0,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(w,`fillPatternScale`,[`x`,`y`]),r.Factory.addGetterSetter(w,`fillPatternScaleX`,1,(0,a.getNumberValidator)()),r.Factory.addGetterSetter(w,`fillPatternScaleY`,1,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(w,`fillLinearGradientStartPoint`,[`x`,`y`]),r.Factory.addComponentsGetterSetter(w,`strokeLinearGradientStartPoint`,[`x`,`y`]),r.Factory.addGetterSetter(w,`fillLinearGradientStartPointX`,0),r.Factory.addGetterSetter(w,`strokeLinearGradientStartPointX`,0),r.Factory.addGetterSetter(w,`fillLinearGradientStartPointY`,0),r.Factory.addGetterSetter(w,`strokeLinearGradientStartPointY`,0),r.Factory.addComponentsGetterSetter(w,`fillLinearGradientEndPoint`,[`x`,`y`]),r.Factory.addComponentsGetterSetter(w,`strokeLinearGradientEndPoint`,[`x`,`y`]),r.Factory.addGetterSetter(w,`fillLinearGradientEndPointX`,0),r.Factory.addGetterSetter(w,`strokeLinearGradientEndPointX`,0),r.Factory.addGetterSetter(w,`fillLinearGradientEndPointY`,0),r.Factory.addGetterSetter(w,`strokeLinearGradientEndPointY`,0),r.Factory.addComponentsGetterSetter(w,`fillRadialGradientStartPoint`,[`x`,`y`]),r.Factory.addGetterSetter(w,`fillRadialGradientStartPointX`,0),r.Factory.addGetterSetter(w,`fillRadialGradientStartPointY`,0),r.Factory.addComponentsGetterSetter(w,`fillRadialGradientEndPoint`,[`x`,`y`]),r.Factory.addGetterSetter(w,`fillRadialGradientEndPointX`,0),r.Factory.addGetterSetter(w,`fillRadialGradientEndPointY`,0),r.Factory.addGetterSetter(w,`fillPatternRotation`,0),r.Factory.addGetterSetter(w,`fillRule`,void 0,(0,a.getStringValidator)()),r.Factory.backCompat(w,{dashArray:`dash`,getDashArray:`getDash`,setDashArray:`getDash`,drawFunc:`sceneFunc`,getDrawFunc:`getSceneFunc`,setDrawFunc:`setSceneFunc`,drawHitFunc:`hitFunc`,getDrawHitFunc:`getHitFunc`,setDrawHitFunc:`setHitFunc`})}),z=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Layer=void 0;let t=O(),n=F(),r=P(),i=N(),a=A(),o=M(),s=R(),c=D(),l=`#`,u=`beforeDraw`,d=`draw`,f=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],p=f.length;var m=class extends n.Container{constructor(e){super(e),this.canvas=new a.SceneCanvas,this.hitCanvas=new a.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on(`visibleChange.konva`,this._checkVisibility),this._checkVisibility(),this.on(`imageSmoothingEnabledChange.konva`,this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){let e=this.canvas._canvas;return e.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);let t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),e<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[e+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){r.Node.prototype.moveToTop.call(this);let e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){let e=r.Node.prototype.moveUp.call(this);if(!e)return!1;let t=this.getStage();return!t||!t.content?!1:(t.content.removeChild(this.getNativeCanvasElement()),this.index<t.children.length-1?t.content.insertBefore(this.getNativeCanvasElement(),t.children[this.index+1].getCanvas()._canvas):t.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(r.Node.prototype.moveDown.call(this)){let e=this.getStage();if(e){let t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(r.Node.prototype.moveToBottom.call(this)){let e=this.getStage();if(e){let t=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),t[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){let e=this.getNativeCanvasElement();return r.Node.prototype.remove.call(this),e&&e.parentNode&&t.Util._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:t}){return this.canvas.setSize(e,t),this.hitCanvas.setSize(e,t),this._setSmoothEnabled(),this}_validateAdd(e){let n=e.getType();n!==`Group`&&n!==`Shape`&&t.Util.throw(`You may only add groups and shapes to a layer.`)}_toKonvaCanvas(e){return e||={},e.width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=e.x===void 0?this.x():e.x,e.y=e.y===void 0?this.y():e.y,r.Node.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){let e=this.visible();e?this.canvas._canvas.style.display=`block`:this.canvas._canvas.style.display=`none`}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){t.Util.warn(`Can not change width of layer. Use "stage.width(value)" function instead.`)}getHeight(){if(this.parent)return this.parent.height()}setHeight(){t.Util.warn(`Can not change height of layer. Use "stage.height(value)" function instead.`)}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,t.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;let t=1,n=!1;for(;;){for(let r=0;r<p;r++){let i=f[r],a=this._getIntersection({x:e.x+i.x*t,y:e.y+i.y*t}),o=a.shape;if(o)return o;if(n=!!a.antialiased,!a.antialiased)break}if(n)t+=1;else return null}}_getIntersection(e){let n=this.hitCanvas.pixelRatio,r=this.hitCanvas.context.getImageData(Math.round(e.x*n),Math.round(e.y*n),1,1).data,i=r[3];if(i===255){let e=t.Util._rgbToHex(r[0],r[1],r[2]),n=s.shapes[l+e];return n?{shape:n}:{antialiased:!0}}else if(i>0)return{antialiased:!0};return{}}drawScene(e,t,r){let i=this.getLayer(),a=e||i&&i.getCanvas();return this._fire(u,{node:this}),this.clearBeforeDraw()&&a.getContext().clear(),n.Container.prototype.drawScene.call(this,a,t,r),this._fire(d,{node:this}),this}drawHit(e,t){let r=this.getLayer(),i=e||r&&r.hitCanvas;return r&&r.clearBeforeDraw()&&r.getHitCanvas().getContext().clear(),n.Container.prototype.drawHit.call(this,i,t),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){t.Util.warn(`hitGraphEnabled method is deprecated. Please use layer.listening() instead.`),this.listening(e)}getHitGraphEnabled(e){return t.Util.warn(`hitGraphEnabled method is deprecated. Please use layer.listening() instead.`),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;let e=this.parent,t=!!this.hitCanvas._canvas.parentNode;t?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}destroy(){return t.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};exports.Layer=m,m.prototype.nodeType=`Layer`,(0,c._registerNode)(m),i.Factory.addGetterSetter(m,`imageSmoothingEnabled`,!0),i.Factory.addGetterSetter(m,`clearBeforeDraw`,!0),i.Factory.addGetterSetter(m,`hitGraphEnabled`,!0,(0,o.getBooleanValidator)())}),B=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.FastLayer=void 0;let t=O(),n=z(),r=D();var i=class extends n.Layer{constructor(e){super(e),this.listening(!1),t.Util.warn(`Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.`)}};exports.FastLayer=i,i.prototype.nodeType=`FastLayer`,(0,r._registerNode)(i)}),V=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Group=void 0;let t=O(),n=F(),r=D();var i=class extends n.Container{_validateAdd(e){let n=e.getType();n!==`Group`&&n!==`Shape`&&t.Util.throw(`You may only add groups and shapes to groups.`)}};exports.Group=i,i.prototype.nodeType=`Group`,(0,r._registerNode)(i)}),H=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Animation=void 0;let t=D(),n=O(),r=function(){return t.glob.performance&&t.glob.performance.now?function(){return t.glob.performance.now()}:function(){return new Date().getTime()}}();var i=class e{constructor(t,n){this.id=e.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:r(),frameRate:0},this.func=t,this.setLayers(n)}setLayers(e){let t=[];return e&&(t=Array.isArray(e)?e:[e]),this.layers=t,this}getLayers(){return this.layers}addLayer(e){let t=this.layers,n=t.length;for(let r=0;r<n;r++)if(t[r]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){let t=e,n=t.animations,r=n.length;for(let e=0;e<r;e++)if(n[e].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=r(),e._addAnimation(this),this}stop(){return e._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){let t=e.id,n=this.animations,r=n.length;for(let e=0;e<r;e++)if(n[e].id===t){this.animations.splice(e,1);break}}static _runFrames(){let e={},t=this.animations;for(let n=0;n<t.length;n++){let i=t[n],a=i.layers,o=i.func;i._updateFrameObject(r());let s=a.length,c;if(c=o?o.call(i,i.frame)!==!1:!0,c)for(let t=0;t<s;t++){let n=a[t];n._id!==void 0&&(e[n._id]=n)}}for(let t in e){if(!e.hasOwnProperty(t))continue;e[t].batchDraw()}}static _animationLoop(){let t=e;t.animations.length?(t._runFrames(),n.Util.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,n.Util.requestAnimFrame(this._animationLoop))}};exports.Animation=i,i.animations=[],i.animIdCounter=0,i.animRunning=!1}),U=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Easings=exports.Tween=void 0;let t=O(),n=H(),r=P(),i=D(),a={node:1,duration:1,easing:1,onFinish:1,yoyo:1},o=1,s=2,c=3,l=[`fill`,`stroke`,`shadowColor`],u=0;var d=class{constructor(e,t,n,r,i,a,o){this.prop=e,this.propFunc=t,this.begin=r,this._pos=r,this.duration=a,this._change=0,this.prevPos=0,this.yoyo=o,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=n,this._change=i-this.begin,this.pause()}fire(e){let t=this[e];t&&t()}setTime(e){e>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():e<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=e,this.update())}getTime(){return this._time}setPosition(e){this.prevPos=this._pos,this.propFunc(e),this._pos=e}getPosition(e){return e===void 0&&(e=this._time),this.func(e,this.begin,this._change,this.duration)}play(){this.state=s,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire(`onPlay`)}reverse(){this.state=c,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire(`onReverse`)}seek(e){this.pause(),this._time=e,this.update(),this.fire(`onSeek`)}reset(){this.pause(),this._time=0,this.update(),this.fire(`onReset`)}finish(){this.pause(),this._time=this.duration,this.update(),this.fire(`onFinish`)}update(){this.setPosition(this.getPosition(this._time)),this.fire(`onUpdate`)}onEnterFrame(){let e=this.getTimer()-this._startTime;this.state===s?this.setTime(e):this.state===c&&this.setTime(this.duration-e)}pause(){this.state=o,this.fire(`onPause`)}getTimer(){return new Date().getTime()}},f=class r{constructor(o){let s=this,c=o.node,l=c._id,f=o.easing||exports.Easings.Linear,p=!!o.yoyo,m,h;m=o.duration===void 0?.3:o.duration===0?.001:o.duration,this.node=c,this._id=u++;let g=c.getLayer()||(c instanceof i.Konva.Stage?c.getLayers():null);for(h in g||t.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new n.Animation(function(){s.tween.onEnterFrame()},g),this.tween=new d(h,function(e){s._tweenFunc(e)},f,0,1,m*1e3,p),this._addListeners(),r.attrs[l]||(r.attrs[l]={}),r.attrs[l][this._id]||(r.attrs[l][this._id]={}),r.tweens[l]||(r.tweens[l]={}),o)a[h]===void 0&&this._addAttr(h,o[h]);this.reset(),this.onFinish=o.onFinish,this.onReset=o.onReset,this.onUpdate=o.onUpdate}_addAttr(e,n){let i=this.node,a=i._id,o,s,c,u,d,f=r.tweens[a][e];f&&delete r.attrs[a][f][e];let p=i.getAttr(e);if(t.Util._isArray(n))if(o=[],s=Math.max(n.length,p.length),e===`points`&&n.length!==p.length&&(n.length>p.length?(u=p,p=t.Util._prepareArrayForTween(p,n,i.closed())):(c=n,n=t.Util._prepareArrayForTween(n,p,i.closed()))),e.indexOf(`fill`)===0)for(let e=0;e<s;e++)if(e%2==0)o.push(n[e]-p[e]);else{let r=t.Util.colorToRGBA(p[e]);d=t.Util.colorToRGBA(n[e]),p[e]=r,o.push({r:d.r-r.r,g:d.g-r.g,b:d.b-r.b,a:d.a-r.a})}else for(let e=0;e<s;e++)o.push(n[e]-p[e]);else l.indexOf(e)===-1?o=n-p:(p=t.Util.colorToRGBA(p),d=t.Util.colorToRGBA(n),o={r:d.r-p.r,g:d.g-p.g,b:d.b-p.b,a:d.a-p.a});r.attrs[a][this._id][e]={start:p,diff:o,end:n,trueEnd:c,trueStart:u},r.tweens[a][e]=this._id}_tweenFunc(e){let n=this.node,i=r.attrs[n._id][this._id],a,o,s,c,u,d,f,p;for(a in i){if(o=i[a],s=o.start,c=o.diff,p=o.end,t.Util._isArray(s))if(u=[],f=Math.max(s.length,p.length),a.indexOf(`fill`)===0)for(d=0;d<f;d++)d%2==0?u.push((s[d]||0)+c[d]*e):u.push(`rgba(`+Math.round(s[d].r+c[d].r*e)+`,`+Math.round(s[d].g+c[d].g*e)+`,`+Math.round(s[d].b+c[d].b*e)+`,`+(s[d].a+c[d].a*e)+`)`);else for(d=0;d<f;d++)u.push((s[d]||0)+c[d]*e);else u=l.indexOf(a)===-1?s+c*e:`rgba(`+Math.round(s.r+c.r*e)+`,`+Math.round(s.g+c.g*e)+`,`+Math.round(s.b+c.b*e)+`,`+(s.a+c.a*e)+`)`;n.setAttr(a,u)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{let e=this.node,t=r.attrs[e._id][this._id];t.points&&t.points.trueEnd&&e.setAttr(`points`,t.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{let e=this.node,t=r.attrs[e._id][this._id];t.points&&t.points.trueStart&&e.points(t.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(e){return this.tween.seek(e*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){let e=this.node._id,t=this._id,n=r.tweens[e];for(let t in this.pause(),this.anim&&this.anim.stop(),n)delete r.tweens[e][t];delete r.attrs[e][t],r.tweens[e]&&(Object.keys(r.tweens[e]).length===0&&delete r.tweens[e],Object.keys(r.attrs[e]).length===0&&delete r.attrs[e])}};exports.Tween=f,f.attrs={},f.tweens={},r.Node.prototype.to=function(e){let t=e.onFinish;e.node=this,e.onFinish=function(){this.destroy(),t&&t()};let n=new f(e);n.play()},exports.Easings={BackEaseIn(e,t,n,r){let i=1.70158;return n*(e/=r)*e*((i+1)*e-i)+t},BackEaseOut(e,t,n,r){let i=1.70158;return n*((e=e/r-1)*e*((i+1)*e+i)+1)+t},BackEaseInOut(e,t,n,r){let i=1.70158;return(e/=r/2)<1?n/2*(e*e*(((i*=1.525)+1)*e-i))+t:n/2*((e-=2)*e*(((i*=1.525)+1)*e+i)+2)+t},ElasticEaseIn(e,t,n,r,i,a){let o=0;return e===0?t:(e/=r)===1?t+n:(a||=r*.3,!i||i<Math.abs(n)?(i=n,o=a/4):o=a/(2*Math.PI)*Math.asin(n/i),-(i*2**(10*--e)*Math.sin((e*r-o)*(2*Math.PI)/a))+t)},ElasticEaseOut(e,t,n,r,i,a){let o=0;return e===0?t:(e/=r)===1?t+n:(a||=r*.3,!i||i<Math.abs(n)?(i=n,o=a/4):o=a/(2*Math.PI)*Math.asin(n/i),i*2**(-10*e)*Math.sin((e*r-o)*(2*Math.PI)/a)+n+t)},ElasticEaseInOut(e,t,n,r,i,a){let o=0;return e===0?t:(e/=r/2)==2?t+n:(a||=r*(.3*1.5),!i||i<Math.abs(n)?(i=n,o=a/4):o=a/(2*Math.PI)*Math.asin(n/i),e<1?-.5*(i*2**(10*--e)*Math.sin((e*r-o)*(2*Math.PI)/a))+t:i*2**(-10*--e)*Math.sin((e*r-o)*(2*Math.PI)/a)*.5+n+t)},BounceEaseOut(e,t,n,r){return(e/=r)<1/2.75?n*(7.5625*e*e)+t:e<2/2.75?n*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?n*(7.5625*(e-=2.25/2.75)*e+.9375)+t:n*(7.5625*(e-=2.625/2.75)*e+.984375)+t},BounceEaseIn(t,n,r,i){return r-exports.Easings.BounceEaseOut(i-t,0,r,i)+n},BounceEaseInOut(t,n,r,i){return t<i/2?exports.Easings.BounceEaseIn(t*2,0,r,i)*.5+n:exports.Easings.BounceEaseOut(t*2-i,0,r,i)*.5+r*.5+n},EaseIn(e,t,n,r){return n*(e/=r)*e+t},EaseOut(e,t,n,r){return-n*(e/=r)*(e-2)+t},EaseInOut(e,t,n,r){return(e/=r/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t},StrongEaseIn(e,t,n,r){return n*(e/=r)*e*e*e*e+t},StrongEaseOut(e,t,n,r){return n*((e=e/r-1)*e*e*e*e+1)+t},StrongEaseInOut(e,t,n,r){return(e/=r/2)<1?n/2*e*e*e*e*e+t:n/2*((e-=2)*e*e*e*e+2)+t},Linear(e,t,n,r){return n*e/r+t}}}),W=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Konva=void 0;let t=D(),n=O(),r=P(),i=F(),a=L(),o=z(),s=B(),c=V(),l=j(),u=R(),d=H(),f=U(),p=k(),m=A();exports.Konva=n.Util._assign(t.Konva,{Util:n.Util,Transform:n.Transform,Node:r.Node,Container:i.Container,Stage:a.Stage,stages:a.stages,Layer:o.Layer,FastLayer:s.FastLayer,Group:c.Group,DD:l.DD,Shape:u.Shape,shapes:u.shapes,Animation:d.Animation,Tween:f.Tween,Easings:f.Easings,Context:p.Context,Canvas:m.Canvas}),exports.default=exports.Konva}),G=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Arc=void 0;let t=N(),n=R(),r=D(),i=M(),a=D();var o=class extends n.Shape{_sceneFunc(e){let t=r.Konva.getAngle(this.angle()),n=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,t,n),e.arc(0,0,this.innerRadius(),t,0,!n),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){let e=this.innerRadius(),t=this.outerRadius(),n=this.clockwise(),i=r.Konva.getAngle(n?360-this.angle():this.angle()),a=Math.cos(Math.min(i,Math.PI)),o=1,s=Math.sin(Math.min(Math.max(Math.PI,i),3*Math.PI/2)),c=Math.sin(Math.min(i,Math.PI/2)),l=a*(a>0?e:t),u=o*(o>0?t:e),d=s*(s>0?e:t),f=c*(c>0?t:e);return{x:l,y:n?-1*f:d,width:u-l,height:f-d}}};exports.Arc=o,o.prototype._centroid=!0,o.prototype.className=`Arc`,o.prototype._attrsAffectingSize=[`innerRadius`,`outerRadius`,`angle`,`clockwise`],(0,a._registerNode)(o),t.Factory.addGetterSetter(o,`innerRadius`,0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(o,`outerRadius`,0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(o,`angle`,0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(o,`clockwise`,!1,(0,i.getBooleanValidator)())}),K=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Line=void 0;let t=N(),n=D(),r=R(),i=M();function a(e,t,n,r,i,a,o){let s=Math.sqrt((n-e)**2+(r-t)**2),c=Math.sqrt((i-n)**2+(a-r)**2),l=o*s/(s+c),u=o*c/(s+c),d=n-l*(i-e),f=r-l*(a-t),p=n+u*(i-e),m=r+u*(a-t);return[d,f,p,m]}function o(e,t){let n=e.length,r=[];for(let i=2;i<n-2;i+=2){let n=a(e[i-2],e[i-1],e[i],e[i+1],e[i+2],e[i+3],t);isNaN(n[0])||(r.push(n[0]),r.push(n[1]),r.push(e[i]),r.push(e[i+1]),r.push(n[2]),r.push(n[3]))}return r}var s=class extends r.Shape{constructor(e){super(e),this.on(`pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva`,function(){this._clearCache(`tensionPoints`)})}_sceneFunc(e){let t=this.points(),n=t.length,r=this.tension(),i=this.closed(),a=this.bezier();if(!n)return;let o=0;if(e.beginPath(),e.moveTo(t[0],t[1]),r!==0&&n>4){let r=this.getTensionPoints(),a=r.length;for(o=i?0:4,i||e.quadraticCurveTo(r[0],r[1],r[2],r[3]);o<a-2;)e.bezierCurveTo(r[o++],r[o++],r[o++],r[o++],r[o++],r[o++]);i||e.quadraticCurveTo(r[a-2],r[a-1],t[n-2],t[n-1])}else if(a)for(o=2;o<n;)e.bezierCurveTo(t[o++],t[o++],t[o++],t[o++],t[o++],t[o++]);else for(o=2;o<n;o+=2)e.lineTo(t[o],t[o+1]);i?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}getTensionPoints(){return this._getCache(`tensionPoints`,this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():o(this.points(),this.tension())}_getTensionPointsClosed(){let e=this.points(),t=e.length,n=this.tension(),r=a(e[t-2],e[t-1],e[0],e[1],e[2],e[3],n),i=a(e[t-4],e[t-3],e[t-2],e[t-1],e[0],e[1],n),s=o(e,n),c=[r[2],r[3]].concat(s,[i[0],i[1],e[t-2],e[t-1],i[2],i[3],r[0],r[1],e[0],e[1]]);return c}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};e=this.tension()===0?this.points():[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]];let t=e[0],n=e[0],r=e[1],i=e[1],a,o;for(let s=0;s<e.length/2;s++)a=e[s*2],o=e[s*2+1],t=Math.min(t,a),n=Math.max(n,a),r=Math.min(r,o),i=Math.max(i,o);return{x:t,y:r,width:n-t,height:i-r}}};exports.Line=s,s.prototype.className=`Line`,s.prototype._attrsAffectingSize=[`points`,`bezier`,`tension`],(0,n._registerNode)(s),t.Factory.addGetterSetter(s,`closed`,!1),t.Factory.addGetterSetter(s,`bezier`,!1),t.Factory.addGetterSetter(s,`tension`,0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(s,`points`,[],(0,i.getNumberArrayValidator)())}),q=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.t2length=exports.getQuadraticArcLength=exports.getCubicArcLength=exports.binomialCoefficients=exports.cValues=exports.tValues=void 0,exports.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],exports.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],exports.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];let t=(t,n,i)=>{let a,o,s=20,c=i/2;a=0;for(let i=0;i<s;i++)o=c*exports.tValues[s][i]+c,a+=exports.cValues[s][i]*r(t,n,o);return c*a};exports.getCubicArcLength=t;let n=(e,t,n)=>{n===void 0&&(n=1);let r=e[0]-2*e[1]+e[2],i=t[0]-2*t[1]+t[2],a=2*e[1]-2*e[0],o=2*t[1]-2*t[0],s=4*(r*r+i*i),c=4*(r*a+i*o),l=a*a+o*o;if(s===0)return n*Math.sqrt((e[2]-e[0])**2+(t[2]-t[0])**2);let u=c/(2*s),d=l/s,f=n+u,p=d-u*u,m=f*f+p>0?Math.sqrt(f*f+p):0,h=u*u+p>0?Math.sqrt(u*u+p):0,g=u+Math.sqrt(u*u+p)===0?0:p*Math.log(Math.abs((f+m)/(u+h)));return Math.sqrt(s)/2*(f*m-u*h+g)};exports.getQuadraticArcLength=n;function r(e,t,n){let r=i(1,n,e),a=i(1,n,t),o=r*r+a*a;return Math.sqrt(o)}let i=(t,n,r)=>{let a=r.length-1,o,s;if(a===0)return 0;if(t===0){s=0;for(let t=0;t<=a;t++)s+=exports.binomialCoefficients[a][t]*(1-n)**(a-t)*n**+t*r[t];return s}else{o=Array(a);for(let e=0;e<a;e++)o[e]=a*(r[e+1]-r[e]);return i(t-1,n,o)}},a=(e,t,n)=>{let r=1,i=e/t,a=(e-n(i))/t,o=0;for(;r>.001;){let s=n(i+a),c=Math.abs(e-s)/t;if(c<r)r=c,i+=a;else{let o=n(i-a),s=Math.abs(e-o)/t;s<r?(r=s,i-=a):a/=2}if(o++,o>500)break}return i};exports.t2length=a}),J=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Path=void 0;let t=N(),n=D(),r=R(),i=q();var a=class e extends r.Shape{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on(`dataChange.konva`,function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=e.parsePathData(this.data()),this.pathLength=e.getPathLength(this.dataArray)}_sceneFunc(e){let t=this.dataArray;e.beginPath();let n=!1;for(let r=0;r<t.length;r++){let i=t[r].command,a=t[r].points;switch(i){case`L`:e.lineTo(a[0],a[1]);break;case`M`:e.moveTo(a[0],a[1]);break;case`C`:e.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case`Q`:e.quadraticCurveTo(a[0],a[1],a[2],a[3]);break;case`A`:let t=a[0],r=a[1],i=a[2],o=a[3],s=a[4],c=a[5],l=a[6],u=a[7],d=i>o?i:o,f=i>o?1:i/o,p=i>o?o/i:1;e.translate(t,r),e.rotate(l),e.scale(f,p),e.arc(0,0,d,s,s+c,1-u),e.scale(1/f,1/p),e.rotate(-l),e.translate(-t,-r);break;case`z`:n=!0,e.closePath();break}}!n&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){let t=[];this.dataArray.forEach(function(n){if(n.command===`A`){let r=n.points[4],i=n.points[5],a=n.points[4]+i,o=Math.PI/180;if(Math.abs(r-a)<o&&(o=Math.abs(r-a)),i<0)for(let i=r-o;i>a;i-=o){let r=e.getPointOnEllipticalArc(n.points[0],n.points[1],n.points[2],n.points[3],i,0);t.push(r.x,r.y)}else for(let i=r+o;i<a;i+=o){let r=e.getPointOnEllipticalArc(n.points[0],n.points[1],n.points[2],n.points[3],i,0);t.push(r.x,r.y)}}else if(n.command===`C`)for(let r=0;r<=1;r+=.01){let i=e.getPointOnCubicBezier(r,n.start.x,n.start.y,n.points[0],n.points[1],n.points[2],n.points[3],n.points[4],n.points[5]);t.push(i.x,i.y)}else t=t.concat(n.points)});let n=t[0],r=t[0],i=t[1],a=t[1],o,s;for(let e=0;e<t.length/2;e++)o=t[e*2],s=t[e*2+1],isNaN(o)||(n=Math.min(n,o),r=Math.max(r,o)),isNaN(s)||(i=Math.min(i,s),a=Math.max(a,s));return{x:n,y:i,width:r-n,height:a-i}}getLength(){return this.pathLength}getPointAtLength(t){return e.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(e,t,n,r){return Math.sqrt((n-e)*(n-e)+(r-t)*(r-t))}static getPathLength(e){let t=0;for(let n=0;n<e.length;++n)t+=e[n].pathLength;return t}static getPointAtLengthOfDataArray(t,n){let r,a=0,o=n.length;if(!o)return null;for(;a<o&&t>n[a].pathLength;)t-=n[a].pathLength,++a;if(a===o)return r=n[a-1].points.slice(-2),{x:r[0],y:r[1]};if(t<.01){let e=n[a].command;return e===`M`?(r=n[a].points.slice(0,2),{x:r[0],y:r[1]}):{x:n[a].start.x,y:n[a].start.y}}let s=n[a],c=s.points;switch(s.command){case`L`:return e.getPointOnLine(t,s.start.x,s.start.y,c[0],c[1]);case`C`:return e.getPointOnCubicBezier((0,i.t2length)(t,e.getPathLength(n),e=>(0,i.getCubicArcLength)([s.start.x,c[0],c[2],c[4]],[s.start.y,c[1],c[3],c[5]],e)),s.start.x,s.start.y,c[0],c[1],c[2],c[3],c[4],c[5]);case`Q`:return e.getPointOnQuadraticBezier((0,i.t2length)(t,e.getPathLength(n),e=>(0,i.getQuadraticArcLength)([s.start.x,c[0],c[2]],[s.start.y,c[1],c[3]],e)),s.start.x,s.start.y,c[0],c[1],c[2],c[3]);case`A`:let r=c[0],a=c[1],o=c[2],l=c[3],u=c[5],d=c[6],f=c[4];return f+=u*t/s.pathLength,e.getPointOnEllipticalArc(r,a,o,l,f,d)}return null}static getPointOnLine(e,t,n,r,i,a,o){a??=t,o??=n;let s=this.getLineLength(t,n,r,i);if(s<1e-10)return{x:t,y:n};if(r===t)return{x:a,y:o+(i>n?e:-e)};let c=(i-n)/(r-t),l=Math.sqrt(e*e/(1+c*c))*(r<t?-1:1),u=c*l;if(Math.abs(o-n-c*(a-t))<1e-10)return{x:a+l,y:o+u};let d=((a-t)*(r-t)+(o-n)*(i-n))/(s*s),f=t+d*(r-t),p=n+d*(i-n),m=this.getLineLength(a,o,f,p),h=Math.sqrt(e*e-m*m),g=Math.sqrt(h*h/(1+c*c))*(r<t?-1:1),_=c*g;return{x:f+g,y:p+_}}static getPointOnCubicBezier(e,t,n,r,i,a,o,s,c){function l(e){return e*e*e}function u(e){return 3*e*e*(1-e)}function d(e){return 3*e*(1-e)*(1-e)}function f(e){return(1-e)*(1-e)*(1-e)}let p=s*l(e)+a*u(e)+r*d(e)+t*f(e),m=c*l(e)+o*u(e)+i*d(e)+n*f(e);return{x:p,y:m}}static getPointOnQuadraticBezier(e,t,n,r,i,a,o){function s(e){return e*e}function c(e){return 2*e*(1-e)}function l(e){return(1-e)*(1-e)}let u=a*s(e)+r*c(e)+t*l(e),d=o*s(e)+i*c(e)+n*l(e);return{x:u,y:d}}static getPointOnEllipticalArc(e,t,n,r,i,a){let o=Math.cos(a),s=Math.sin(a),c={x:n*Math.cos(i),y:r*Math.sin(i)};return{x:e+(c.x*o-c.y*s),y:t+(c.x*s+c.y*o)}}static parsePathData(e){if(!e)return[];let t=e,n=[`m`,`M`,`l`,`L`,`v`,`V`,`h`,`H`,`z`,`Z`,`c`,`C`,`q`,`Q`,`t`,`T`,`s`,`S`,`a`,`A`];t=t.replace(RegExp(` `,`g`),`,`);for(let e=0;e<n.length;e++)t=t.replace(new RegExp(n[e],`g`),`|`+n[e]);let r=t.split(`|`),i=[],a=[],o=0,s=0,c=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi,l;for(let e=1;e<r.length;e++){let t=r[e],n=t.charAt(0);for(t=t.slice(1),a.length=0;l=c.exec(t);)a.push(l[0]);let u=[];for(let e=0,t=a.length;e<t;e++){if(a[e]===`00`){u.push(0,0);continue}let t=parseFloat(a[e]);isNaN(t)?u.push(0):u.push(t)}for(;u.length>0&&!isNaN(u[0]);){let e=``,t=[],r=o,a=s,c,l,d,f,p,m,h,g,_,v;switch(n){case`l`:o+=u.shift(),s+=u.shift(),e=`L`,t.push(o,s);break;case`L`:o=u.shift(),s=u.shift(),t.push(o,s);break;case`m`:let r=u.shift(),a=u.shift();if(o+=r,s+=a,e=`M`,i.length>2&&i[i.length-1].command===`z`){for(let e=i.length-2;e>=0;e--)if(i[e].command===`M`){o=i[e].points[0]+r,s=i[e].points[1]+a;break}}t.push(o,s),n=`l`;break;case`M`:o=u.shift(),s=u.shift(),e=`M`,t.push(o,s),n=`L`;break;case`h`:o+=u.shift(),e=`L`,t.push(o,s);break;case`H`:o=u.shift(),e=`L`,t.push(o,s);break;case`v`:s+=u.shift(),e=`L`,t.push(o,s);break;case`V`:s=u.shift(),e=`L`,t.push(o,s);break;case`C`:t.push(u.shift(),u.shift(),u.shift(),u.shift()),o=u.shift(),s=u.shift(),t.push(o,s);break;case`c`:t.push(o+u.shift(),s+u.shift(),o+u.shift(),s+u.shift()),o+=u.shift(),s+=u.shift(),e=`C`,t.push(o,s);break;case`S`:l=o,d=s,c=i[i.length-1],c.command===`C`&&(l=o+(o-c.points[2]),d=s+(s-c.points[3])),t.push(l,d,u.shift(),u.shift()),o=u.shift(),s=u.shift(),e=`C`,t.push(o,s);break;case`s`:l=o,d=s,c=i[i.length-1],c.command===`C`&&(l=o+(o-c.points[2]),d=s+(s-c.points[3])),t.push(l,d,o+u.shift(),s+u.shift()),o+=u.shift(),s+=u.shift(),e=`C`,t.push(o,s);break;case`Q`:t.push(u.shift(),u.shift()),o=u.shift(),s=u.shift(),t.push(o,s);break;case`q`:t.push(o+u.shift(),s+u.shift()),o+=u.shift(),s+=u.shift(),e=`Q`,t.push(o,s);break;case`T`:l=o,d=s,c=i[i.length-1],c.command===`Q`&&(l=o+(o-c.points[0]),d=s+(s-c.points[1])),o=u.shift(),s=u.shift(),e=`Q`,t.push(l,d,o,s);break;case`t`:l=o,d=s,c=i[i.length-1],c.command===`Q`&&(l=o+(o-c.points[0]),d=s+(s-c.points[1])),o+=u.shift(),s+=u.shift(),e=`Q`,t.push(l,d,o,s);break;case`A`:f=u.shift(),p=u.shift(),m=u.shift(),h=u.shift(),g=u.shift(),_=o,v=s,o=u.shift(),s=u.shift(),e=`A`,t=this.convertEndpointToCenterParameterization(_,v,o,s,h,g,f,p,m);break;case`a`:f=u.shift(),p=u.shift(),m=u.shift(),h=u.shift(),g=u.shift(),_=o,v=s,o+=u.shift(),s+=u.shift(),e=`A`,t=this.convertEndpointToCenterParameterization(_,v,o,s,h,g,f,p,m);break}i.push({command:e||n,points:t,start:{x:r,y:a},pathLength:this.calcLength(r,a,e||n,t)})}(n===`z`||n===`Z`)&&i.push({command:`z`,points:[],start:void 0,pathLength:0})}return i}static calcLength(t,n,r,a){let o,s,c,l,u=e;switch(r){case`L`:return u.getLineLength(t,n,a[0],a[1]);case`C`:return(0,i.getCubicArcLength)([t,a[0],a[2],a[4]],[n,a[1],a[3],a[5]],1);case`Q`:return(0,i.getQuadraticArcLength)([t,a[0],a[2]],[n,a[1],a[3]],1);case`A`:o=0;let e=a[4],r=a[5],d=a[4]+r,f=Math.PI/180;if(Math.abs(e-d)<f&&(f=Math.abs(e-d)),s=u.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],e,0),r<0)for(l=e-f;l>d;l-=f)c=u.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],l,0),o+=u.getLineLength(s.x,s.y,c.x,c.y),s=c;else for(l=e+f;l<d;l+=f)c=u.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],l,0),o+=u.getLineLength(s.x,s.y,c.x,c.y),s=c;return c=u.getPointOnEllipticalArc(a[0],a[1],a[2],a[3],d,0),o+=u.getLineLength(s.x,s.y,c.x,c.y),o}return 0}static convertEndpointToCenterParameterization(e,t,n,r,i,a,o,s,c){let l=c*(Math.PI/180),u=Math.cos(l)*(e-n)/2+Math.sin(l)*(t-r)/2,d=-1*Math.sin(l)*(e-n)/2+Math.cos(l)*(t-r)/2,f=u*u/(o*o)+d*d/(s*s);f>1&&(o*=Math.sqrt(f),s*=Math.sqrt(f));let p=Math.sqrt((o*o*(s*s)-o*o*(d*d)-s*s*(u*u))/(o*o*(d*d)+s*s*(u*u)));i===a&&(p*=-1),isNaN(p)&&(p=0);let m=p*o*d/s,h=p*-s*u/o,g=(e+n)/2+Math.cos(l)*m-Math.sin(l)*h,_=(t+r)/2+Math.sin(l)*m+Math.cos(l)*h,v=function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])},y=function(e,t){return(e[0]*t[0]+e[1]*t[1])/(v(e)*v(t))},b=function(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(y(e,t))},x=b([1,0],[(u-m)/o,(d-h)/s]),S=[(u-m)/o,(d-h)/s],C=[(-1*u-m)/o,(-1*d-h)/s],w=b(S,C);return y(S,C)<=-1&&(w=Math.PI),y(S,C)>=1&&(w=0),a===0&&w>0&&(w-=2*Math.PI),a===1&&w<0&&(w+=2*Math.PI),[g,_,o,s,x,w,l,a]}};exports.Path=a,a.prototype.className=`Path`,a.prototype._attrsAffectingSize=[`data`],(0,n._registerNode)(a),t.Factory.addGetterSetter(a,`data`)}),Y=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Arrow=void 0;let t=N(),n=K(),r=M(),i=D(),a=J();var o=class extends n.Line{_sceneFunc(e){super._sceneFunc(e);let t=Math.PI*2,n=this.points(),r=n,i=this.tension()!==0&&n.length>4;i&&(r=this.getTensionPoints());let o=this.pointerLength(),s=n.length,c,l;if(i){let e=[r[r.length-4],r[r.length-3],r[r.length-2],r[r.length-1],n[s-2],n[s-1]],t=a.Path.calcLength(r[r.length-4],r[r.length-3],`C`,e),i=a.Path.getPointOnQuadraticBezier(Math.min(1,1-o/t),e[0],e[1],e[2],e[3],e[4],e[5]);c=n[s-2]-i.x,l=n[s-1]-i.y}else c=n[s-2]-n[s-4],l=n[s-1]-n[s-3];let u=(Math.atan2(l,c)+t)%t,d=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(n[s-2],n[s-1]),e.rotate(u),e.moveTo(0,0),e.lineTo(-o,d/2),e.lineTo(-o,-d/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(n[0],n[1]),i?(c=(r[0]+r[2])/2-n[0],l=(r[1]+r[3])/2-n[1]):(c=n[2]-n[0],l=n[3]-n[1]),e.rotate((Math.atan2(-l,-c)+t)%t),e.moveTo(0,0),e.lineTo(-o,d/2),e.lineTo(-o,-d/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){let t=this.dashEnabled();t&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),t&&(this.attrs.dashEnabled=!0)}getSelfRect(){let e=super.getSelfRect(),t=this.pointerWidth()/2;return{x:e.x,y:e.y-t,width:e.width,height:e.height+t*2}}};exports.Arrow=o,o.prototype.className=`Arrow`,(0,i._registerNode)(o),t.Factory.addGetterSetter(o,`pointerLength`,10,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(o,`pointerWidth`,10,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(o,`pointerAtBeginning`,!1),t.Factory.addGetterSetter(o,`pointerAtEnding`,!0)}),X=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Circle=void 0;let t=N(),n=R(),r=M(),i=D();var a=class extends n.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}};exports.Circle=a,a.prototype._centroid=!0,a.prototype.className=`Circle`,a.prototype._attrsAffectingSize=[`radius`],(0,i._registerNode)(a),t.Factory.addGetterSetter(a,`radius`,0,(0,r.getNumberValidator)())}),Z=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Ellipse=void 0;let t=N(),n=R(),r=M(),i=D();var a=class extends n.Shape{_sceneFunc(e){let t=this.radiusX(),n=this.radiusY();e.beginPath(),e.save(),t!==n&&e.scale(1,n/t),e.arc(0,0,t,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}};exports.Ellipse=a,a.prototype.className=`Ellipse`,a.prototype._centroid=!0,a.prototype._attrsAffectingSize=[`radiusX`,`radiusY`],(0,i._registerNode)(a),t.Factory.addComponentsGetterSetter(a,`radius`,[`x`,`y`]),t.Factory.addGetterSetter(a,`radiusX`,0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(a,`radiusY`,0,(0,r.getNumberValidator)())}),ee=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Image=void 0;let t=O(),n=N(),r=R(),i=D(),a=M();var o=class e extends r.Shape{constructor(e){super(e),this._loadListener=()=>{this._requestDraw()},this.on(`imageChange.konva`,e=>{this._removeImageLoad(e.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){let e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener(`load`,this._loadListener)}_removeImageLoad(e){e&&e.removeEventListener&&e.removeEventListener(`load`,this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){let e=!!this.cornerRadius(),t=this.hasShadow();return e&&t?!0:super._useBufferCanvas(!0)}_sceneFunc(e){let n=this.getWidth(),r=this.getHeight(),i=this.cornerRadius(),a=this.attrs.image,o;if(a){let e=this.attrs.cropWidth,t=this.attrs.cropHeight;o=e&&t?[a,this.cropX(),this.cropY(),e,t,0,0,n,r]:[a,0,0,n,r]}(this.hasFill()||this.hasStroke()||i)&&(e.beginPath(),i?t.Util.drawRoundedRectPath(e,n,r,i):e.rect(0,0,n,r),e.closePath(),e.fillStrokeShape(this)),a&&(i&&e.clip(),e.drawImage.apply(e,o))}_hitFunc(e){let n=this.width(),r=this.height(),i=this.cornerRadius();e.beginPath(),i?t.Util.drawRoundedRectPath(e,n,r,i):e.rect(0,0,n,r),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,t;return(e=this.attrs.width)??(t=this.image())?.width}getHeight(){var e,t;return(e=this.attrs.height)??(t=this.image())?.height}static fromURL(n,r,i=null){let a=t.Util.createImageElement();a.onload=function(){let t=new e({image:a});r(t)},a.onerror=i,a.crossOrigin=`Anonymous`,a.src=n}};exports.Image=o,o.prototype.className=`Image`,(0,i._registerNode)(o),n.Factory.addGetterSetter(o,`cornerRadius`,0,(0,a.getNumberOrArrayOfNumbersValidator)(4)),n.Factory.addGetterSetter(o,`image`),n.Factory.addComponentsGetterSetter(o,`crop`,[`x`,`y`,`width`,`height`]),n.Factory.addGetterSetter(o,`cropX`,0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(o,`cropY`,0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(o,`cropWidth`,0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(o,`cropHeight`,0,(0,a.getNumberValidator)())}),te=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Tag=exports.Label=void 0;let t=N(),n=R(),r=V(),i=M(),a=D(),o=[`fontFamily`,`fontSize`,`fontStyle`,`padding`,`lineHeight`,`text`,`width`,`height`,`pointerDirection`,`pointerWidth`,`pointerHeight`],s=`Change.konva`,c=`none`,l=`up`,u=`right`,d=`down`,f=`left`,p=o.length;var m=class extends r.Group{constructor(e){super(e),this.on(`add.konva`,function(e){this._addListeners(e.child),this._sync()})}getText(){return this.find(`Text`)[0]}getTag(){return this.find(`Tag`)[0]}_addListeners(e){let t=this,n,r=function(){t._sync()};for(n=0;n<p;n++)e.on(o[n]+s,r)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let e=this.getText(),t=this.getTag(),n,r,i,a,o,s,c;if(e&&t){switch(n=e.width(),r=e.height(),i=t.pointerDirection(),a=t.pointerWidth(),c=t.pointerHeight(),o=0,s=0,i){case l:o=n/2,s=-1*c;break;case u:o=n+a,s=r/2;break;case d:o=n/2,s=r+c;break;case f:o=-1*a,s=r/2;break}t.setAttrs({x:-1*o,y:-1*s,width:n,height:r}),e.setAttrs({x:-1*o,y:-1*s})}}};exports.Label=m,m.prototype.className=`Label`,(0,a._registerNode)(m);var h=class extends n.Shape{_sceneFunc(e){let t=this.width(),n=this.height(),r=this.pointerDirection(),i=this.pointerWidth(),a=this.pointerHeight(),o=this.cornerRadius(),s=0,c=0,p=0,m=0;typeof o==`number`?s=c=p=m=Math.min(o,t/2,n/2):(s=Math.min(o[0]||0,t/2,n/2),c=Math.min(o[1]||0,t/2,n/2),m=Math.min(o[2]||0,t/2,n/2),p=Math.min(o[3]||0,t/2,n/2)),e.beginPath(),e.moveTo(s,0),r===l&&(e.lineTo((t-i)/2,0),e.lineTo(t/2,-1*a),e.lineTo((t+i)/2,0)),e.lineTo(t-c,0),e.arc(t-c,c,c,Math.PI*3/2,0,!1),r===u&&(e.lineTo(t,(n-a)/2),e.lineTo(t+i,n/2),e.lineTo(t,(n+a)/2)),e.lineTo(t,n-m),e.arc(t-m,n-m,m,0,Math.PI/2,!1),r===d&&(e.lineTo((t+i)/2,n),e.lineTo(t/2,n+a),e.lineTo((t-i)/2,n)),e.lineTo(p,n),e.arc(p,n-p,p,Math.PI/2,Math.PI,!1),r===f&&(e.lineTo(0,(n+a)/2),e.lineTo(-1*i,n/2),e.lineTo(0,(n-a)/2)),e.lineTo(0,s),e.arc(s,s,s,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){let e=0,t=0,n=this.pointerWidth(),r=this.pointerHeight(),i=this.pointerDirection(),a=this.width(),o=this.height();return i===l?(t-=r,o+=r):i===d?o+=r:i===f?(e-=n*1.5,a+=n):i===u&&(a+=n*1.5),{x:e,y:t,width:a,height:o}}};exports.Tag=h,h.prototype.className=`Tag`,(0,a._registerNode)(h),t.Factory.addGetterSetter(h,`pointerDirection`,c),t.Factory.addGetterSetter(h,`pointerWidth`,0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(h,`pointerHeight`,0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(h,`cornerRadius`,0,(0,i.getNumberOrArrayOfNumbersValidator)(4))}),Q=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Rect=void 0;let t=N(),n=R(),r=D(),i=O(),a=M();var o=class extends n.Shape{_sceneFunc(e){let t=this.cornerRadius(),n=this.width(),r=this.height();e.beginPath(),t?i.Util.drawRoundedRectPath(e,n,r,t):e.rect(0,0,n,r),e.closePath(),e.fillStrokeShape(this)}};exports.Rect=o,o.prototype.className=`Rect`,(0,r._registerNode)(o),t.Factory.addGetterSetter(o,`cornerRadius`,0,(0,a.getNumberOrArrayOfNumbersValidator)(4))}),ne=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.RegularPolygon=void 0;let t=N(),n=R(),r=M(),i=D();var a=class extends n.Shape{_sceneFunc(e){let t=this._getPoints();e.beginPath(),e.moveTo(t[0].x,t[0].y);for(let n=1;n<t.length;n++)e.lineTo(t[n].x,t[n].y);e.closePath(),e.fillStrokeShape(this)}_getPoints(){let e=this.attrs.sides,t=this.attrs.radius||0,n=[];for(let r=0;r<e;r++)n.push({x:t*Math.sin(r*2*Math.PI/e),y:-1*t*Math.cos(r*2*Math.PI/e)});return n}getSelfRect(){let e=this._getPoints(),t=e[0].x,n=e[0].y,r=e[0].x,i=e[0].y;return e.forEach(e=>{t=Math.min(t,e.x),n=Math.max(n,e.x),r=Math.min(r,e.y),i=Math.max(i,e.y)}),{x:t,y:r,width:n-t,height:i-r}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}};exports.RegularPolygon=a,a.prototype.className=`RegularPolygon`,a.prototype._centroid=!0,a.prototype._attrsAffectingSize=[`radius`],(0,i._registerNode)(a),t.Factory.addGetterSetter(a,`radius`,0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(a,`sides`,0,(0,r.getNumberValidator)())}),re=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Ring=void 0;let t=N(),n=R(),r=M(),i=D(),a=Math.PI*2;var o=class extends n.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,a,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),a,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}};exports.Ring=o,o.prototype.className=`Ring`,o.prototype._centroid=!0,o.prototype._attrsAffectingSize=[`innerRadius`,`outerRadius`],(0,i._registerNode)(o),t.Factory.addGetterSetter(o,`innerRadius`,0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(o,`outerRadius`,0,(0,r.getNumberValidator)())}),ie=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Sprite=void 0;let t=N(),n=R(),r=H(),i=M(),a=D();var o=class extends n.Shape{constructor(e){super(e),this._updated=!0,this.anim=new r.Animation(()=>{let e=this._updated;return this._updated=!1,e}),this.on(`animationChange.konva`,function(){this.frameIndex(0)}),this.on(`frameIndexChange.konva`,function(){this._updated=!0}),this.on(`frameRateChange.konva`,function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){let t=this.animation(),n=this.frameIndex(),r=n*4,i=this.animations()[t],a=this.frameOffsets(),o=i[r+0],s=i[r+1],c=i[r+2],l=i[r+3],u=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,c,l),e.closePath(),e.fillStrokeShape(this)),u)if(a){let r=a[t],i=n*2;e.drawImage(u,o,s,c,l,r[i+0],r[i+1],c,l)}else e.drawImage(u,o,s,c,l,0,0,c,l)}_hitFunc(e){let t=this.animation(),n=this.frameIndex(),r=n*4,i=this.animations()[t],a=this.frameOffsets(),o=i[r+2],s=i[r+3];if(e.beginPath(),a){let r=a[t],i=n*2;e.rect(r[i+0],r[i+1],o,s)}else e.rect(0,0,o,s);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){let e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;let e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){let e=this.frameIndex(),t=this.animation(),n=this.animations(),r=n[t],i=r.length/4;e<i-1?this.frameIndex(e+1):this.frameIndex(0)}};exports.Sprite=o,o.prototype.className=`Sprite`,(0,a._registerNode)(o),t.Factory.addGetterSetter(o,`animation`),t.Factory.addGetterSetter(o,`animations`),t.Factory.addGetterSetter(o,`frameOffsets`),t.Factory.addGetterSetter(o,`image`),t.Factory.addGetterSetter(o,`frameIndex`,0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(o,`frameRate`,17,(0,i.getNumberValidator)()),t.Factory.backCompat(o,{index:`frameIndex`,getIndex:`getFrameIndex`,setIndex:`setFrameIndex`})}),ae=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Star=void 0;let t=N(),n=R(),r=M(),i=D();var a=class extends n.Shape{_sceneFunc(e){let t=this.innerRadius(),n=this.outerRadius(),r=this.numPoints();e.beginPath(),e.moveTo(0,0-n);for(let i=1;i<r*2;i++){let a=i%2==0?n:t,o=a*Math.sin(i*Math.PI/r),s=-1*a*Math.cos(i*Math.PI/r);e.lineTo(o,s)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}};exports.Star=a,a.prototype.className=`Star`,a.prototype._centroid=!0,a.prototype._attrsAffectingSize=[`innerRadius`,`outerRadius`],(0,i._registerNode)(a),t.Factory.addGetterSetter(a,`numPoints`,5,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(a,`innerRadius`,0,(0,r.getNumberValidator)()),t.Factory.addGetterSetter(a,`outerRadius`,0,(0,r.getNumberValidator)())}),oe=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Text=void 0,exports.stringToArray=s;let t=O(),n=N(),r=R(),i=D(),a=M(),o=D();function s(e){return[...e].reduce((e,t,n,r)=>{if(/\p{Emoji}/u.test(t)){let i=r[n+1];i&&/\p{Emoji_Modifier}|\u200D/u.test(i)?(e.push(t+i),r[n+1]=``):e.push(t)}else /\p{Regional_Indicator}{2}/u.test(t+(r[n+1]||``))?e.push(t+r[n+1]):n>0&&/\p{Mn}|\p{Me}|\p{Mc}/u.test(t)?e[e.length-1]+=t:t&&e.push(t);return e},[])}let c=`auto`,l=`center`,u=`inherit`,d=`justify`,f=`Change.konva`,p=`2d`,m=`-`,h=`left`,g=`text`,_=`Text`,v=`top`,y=`bottom`,b=`middle`,x=`normal`,S=`px `,C=` `,w=`right`,T=`rtl`,E=`word`,k=`char`,A=`none`,j=`…`,P=[`direction`,`fontFamily`,`fontSize`,`fontStyle`,`fontVariant`,`padding`,`align`,`verticalAlign`,`lineHeight`,`text`,`width`,`height`,`wrap`,`ellipsis`,`letterSpacing`],F=P.length;function I(e){return e.split(`,`).map(e=>{e=e.trim();let t=e.indexOf(` `)>=0,n=e.indexOf(`"`)>=0||e.indexOf(`'`)>=0;return t&&!n&&(e=`"${e}"`),e}).join(`, `)}let L;function z(){return L||(L=t.Util.createCanvasElement().getContext(p),L)}function B(e){e.fillText(this._partialText,this._partialTextX,this._partialTextY)}function V(e){e.setAttr(`miterLimit`,2),e.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function H(e){return e||={},!e.fillLinearGradientColorStops&&!e.fillRadialGradientColorStops&&!e.fillPatternImage&&(e.fill=e.fill||`black`),e}var U=class extends r.Shape{constructor(e){super(H(e)),this._partialTextX=0,this._partialTextY=0;for(let e=0;e<F;e++)this.on(P[e]+f,this._setTextData);this._setTextData()}_sceneFunc(e){let t=this.textArr,n=t.length;if(!this.text())return;let r=this.padding(),a=this.fontSize(),o=this.lineHeight()*a,c=this.verticalAlign(),f=this.direction(),p=0,m=this.align(),g=this.getWidth(),_=this.letterSpacing(),v=this.fill(),x=this.textDecoration(),S=x.indexOf(`underline`)!==-1,C=x.indexOf(`line-through`)!==-1,E;f=f===u?e.direction:f;let D=o/2,O=b;if(i.Konva._fixTextRendering){let e=this.measureSize(`M`);O=`alphabetic`,D=(e.fontBoundingBoxAscent-e.fontBoundingBoxDescent)/2+o/2}for(f===T&&e.setAttr(`direction`,f),e.setAttr(`font`,this._getContextFont()),e.setAttr(`textBaseline`,O),e.setAttr(`textAlign`,h),c===b?p=(this.getHeight()-n*o-r*2)/2:c===y&&(p=this.getHeight()-n*o-r*2),e.translate(r,p+r),E=0;E<n;E++){let c=0,u=0,p=t[E],h=p.text,y=p.width,b=p.lastInParagraph;if(e.save(),m===w?c+=g-y-r*2:m===l&&(c+=(g-y-r*2)/2),S){e.save(),e.beginPath();let t=i.Konva._fixTextRendering?Math.round(a/4):Math.round(a/2),n=c,o=D+u+t;e.moveTo(n,o);let s=m===d&&!b?g-r*2:y;e.lineTo(n+Math.round(s),o),e.lineWidth=a/15;let l=this._getLinearGradient();e.strokeStyle=l||v,e.stroke(),e.restore()}if(C){e.save(),e.beginPath();let t=i.Konva._fixTextRendering?-Math.round(a/4):0;e.moveTo(c,D+u+t);let n=m===d&&!b?g-r*2:y;e.lineTo(c+Math.round(n),D+u+t),e.lineWidth=a/15;let o=this._getLinearGradient();e.strokeStyle=o||v,e.stroke(),e.restore()}if(f!==T&&(_!==0||m===d)){let t=h.split(` `).length-1,n=s(h);for(let i=0;i<n.length;i++){let a=n[i];a===` `&&!b&&m===d&&(c+=(g-r*2-y)/t),this._partialTextX=c,this._partialTextY=D+u,this._partialText=a,e.fillStrokeShape(this),c+=this.measureSize(a).width+_}}else _!==0&&e.setAttr(`letterSpacing`,`${_}px`),this._partialTextX=c,this._partialTextY=D+u,this._partialText=h,e.fillStrokeShape(this);e.restore(),n>1&&(D+=o)}}_hitFunc(e){let t=this.getWidth(),n=this.getHeight();e.beginPath(),e.rect(0,0,t,n),e.closePath(),e.fillStrokeShape(this)}setText(e){let n=t.Util._isString(e)?e:e==null?``:e+``;return this._setAttr(g,n),this}getWidth(){let e=this.attrs.width===c||this.attrs.width===void 0;return e?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){let e=this.attrs.height===c||this.attrs.height===void 0;return e?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn(`text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height.`),this.textHeight}measureSize(e){var t,n,r,i,a,o,s,c,l,u,d;let f=z(),p=this.fontSize(),m;f.save(),f.font=this._getContextFont(),m=f.measureText(e),f.restore();let h=p/100;return{actualBoundingBoxAscent:(t=m.actualBoundingBoxAscent)??71.58203125*h,actualBoundingBoxDescent:(n=m.actualBoundingBoxDescent)??0,actualBoundingBoxLeft:(r=m.actualBoundingBoxLeft)??-7.421875*h,actualBoundingBoxRight:(i=m.actualBoundingBoxRight)??75.732421875*h,alphabeticBaseline:(a=m.alphabeticBaseline)??0,emHeightAscent:(o=m.emHeightAscent)??100*h,emHeightDescent:(s=m.emHeightDescent)??-20*h,fontBoundingBoxAscent:(c=m.fontBoundingBoxAscent)??91*h,fontBoundingBoxDescent:(l=m.fontBoundingBoxDescent)??21*h,hangingBaseline:(u=m.hangingBaseline)??72.80000305175781*h,ideographicBaseline:(d=m.ideographicBaseline)??-21*h,width:m.width,height:p}}_getContextFont(){return this.fontStyle()+C+this.fontVariant()+C+(this.fontSize()+S)+I(this.fontFamily())}_addTextLine(e){let t=this.align();t===d&&(e=e.trim());let n=this._getTextWidth(e);return this.textArr.push({text:e,width:n,lastInParagraph:!1})}_getTextWidth(e){let t=this.letterSpacing(),n=e.length;return z().measureText(e).width+t*n}_setTextData(){let e=this.text().split(`
`),t=+this.fontSize(),n=0,r=this.lineHeight()*t,i=this.attrs.width,a=this.attrs.height,o=i!==c&&i!==void 0,l=a!==c&&a!==void 0,u=this.padding(),d=i-u*2,f=a-u*2,p=0,h=this.wrap(),g=h!==A,_=h!==k&&g,v=this.ellipsis();this.textArr=[],z().font=this._getContextFont();let y=v?this._getTextWidth(j):0;for(let t=0,i=e.length;t<i;++t){let a=e[t],c=this._getTextWidth(a);if(o&&c>d)for(;a.length>0;){let e=0,t=s(a).length,i=``,o=0;for(;e<t;){let n=e+t>>>1,c=s(a),u=c.slice(0,n+1).join(``),m=this._getTextWidth(u),h=v&&l&&p+r>f,g=h?m+y:m;g<=d?(e=n+1,i=u,o=m):t=n}if(i){if(_){let t=s(a),n=s(i),r=t[n.length],c=r===C||r===m,l;if(c&&o<=d)l=n.length;else{let e=n.lastIndexOf(C),t=n.lastIndexOf(m);l=Math.max(e,t)+1}l>0&&(e=l,i=t.slice(0,e).join(``),o=this._getTextWidth(i))}i=i.trimRight(),this._addTextLine(i),n=Math.max(n,o),p+=r;let t=this._shouldHandleEllipsis(p);if(t){this._tryToAddEllipsisToLastLine();break}let l=s(a);if(a=l.slice(e).join(``).trimLeft(),a.length>0&&(c=this._getTextWidth(a),c<=d)){this._addTextLine(a),p+=r,n=Math.max(n,c);break}}else break}else this._addTextLine(a),p+=r,n=Math.max(n,c),this._shouldHandleEllipsis(p)&&t<i-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),l&&p+r>f)break}this.textHeight=t,this.textWidth=n}_shouldHandleEllipsis(e){let t=+this.fontSize(),n=this.lineHeight()*t,r=this.attrs.height,i=r!==c&&r!==void 0,a=this.padding(),o=r-a*2,s=this.wrap(),l=s!==A;return!l||i&&e+n>o}_tryToAddEllipsisToLastLine(){let e=this.attrs.width,t=e!==c&&e!==void 0,n=this.padding(),r=e-n*2,i=this.ellipsis(),a=this.textArr[this.textArr.length-1];if(!(!a||!i)){if(t){let e=this._getTextWidth(a.text+j)<r;e||(a.text=a.text.slice(0,a.text.length-3))}this.textArr.splice(this.textArr.length-1,1),this._addTextLine(a.text+j)}}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){let e=this.textDecoration().indexOf(`underline`)!==-1||this.textDecoration().indexOf(`line-through`)!==-1,t=this.hasShadow();return e&&t?!0:super._useBufferCanvas()}};exports.Text=U,U.prototype._fillFunc=B,U.prototype._strokeFunc=V,U.prototype.className=_,U.prototype._attrsAffectingSize=[`text`,`fontSize`,`padding`,`wrap`,`lineHeight`,`letterSpacing`],(0,o._registerNode)(U),n.Factory.overWriteSetter(U,`width`,(0,a.getNumberOrAutoValidator)()),n.Factory.overWriteSetter(U,`height`,(0,a.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(U,`direction`,u),n.Factory.addGetterSetter(U,`fontFamily`,`Arial`),n.Factory.addGetterSetter(U,`fontSize`,12,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(U,`fontStyle`,x),n.Factory.addGetterSetter(U,`fontVariant`,x),n.Factory.addGetterSetter(U,`padding`,0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(U,`align`,h),n.Factory.addGetterSetter(U,`verticalAlign`,v),n.Factory.addGetterSetter(U,`lineHeight`,1,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(U,`wrap`,E),n.Factory.addGetterSetter(U,`ellipsis`,!1,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(U,`letterSpacing`,0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(U,`text`,``,(0,a.getStringValidator)()),n.Factory.addGetterSetter(U,`textDecoration`,``)}),se=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.TextPath=void 0;let t=O(),n=N(),r=R(),i=J(),a=oe(),o=M(),s=D(),c=``,l=`normal`;function u(e){e.fillText(this.partialText,0,0)}function d(e){e.strokeText(this.partialText,0,0)}var f=class extends r.Shape{constructor(e){super(e),this.dummyCanvas=t.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on(`dataChange.konva`,function(){this._readDataAttribute(),this._setTextData()}),this.on(`textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva`,this._setTextData),this._setTextData()}_getTextPathLength(){return i.Path.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;let t=this.pathLength;return e-1>t?null:i.Path.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=i.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr(`font`,this._getContextFont()),e.setAttr(`textBaseline`,this.textBaseline()),e.setAttr(`textAlign`,`left`),e.save();let t=this.textDecoration(),n=this.fill(),r=this.fontSize(),i=this.glyphInfo;t===`underline`&&e.beginPath();for(let n=0;n<i.length;n++){e.save();let a=i[n].p0;e.translate(a.x,a.y),e.rotate(i[n].rotation),this.partialText=i[n].text,e.fillStrokeShape(this),t===`underline`&&(n===0&&e.moveTo(0,r/2+1),e.lineTo(r,r/2+1)),e.restore()}t===`underline`&&(e.strokeStyle=n,e.lineWidth=r/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();let t=this.glyphInfo;if(t.length>=1){let n=t[0].p0;e.moveTo(n.x,n.y)}for(let n=0;n<t.length;n++){let r=t[n].p1;e.lineTo(r.x,r.y)}e.setAttr(`lineWidth`,this.fontSize()),e.setAttr(`strokeStyle`,this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return t.Util.warn(`text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height.`),this.textHeight}setText(e){return a.Text.prototype.setText.call(this,e)}_getContextFont(){return a.Text.prototype._getContextFont.call(this)}_getTextSize(e){let t=this.dummyCanvas,n=t.getContext(`2d`);n.save(),n.font=this._getContextFont();let r=n.measureText(e);return n.restore(),{width:r.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){let{width:e,height:t}=this._getTextSize(this.attrs.text);if(this.textWidth=e,this.textHeight=t,this.glyphInfo=[],!this.attrs.data)return null;let n=this.letterSpacing(),r=this.align(),o=this.kerningFunc(),s=Math.max(this.textWidth+((this.attrs.text||``).length-1)*n,0),c=0;r===`center`&&(c=Math.max(0,this.pathLength/2-s/2)),r===`right`&&(c=Math.max(0,this.pathLength-s));let l=(0,a.stringToArray)(this.text()),u=c;for(let e=0;e<l.length;e++){let t=this._getPointAtLength(u);if(!t)return;let a=this._getTextSize(l[e]).width+n;if(l[e]===` `&&r===`justify`){let e=this.text().split(` `).length-1;a+=(this.pathLength-s)/e}let c=this._getPointAtLength(u+a);if(!c)return;let d=i.Path.getLineLength(t.x,t.y,c.x,c.y),f=0;if(o)try{f=o(l[e-1],l[e])*this.fontSize()}catch{f=0}t.x+=f,c.x+=f,this.textWidth+=f;let p=i.Path.getPointOnLine(f+d/2,t.x,t.y,c.x,c.y),m=Math.atan2(c.y-t.y,c.x-t.x);this.glyphInfo.push({transposeX:p.x,transposeY:p.y,text:l[e],rotation:m,p0:t,p1:c}),u+=a}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};let e=[];this.glyphInfo.forEach(function(t){e.push(t.p0.x),e.push(t.p0.y),e.push(t.p1.x),e.push(t.p1.y)});let t=e[0]||0,n=e[0]||0,r=e[1]||0,i=e[1]||0,a,o;for(let s=0;s<e.length/2;s++)a=e[s*2],o=e[s*2+1],t=Math.min(t,a),n=Math.max(n,a),r=Math.min(r,o),i=Math.max(i,o);let s=this.fontSize();return{x:t-s/2,y:r-s/2,width:n-t+s,height:i-r+s}}destroy(){return t.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};exports.TextPath=f,f.prototype._fillFunc=u,f.prototype._strokeFunc=d,f.prototype._fillFuncHit=u,f.prototype._strokeFuncHit=d,f.prototype.className=`TextPath`,f.prototype._attrsAffectingSize=[`text`,`fontSize`,`data`],(0,s._registerNode)(f),n.Factory.addGetterSetter(f,`data`),n.Factory.addGetterSetter(f,`fontFamily`,`Arial`),n.Factory.addGetterSetter(f,`fontSize`,12,(0,o.getNumberValidator)()),n.Factory.addGetterSetter(f,`fontStyle`,l),n.Factory.addGetterSetter(f,`align`,`left`),n.Factory.addGetterSetter(f,`letterSpacing`,0,(0,o.getNumberValidator)()),n.Factory.addGetterSetter(f,`textBaseline`,`middle`),n.Factory.addGetterSetter(f,`fontVariant`,l),n.Factory.addGetterSetter(f,`text`,c),n.Factory.addGetterSetter(f,`textDecoration`,``),n.Factory.addGetterSetter(f,`kerningFunc`,void 0)}),ce=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Transformer=void 0;let t=O(),n=N(),r=P(),i=R(),a=Q(),o=V(),s=D(),c=M(),l=D(),u=`tr-konva`,d=[`resizeEnabledChange`,`rotateAnchorOffsetChange`,`rotateEnabledChange`,`enabledAnchorsChange`,`anchorSizeChange`,`borderEnabledChange`,`borderStrokeChange`,`borderStrokeWidthChange`,`borderDashChange`,`anchorStrokeChange`,`anchorStrokeWidthChange`,`anchorFillChange`,`anchorCornerRadiusChange`,`ignoreStrokeChange`,`anchorStyleFuncChange`].map(e=>e+`.${u}`).join(` `),f=`nodesRect`,p=[`widthChange`,`heightChange`,`scaleXChange`,`scaleYChange`,`skewXChange`,`skewYChange`,`rotationChange`,`offsetXChange`,`offsetYChange`,`transformsEnabledChange`,`strokeWidthChange`],m={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},h=`ontouchstart`in s.Konva._global;function g(e,n,r){if(e===`rotater`)return r;n+=t.Util.degToRad(m[e]||0);let i=(t.Util.radToDeg(n)%360+360)%360;return t.Util._inRange(i,337.5,360)||t.Util._inRange(i,0,22.5)?`ns-resize`:t.Util._inRange(i,22.5,67.5)?`nesw-resize`:t.Util._inRange(i,67.5,112.5)?`ew-resize`:t.Util._inRange(i,112.5,157.5)?`nwse-resize`:t.Util._inRange(i,157.5,202.5)?`ns-resize`:t.Util._inRange(i,202.5,247.5)?`nesw-resize`:t.Util._inRange(i,247.5,292.5)?`ew-resize`:t.Util._inRange(i,292.5,337.5)?`nwse-resize`:(t.Util.error(`Transformer has unknown angle for cursor detection: `+i),`pointer`)}let _=[`top-left`,`top-center`,`top-right`,`middle-right`,`middle-left`,`bottom-left`,`bottom-center`,`bottom-right`],v=1e8;function y(e){return{x:e.x+e.width/2*Math.cos(e.rotation)+e.height/2*Math.sin(-e.rotation),y:e.y+e.height/2*Math.cos(e.rotation)+e.width/2*Math.sin(e.rotation)}}function b(e,t,n){let r=n.x+(e.x-n.x)*Math.cos(t)-(e.y-n.y)*Math.sin(t),i=n.y+(e.x-n.x)*Math.sin(t)+(e.y-n.y)*Math.cos(t);return{...e,rotation:e.rotation+t,x:r,y:i}}function x(e,t){let n=y(e);return b(e,t,n)}function S(e,t,n){let r=t;for(let i=0;i<e.length;i++){let a=s.Konva.getAngle(e[i]),o=Math.abs(a-t)%(Math.PI*2),c=Math.min(o,Math.PI*2-o);c<n&&(r=a)}return r}let C=0;var w=class extends o.Group{constructor(e){super(e),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(d,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return t.Util.warn(`tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead.`),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return u+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();let n=e.filter(e=>e.isAncestorOf(this)?(t.Util.error(`Konva.Transformer cannot be an a child of the node you are trying to attach`),!1):!0);this._nodes=e=n,e.length===1&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(e=>{let t=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(e._attrsAffectingSize.length){let n=e._attrsAffectingSize.map(e=>e+`Change.`+this._getEventNamespace()).join(` `);e.on(n,t)}e.on(p.map(e=>e+`.${this._getEventNamespace()}`).join(` `),t),e.on(`absoluteTransformChange.${this._getEventNamespace()}`,t),this._proxyDrag(e)}),this._resetTransformCache();let r=!!this.findOne(`.top-left`);return r&&this.update(),this}_proxyDrag(e){let t;e.on(`dragstart.${this._getEventNamespace()}`,n=>{t=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(`.back`)&&this.startDrag(n,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,n=>{if(!t)return;let r=e.getAbsolutePosition(),i=r.x-t.x,a=r.y-t.y;this.nodes().forEach(t=>{if(t===e||t.isDragging())return;let r=t.getAbsolutePosition();t.setAbsolutePosition({x:r.x+i,y:r.y+a}),t.startDrag(n)}),t=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off(`.`+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(f),this._clearCache(`transform`),this._clearSelfAndDescendantCache(`absoluteTransform`)}_getNodeRect(){return this._getCache(f,this.__getNodeRect)}__getNodeShape(e,t=this.rotation(),n){let r=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),i=e.getAbsoluteScale(n),a=e.getAbsolutePosition(n),o=r.x*i.x-e.offsetX()*i.x,c=r.y*i.y-e.offsetY()*i.y,l=(s.Konva.getAngle(e.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),u={x:a.x+o*Math.cos(l)+c*Math.sin(-l),y:a.y+c*Math.cos(l)+o*Math.sin(l),width:r.width*i.x,height:r.height*i.y,rotation:l};return b(u,-s.Konva.getAngle(t),{x:0,y:0})}__getNodeRect(){let e=this.getNode();if(!e)return{x:-v,y:-v,width:0,height:0,rotation:0};let n=[];this.nodes().map(e=>{let t=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),r=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}],i=e.getAbsoluteTransform();r.forEach(function(e){let t=i.point(e);n.push(t)})});let r=new t.Transform;r.rotate(-s.Konva.getAngle(this.rotation()));let i=1/0,a=1/0,o=-1/0,c=-1/0;n.forEach(function(e){let t=r.point(e);i===void 0&&(i=o=t.x,a=c=t.y),i=Math.min(i,t.x),a=Math.min(a,t.y),o=Math.max(o,t.x),c=Math.max(c,t.y)}),r.invert();let l=r.point({x:i,y:a});return{x:l.x,y:l.y,width:o-i,height:c-a,rotation:s.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),_.forEach(e=>{this._createAnchor(e)}),this._createAnchor(`rotater`)}_createAnchor(e){let t=new a.Rect({stroke:`rgb(0, 161, 255)`,fill:`white`,strokeWidth:1,name:e+` _anchor`,dragDistance:0,draggable:!0,hitStrokeWidth:h?10:`auto`}),n=this;t.on(`mousedown touchstart`,function(e){n._handleMouseDown(e)}),t.on(`dragstart`,e=>{t.stopDrag(),e.cancelBubble=!0}),t.on(`dragend`,e=>{e.cancelBubble=!0}),t.on(`mouseenter`,()=>{let n=s.Konva.getAngle(this.rotation()),r=this.rotateAnchorCursor(),i=g(e,n,r);t.getStage().content&&(t.getStage().content.style.cursor=i),this._cursorChange=!0}),t.on(`mouseout`,()=>{t.getStage().content&&(t.getStage().content.style.cursor=``),this._cursorChange=!1}),this.add(t)}_createBack(){let e=new i.Shape({name:`back`,width:0,height:0,draggable:!0,sceneFunc(e,n){let r=n.getParent(),i=r.padding();e.beginPath(),e.rect(-i,-i,n.width()+i*2,n.height()+i*2),e.moveTo(n.width()/2,-i),r.rotateEnabled()&&r.rotateLineVisible()&&e.lineTo(n.width()/2,-r.rotateAnchorOffset()*t.Util._sign(n.height())-i),e.fillStrokeShape(n)},hitFunc:(e,t)=>{if(!this.shouldOverdrawWholeArea())return;let n=this.padding();e.beginPath(),e.rect(-n,-n,t.width()+n*2,t.height()+n*2),e.fillStrokeShape(t)}});this.add(e),this._proxyDrag(e),e.on(`dragstart`,e=>{e.cancelBubble=!0}),e.on(`dragmove`,e=>{e.cancelBubble=!0}),e.on(`dragend`,e=>{e.cancelBubble=!0}),this.on(`dragmove`,e=>{this.update()})}_handleMouseDown(e){if(this._transforming)return;this._movingAnchorName=e.target.name().split(` `)[0];let t=this._getNodeRect(),n=t.width,r=t.height,i=Math.sqrt(n**2+r**2);this.sin=Math.abs(r/i),this.cos=Math.abs(n/i),typeof window<`u`&&(window.addEventListener(`mousemove`,this._handleMouseMove),window.addEventListener(`touchmove`,this._handleMouseMove),window.addEventListener(`mouseup`,this._handleMouseUp,!0),window.addEventListener(`touchend`,this._handleMouseUp,!0)),this._transforming=!0;let a=e.target.getAbsolutePosition(),o=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:o.x-a.x,y:o.y-a.y},C++,this._fire(`transformstart`,{evt:e.evt,target:this.getNode()}),this._nodes.forEach(t=>{t._fire(`transformstart`,{evt:e.evt,target:t})})}_handleMouseMove(e){let t,n,r,i=this.findOne(`.`+this._movingAnchorName),a=i.getStage();a.setPointersPositions(e);let o=a.getPointerPosition(),c={x:o.x-this._anchorDragOffset.x,y:o.y-this._anchorDragOffset.y},l=i.getAbsolutePosition();this.anchorDragBoundFunc()&&(c=this.anchorDragBoundFunc()(l,c,e)),i.setAbsolutePosition(c);let u=i.getAbsolutePosition();if(l.x===u.x&&l.y===u.y)return;if(this._movingAnchorName===`rotater`){let r=this._getNodeRect();t=i.x()-r.width/2,n=-i.y()+r.height/2;let a=Math.atan2(-n,t)+Math.PI/2;r.height<0&&(a-=Math.PI);let o=s.Konva.getAngle(this.rotation()),c=o+a,l=s.Konva.getAngle(this.rotationSnapTolerance()),u=S(this.rotationSnaps(),c,l),d=u-r.rotation,f=x(r,d);this._fitNodesInto(f,e);return}let d=this.shiftBehavior(),f;f=d===`inverted`?this.keepRatio()&&!e.shiftKey:d===`none`?this.keepRatio():this.keepRatio()||e.shiftKey;let p=this.centeredScaling()||e.altKey;if(this._movingAnchorName===`top-left`){if(f){let e=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(`.bottom-right`).x(),y:this.findOne(`.bottom-right`).y()};r=Math.sqrt((e.x-i.x())**2+(e.y-i.y())**2);let a=this.findOne(`.top-left`).x()>e.x?-1:1,o=this.findOne(`.top-left`).y()>e.y?-1:1;t=r*this.cos*a,n=r*this.sin*o,this.findOne(`.top-left`).x(e.x-t),this.findOne(`.top-left`).y(e.y-n)}}else if(this._movingAnchorName===`top-center`)this.findOne(`.top-left`).y(i.y());else if(this._movingAnchorName===`top-right`){if(f){let e=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(`.bottom-left`).x(),y:this.findOne(`.bottom-left`).y()};r=Math.sqrt((i.x()-e.x)**2+(e.y-i.y())**2);let a=this.findOne(`.top-right`).x()<e.x?-1:1,o=this.findOne(`.top-right`).y()>e.y?-1:1;t=r*this.cos*a,n=r*this.sin*o,this.findOne(`.top-right`).x(e.x+t),this.findOne(`.top-right`).y(e.y-n)}var m=i.position();this.findOne(`.top-left`).y(m.y),this.findOne(`.bottom-right`).x(m.x)}else if(this._movingAnchorName===`middle-left`)this.findOne(`.top-left`).x(i.x());else if(this._movingAnchorName===`middle-right`)this.findOne(`.bottom-right`).x(i.x());else if(this._movingAnchorName===`bottom-left`){if(f){let e=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(`.top-right`).x(),y:this.findOne(`.top-right`).y()};r=Math.sqrt((e.x-i.x())**2+(i.y()-e.y)**2);let a=e.x<i.x()?-1:1,o=i.y()<e.y?-1:1;t=r*this.cos*a,n=r*this.sin*o,i.x(e.x-t),i.y(e.y+n)}m=i.position(),this.findOne(`.top-left`).x(m.x),this.findOne(`.bottom-right`).y(m.y)}else if(this._movingAnchorName===`bottom-center`)this.findOne(`.bottom-right`).y(i.y());else if(this._movingAnchorName===`bottom-right`){if(f){let e=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(`.top-left`).x(),y:this.findOne(`.top-left`).y()};r=Math.sqrt((i.x()-e.x)**2+(i.y()-e.y)**2);let a=this.findOne(`.bottom-right`).x()<e.x?-1:1,o=this.findOne(`.bottom-right`).y()<e.y?-1:1;t=r*this.cos*a,n=r*this.sin*o,this.findOne(`.bottom-right`).x(e.x+t),this.findOne(`.bottom-right`).y(e.y+n)}}else console.error(Error(`Wrong position argument of selection resizer: `+this._movingAnchorName));if(p=this.centeredScaling()||e.altKey,p){let e=this.findOne(`.top-left`),t=this.findOne(`.bottom-right`),n=e.x(),r=e.y(),i=this.getWidth()-t.x(),a=this.getHeight()-t.y();t.move({x:-n,y:-r}),e.move({x:i,y:a})}let h=this.findOne(`.top-left`).getAbsolutePosition();t=h.x,n=h.y;let g=this.findOne(`.bottom-right`).x()-this.findOne(`.top-left`).x(),_=this.findOne(`.bottom-right`).y()-this.findOne(`.top-left`).y();this._fitNodesInto({x:t,y:n,width:g,height:_,rotation:s.Konva.getAngle(this.rotation())},e)}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){var t;if(this._transforming){this._transforming=!1,typeof window<`u`&&(window.removeEventListener(`mousemove`,this._handleMouseMove),window.removeEventListener(`touchmove`,this._handleMouseMove),window.removeEventListener(`mouseup`,this._handleMouseUp,!0),window.removeEventListener(`touchend`,this._handleMouseUp,!0));let n=this.getNode();C--,this._fire(`transformend`,{evt:e,target:n}),(t=this.getLayer())==null||t.batchDraw(),n&&this._nodes.forEach(t=>{var n;t._fire(`transformend`,{evt:e,target:t}),(n=t.getLayer())==null||n.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(e,n){let r=this._getNodeRect(),i=1;if(t.Util._inRange(e.width,-this.padding()*2-i,i)){this.update();return}if(t.Util._inRange(e.height,-this.padding()*2-i,i)){this.update();return}let a=new t.Transform;if(a.rotate(s.Konva.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf(`left`)>=0){let t=a.point({x:-this.padding()*2,y:0});e.x+=t.x,e.y+=t.y,e.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace(`left`,`right`),this._anchorDragOffset.x-=t.x,this._anchorDragOffset.y-=t.y}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf(`right`)>=0){let t=a.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace(`right`,`left`),this._anchorDragOffset.x-=t.x,this._anchorDragOffset.y-=t.y,e.width+=this.padding()*2}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf(`top`)>=0){let t=a.point({x:0,y:-this.padding()*2});e.x+=t.x,e.y+=t.y,this._movingAnchorName=this._movingAnchorName.replace(`top`,`bottom`),this._anchorDragOffset.x-=t.x,this._anchorDragOffset.y-=t.y,e.height+=this.padding()*2}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf(`bottom`)>=0){let t=a.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace(`bottom`,`top`),this._anchorDragOffset.x-=t.x,this._anchorDragOffset.y-=t.y,e.height+=this.padding()*2}if(this.boundBoxFunc()){let n=this.boundBoxFunc()(r,e);n?e=n:t.Util.warn(`boundBoxFunc returned falsy. You should return new bound rect from it!`)}let o=1e7,c=new t.Transform;c.translate(r.x,r.y),c.rotate(r.rotation),c.scale(r.width/o,r.height/o);let l=new t.Transform,u=e.width/o,d=e.height/o;this.flipEnabled()===!1?(l.translate(e.x,e.y),l.rotate(e.rotation),l.translate(e.width<0?e.width:0,e.height<0?e.height:0),l.scale(Math.abs(u),Math.abs(d))):(l.translate(e.x,e.y),l.rotate(e.rotation),l.scale(u,d));let f=l.multiply(c.invert());this._nodes.forEach(e=>{var n;let r=e.getParent().getAbsoluteTransform(),i=e.getTransform().copy();i.translate(e.offsetX(),e.offsetY());let a=new t.Transform;a.multiply(r.copy().invert()).multiply(f).multiply(r).multiply(i);let o=a.decompose();e.setAttrs(o),(n=e.getLayer())==null||n.batchDraw()}),this.rotation(t.Util._getRotation(e.rotation)),this._nodes.forEach(e=>{this._fire(`transform`,{evt:n,target:e}),e._fire(`transform`,{evt:n,target:e})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,t){let n=this.findOne(e);n.setAttrs(t)}update(){var e;let n=this._getNodeRect();this.rotation(t.Util._getRotation(n.rotation));let r=n.width,i=n.height,a=this.enabledAnchors(),o=this.resizeEnabled(),s=this.padding(),c=this.anchorSize(),l=this.find(`._anchor`);l.forEach(e=>{e.setAttrs({width:c,height:c,offsetX:c/2,offsetY:c/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(`.top-left`,{x:0,y:0,offsetX:c/2+s,offsetY:c/2+s,visible:o&&a.indexOf(`top-left`)>=0}),this._batchChangeChild(`.top-center`,{x:r/2,y:0,offsetY:c/2+s,visible:o&&a.indexOf(`top-center`)>=0}),this._batchChangeChild(`.top-right`,{x:r,y:0,offsetX:c/2-s,offsetY:c/2+s,visible:o&&a.indexOf(`top-right`)>=0}),this._batchChangeChild(`.middle-left`,{x:0,y:i/2,offsetX:c/2+s,visible:o&&a.indexOf(`middle-left`)>=0}),this._batchChangeChild(`.middle-right`,{x:r,y:i/2,offsetX:c/2-s,visible:o&&a.indexOf(`middle-right`)>=0}),this._batchChangeChild(`.bottom-left`,{x:0,y:i,offsetX:c/2+s,offsetY:c/2-s,visible:o&&a.indexOf(`bottom-left`)>=0}),this._batchChangeChild(`.bottom-center`,{x:r/2,y:i,offsetY:c/2-s,visible:o&&a.indexOf(`bottom-center`)>=0}),this._batchChangeChild(`.bottom-right`,{x:r,y:i,offsetX:c/2-s,offsetY:c/2-s,visible:o&&a.indexOf(`bottom-right`)>=0}),this._batchChangeChild(`.rotater`,{x:r/2,y:-this.rotateAnchorOffset()*t.Util._sign(i)-s,visible:this.rotateEnabled()}),this._batchChangeChild(`.back`,{width:r,height:i,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});let u=this.anchorStyleFunc();u&&l.forEach(e=>{u(e)}),(e=this.getLayer())==null||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();let e=this.findOne(`.`+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=``),o.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return r.Node.prototype.toObject.call(this)}clone(e){let t=r.Node.prototype.clone.call(this,e);return t}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};exports.Transformer=w,w.isTransforming=()=>C>0;function T(e){return e instanceof Array||t.Util.warn(`enabledAnchors value should be an array`),e instanceof Array&&e.forEach(function(e){_.indexOf(e)===-1&&t.Util.warn(`Unknown anchor name: `+e+`. Available names are: `+_.join(`, `))}),e||[]}w.prototype.className=`Transformer`,(0,l._registerNode)(w),n.Factory.addGetterSetter(w,`enabledAnchors`,_,T),n.Factory.addGetterSetter(w,`flipEnabled`,!0,(0,c.getBooleanValidator)()),n.Factory.addGetterSetter(w,`resizeEnabled`,!0),n.Factory.addGetterSetter(w,`anchorSize`,10,(0,c.getNumberValidator)()),n.Factory.addGetterSetter(w,`rotateEnabled`,!0),n.Factory.addGetterSetter(w,`rotateLineVisible`,!0),n.Factory.addGetterSetter(w,`rotationSnaps`,[]),n.Factory.addGetterSetter(w,`rotateAnchorOffset`,50,(0,c.getNumberValidator)()),n.Factory.addGetterSetter(w,`rotateAnchorCursor`,`crosshair`),n.Factory.addGetterSetter(w,`rotationSnapTolerance`,5,(0,c.getNumberValidator)()),n.Factory.addGetterSetter(w,`borderEnabled`,!0),n.Factory.addGetterSetter(w,`anchorStroke`,`rgb(0, 161, 255)`),n.Factory.addGetterSetter(w,`anchorStrokeWidth`,1,(0,c.getNumberValidator)()),n.Factory.addGetterSetter(w,`anchorFill`,`white`),n.Factory.addGetterSetter(w,`anchorCornerRadius`,0,(0,c.getNumberValidator)()),n.Factory.addGetterSetter(w,`borderStroke`,`rgb(0, 161, 255)`),n.Factory.addGetterSetter(w,`borderStrokeWidth`,1,(0,c.getNumberValidator)()),n.Factory.addGetterSetter(w,`borderDash`),n.Factory.addGetterSetter(w,`keepRatio`,!0),n.Factory.addGetterSetter(w,`shiftBehavior`,`default`),n.Factory.addGetterSetter(w,`centeredScaling`,!1),n.Factory.addGetterSetter(w,`ignoreStroke`,!1),n.Factory.addGetterSetter(w,`padding`,0,(0,c.getNumberValidator)()),n.Factory.addGetterSetter(w,`nodes`),n.Factory.addGetterSetter(w,`node`),n.Factory.addGetterSetter(w,`boundBoxFunc`),n.Factory.addGetterSetter(w,`anchorDragBoundFunc`),n.Factory.addGetterSetter(w,`anchorStyleFunc`),n.Factory.addGetterSetter(w,`shouldOverdrawWholeArea`,!1),n.Factory.addGetterSetter(w,`useSingleNodeRotation`,!0),n.Factory.backCompat(w,{lineEnabled:`borderEnabled`,rotateHandlerOffset:`rotateAnchorOffset`,enabledHandlers:`enabledAnchors`})}),le=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Wedge=void 0;let t=N(),n=R(),r=D(),i=M(),a=D();var o=class extends n.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,r.Konva.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}};exports.Wedge=o,o.prototype.className=`Wedge`,o.prototype._centroid=!0,o.prototype._attrsAffectingSize=[`radius`],(0,a._registerNode)(o),t.Factory.addGetterSetter(o,`radius`,0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(o,`angle`,0,(0,i.getNumberValidator)()),t.Factory.addGetterSetter(o,`clockwise`,!1),t.Factory.backCompat(o,{angleDeg:`angle`,getAngleDeg:`getAngle`,setAngleDeg:`setAngle`})}),ue=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Blur=void 0;let t=N(),n=P(),r=M();function i(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}let a=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],o=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function s(e,t){let n=e.data,r=e.width,s=e.height,c,l,u,d,f,p,m,h,g,_,v,y,b,x,S,C,w,T,E,D,O=t+t+1,k=r-1,A=s-1,j=t+1,M=j*(j+1)/2,N=new i,P=a[t],F=o[t],I=null,L=N,R=null,z=null;for(let e=1;e<O;e++)L=L.next=new i,e===j&&(I=L);L.next=N,u=l=0;for(let e=0;e<s;e++){y=b=x=S=d=f=p=m=0,h=j*(C=n[l]),g=j*(w=n[l+1]),_=j*(T=n[l+2]),v=j*(E=n[l+3]),d+=M*C,f+=M*w,p+=M*T,m+=M*E,L=N;for(let e=0;e<j;e++)L.r=C,L.g=w,L.b=T,L.a=E,L=L.next;for(let e=1;e<j;e++)c=l+((k<e?k:e)<<2),d+=(L.r=C=n[c])*(D=j-e),f+=(L.g=w=n[c+1])*D,p+=(L.b=T=n[c+2])*D,m+=(L.a=E=n[c+3])*D,y+=C,b+=w,x+=T,S+=E,L=L.next;R=N,z=I;for(let e=0;e<r;e++)n[l+3]=E=m*P>>F,E===0?n[l]=n[l+1]=n[l+2]=0:(E=255/E,n[l]=(d*P>>F)*E,n[l+1]=(f*P>>F)*E,n[l+2]=(p*P>>F)*E),d-=h,f-=g,p-=_,m-=v,h-=R.r,g-=R.g,_-=R.b,v-=R.a,c=u+((c=e+t+1)<k?c:k)<<2,y+=R.r=n[c],b+=R.g=n[c+1],x+=R.b=n[c+2],S+=R.a=n[c+3],d+=y,f+=b,p+=x,m+=S,R=R.next,h+=C=z.r,g+=w=z.g,_+=T=z.b,v+=E=z.a,y-=C,b-=w,x-=T,S-=E,z=z.next,l+=4;u+=r}for(let e=0;e<r;e++){b=x=S=y=f=p=m=d=0,l=e<<2,h=j*(C=n[l]),g=j*(w=n[l+1]),_=j*(T=n[l+2]),v=j*(E=n[l+3]),d+=M*C,f+=M*w,p+=M*T,m+=M*E,L=N;for(let e=0;e<j;e++)L.r=C,L.g=w,L.b=T,L.a=E,L=L.next;let i=r;for(let a=1;a<=t;a++)l=i+e<<2,d+=(L.r=C=n[l])*(D=j-a),f+=(L.g=w=n[l+1])*D,p+=(L.b=T=n[l+2])*D,m+=(L.a=E=n[l+3])*D,y+=C,b+=w,x+=T,S+=E,L=L.next,a<A&&(i+=r);l=e,R=N,z=I;for(let t=0;t<s;t++)c=l<<2,n[c+3]=E=m*P>>F,E>0?(E=255/E,n[c]=(d*P>>F)*E,n[c+1]=(f*P>>F)*E,n[c+2]=(p*P>>F)*E):n[c]=n[c+1]=n[c+2]=0,d-=h,f-=g,p-=_,m-=v,h-=R.r,g-=R.g,_-=R.b,v-=R.a,c=e+((c=t+j)<A?c:A)*r<<2,d+=y+=R.r=n[c],f+=b+=R.g=n[c+1],p+=x+=R.b=n[c+2],m+=S+=R.a=n[c+3],R=R.next,h+=C=z.r,g+=w=z.g,_+=T=z.b,v+=E=z.a,y-=C,b-=w,x-=T,S-=E,z=z.next,l+=r}}let c=function(e){let t=Math.round(this.blurRadius());t>0&&s(e,t)};exports.Blur=c,t.Factory.addGetterSetter(n.Node,`blurRadius`,0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter)}),de=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Brighten=void 0;let t=N(),n=P(),r=M(),i=function(e){let t=this.brightness()*255,n=e.data,r=n.length;for(let e=0;e<r;e+=4)n[e]+=t,n[e+1]+=t,n[e+2]+=t};exports.Brighten=i,t.Factory.addGetterSetter(n.Node,`brightness`,0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter)}),fe=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Contrast=void 0;let t=N(),n=P(),r=M(),i=function(e){let t=((this.contrast()+100)/100)**2,n=e.data,r=n.length,i=150,a=150,o=150;for(let e=0;e<r;e+=4)i=n[e],a=n[e+1],o=n[e+2],i/=255,i-=.5,i*=t,i+=.5,i*=255,a/=255,a-=.5,a*=t,a+=.5,a*=255,o/=255,o-=.5,o*=t,o+=.5,o*=255,i=i<0?0:i>255?255:i,a=a<0?0:a>255?255:a,o=o<0?0:o>255?255:o,n[e]=i,n[e+1]=a,n[e+2]=o};exports.Contrast=i,t.Factory.addGetterSetter(n.Node,`contrast`,0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter)}),pe=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Emboss=void 0;let t=N(),n=P(),r=O(),i=M(),a=function(e){let t=this.embossStrength()*10,n=this.embossWhiteLevel()*255,i=this.embossDirection(),a=this.embossBlend(),o=e.data,s=e.width,c=e.height,l=s*4,u=0,d=0,f=c;switch(i){case`top-left`:u=-1,d=-1;break;case`top`:u=-1,d=0;break;case`top-right`:u=-1,d=1;break;case`right`:u=0,d=1;break;case`bottom-right`:u=1,d=1;break;case`bottom`:u=1,d=0;break;case`bottom-left`:u=1,d=-1;break;case`left`:u=0,d=-1;break;default:r.Util.error(`Unknown emboss direction: `+i)}do{let e=(f-1)*l,r=u;f+r<1&&(r=0),f+r>c&&(r=0);let i=(f-1+r)*s*4,p=s;do{let r=e+(p-1)*4,c=d;p+c<1&&(c=0),p+c>s&&(c=0);let l=i+(p-1+c)*4,u=o[r]-o[l],f=o[r+1]-o[l+1],m=o[r+2]-o[l+2],h=u,g=h>0?h:-h,_=f>0?f:-f,v=m>0?m:-m;if(_>g&&(h=f),v>g&&(h=m),h*=t,a){let e=o[r]+h,t=o[r+1]+h,n=o[r+2]+h;o[r]=e>255?255:e<0?0:e,o[r+1]=t>255?255:t<0?0:t,o[r+2]=n>255?255:n<0?0:n}else{let e=n-h;e<0?e=0:e>255&&(e=255),o[r]=o[r+1]=o[r+2]=e}}while(--p)}while(--f)};exports.Emboss=a,t.Factory.addGetterSetter(n.Node,`embossStrength`,.5,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(n.Node,`embossWhiteLevel`,.5,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(n.Node,`embossDirection`,`top-left`,void 0,t.Factory.afterSetFilter),t.Factory.addGetterSetter(n.Node,`embossBlend`,!1,void 0,t.Factory.afterSetFilter)}),me=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Enhance=void 0;let t=N(),n=P(),r=M();function i(e,t,n,r,i){let a=n-t,o=i-r;if(a===0)return r+o/2;if(o===0)return r;let s=(e-t)/a;return s=o*s+r,s}let a=function(e){let t=e.data,n=t.length,r=t[0],a=r,o,s=t[1],c=s,l,u=t[2],d=u,f,p=this.enhance();if(p===0)return;for(let e=0;e<n;e+=4)o=t[e+0],o<r?r=o:o>a&&(a=o),l=t[e+1],l<s?s=l:l>c&&(c=l),f=t[e+2],f<u?u=f:f>d&&(d=f);a===r&&(a=255,r=0),c===s&&(c=255,s=0),d===u&&(d=255,u=0);let m,h,g,_,v,y;if(p>0)m=a+p*(255-a),h=r-p*(r-0),g=c+p*(255-c),_=s-p*(s-0),v=d+p*(255-d),y=u-p*(u-0);else{let e=(a+r)*.5;m=a+p*(a-e),h=r+p*(r-e);let t=(c+s)*.5;g=c+p*(c-t),_=s+p*(s-t);let n=(d+u)*.5;v=d+p*(d-n),y=u+p*(u-n)}for(let e=0;e<n;e+=4)t[e+0]=i(t[e+0],r,a,h,m),t[e+1]=i(t[e+1],s,c,_,g),t[e+2]=i(t[e+2],u,d,y,v)};exports.Enhance=a,t.Factory.addGetterSetter(n.Node,`enhance`,0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter)}),he=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Grayscale=void 0;let t=function(e){let t=e.data,n=t.length;for(let e=0;e<n;e+=4){let n=.34*t[e]+.5*t[e+1]+.16*t[e+2];t[e]=n,t[e+1]=n,t[e+2]=n}};exports.Grayscale=t}),ge=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.HSL=void 0;let t=N(),n=P(),r=M();t.Factory.addGetterSetter(n.Node,`hue`,0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(n.Node,`saturation`,0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(n.Node,`luminance`,0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter);let i=function(e){let t=e.data,n=t.length,r=1,i=2**this.saturation(),a=Math.abs(this.hue()+360)%360,o=this.luminance()*127,s=r*i*Math.cos(a*Math.PI/180),c=r*i*Math.sin(a*Math.PI/180),l=.299*r+.701*s+.167*c,u=.587*r-.587*s+.33*c,d=.114*r-.114*s-.497*c,f=.299*r-.299*s-.328*c,p=.587*r+.413*s+.035*c,m=.114*r-.114*s+.293*c,h=.299*r-.3*s+1.25*c,g=.587*r-.586*s-1.05*c,_=.114*r+.886*s-.2*c,v,y,b,x;for(let e=0;e<n;e+=4)v=t[e+0],y=t[e+1],b=t[e+2],x=t[e+3],t[e+0]=l*v+u*y+d*b+o,t[e+1]=f*v+p*y+m*b+o,t[e+2]=h*v+g*y+_*b+o,t[e+3]=x};exports.HSL=i}),_e=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.HSV=void 0;let t=N(),n=P(),r=M(),i=function(e){let t=e.data,n=t.length,r=2**this.value(),i=2**this.saturation(),a=Math.abs(this.hue()+360)%360,o=r*i*Math.cos(a*Math.PI/180),s=r*i*Math.sin(a*Math.PI/180),c=.299*r+.701*o+.167*s,l=.587*r-.587*o+.33*s,u=.114*r-.114*o-.497*s,d=.299*r-.299*o-.328*s,f=.587*r+.413*o+.035*s,p=.114*r-.114*o+.293*s,m=.299*r-.3*o+1.25*s,h=.587*r-.586*o-1.05*s,g=.114*r+.886*o-.2*s;for(let e=0;e<n;e+=4){let n=t[e+0],r=t[e+1],i=t[e+2],a=t[e+3];t[e+0]=c*n+l*r+u*i,t[e+1]=d*n+f*r+p*i,t[e+2]=m*n+h*r+g*i,t[e+3]=a}};exports.HSV=i,t.Factory.addGetterSetter(n.Node,`hue`,0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(n.Node,`saturation`,0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(n.Node,`value`,0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter)}),ve=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Invert=void 0;let t=function(e){let t=e.data,n=t.length;for(let e=0;e<n;e+=4)t[e]=255-t[e],t[e+1]=255-t[e+1],t[e+2]=255-t[e+2]};exports.Invert=t}),ye=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Kaleidoscope=void 0;let t=N(),n=P(),r=O(),i=M(),a=function(e,t,n){let r=e.data,i=t.data,a=e.width,o=e.height,s=n.polarCenterX||a/2,c=n.polarCenterY||o/2,l=Math.sqrt(s*s+c*c),u=a-s,d=o-c,f=Math.sqrt(u*u+d*d);l=f>l?f:l;let p=o,m=a,h=360/m*Math.PI/180;for(let e=0;e<m;e+=1){let t=Math.sin(e*h),n=Math.cos(e*h);for(let o=0;o<p;o+=1){u=Math.floor(s+l*o/p*n),d=Math.floor(c+l*o/p*t);let f=(d*a+u)*4,m=r[f+0],h=r[f+1],g=r[f+2],_=r[f+3];f=(e+o*a)*4,i[f+0]=m,i[f+1]=h,i[f+2]=g,i[f+3]=_}}},o=function(e,t,n){let r=e.data,i=t.data,a=e.width,o=e.height,s=n.polarCenterX||a/2,c=n.polarCenterY||o/2,l=Math.sqrt(s*s+c*c),u=a-s,d=o-c,f=Math.sqrt(u*u+d*d);l=f>l?f:l;let p=o,m=a,h=n.polarRotation||0,g,_;for(u=0;u<a;u+=1)for(d=0;d<o;d+=1){let e=u-s,t=d-c,n=Math.sqrt(e*e+t*t)*p/l,o=(Math.atan2(t,e)*180/Math.PI+360+h)%360;o=o*m/360,g=Math.floor(o),_=Math.floor(n);let f=(_*a+g)*4,v=r[f+0],y=r[f+1],b=r[f+2],x=r[f+3];f=(d*a+u)*4,i[f+0]=v,i[f+1]=y,i[f+2]=b,i[f+3]=x}},s=function(e){let t=e.width,n=e.height,i,s,c,l,u,d,f,p,m,h,g=Math.round(this.kaleidoscopePower()),_=Math.round(this.kaleidoscopeAngle()),v=Math.floor(t*(_%360)/360);if(g<1)return;let y=r.Util.createCanvasElement();y.width=t,y.height=n;let b=y.getContext(`2d`).getImageData(0,0,t,n);r.Util.releaseCanvas(y),a(e,b,{polarCenterX:t/2,polarCenterY:n/2});let x=t/2**g;for(;x<=8;)x*=2,--g;x=Math.ceil(x);let S=x,C=0,w=S,T=1;for(v+x>t&&(C=S,w=0,T=-1),s=0;s<n;s+=1)for(i=C;i!==w;i+=T)c=Math.round(i+v)%t,m=(t*s+c)*4,u=b.data[m+0],d=b.data[m+1],f=b.data[m+2],p=b.data[m+3],h=(t*s+i)*4,b.data[h+0]=u,b.data[h+1]=d,b.data[h+2]=f,b.data[h+3]=p;for(s=0;s<n;s+=1)for(S=Math.floor(x),l=0;l<g;l+=1){for(i=0;i<S+1;i+=1)m=(t*s+i)*4,u=b.data[m+0],d=b.data[m+1],f=b.data[m+2],p=b.data[m+3],h=(t*s+S*2-i-1)*4,b.data[h+0]=u,b.data[h+1]=d,b.data[h+2]=f,b.data[h+3]=p;S*=2}o(b,e,{polarRotation:0})};exports.Kaleidoscope=s,t.Factory.addGetterSetter(n.Node,`kaleidoscopePower`,2,(0,i.getNumberValidator)(),t.Factory.afterSetFilter),t.Factory.addGetterSetter(n.Node,`kaleidoscopeAngle`,0,(0,i.getNumberValidator)(),t.Factory.afterSetFilter)}),be=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Mask=void 0;let t=N(),n=P(),r=M();function i(e,t,n){let r=(n*e.width+t)*4,i=[];return i.push(e.data[r++],e.data[r++],e.data[r++],e.data[r++]),i}function a(e,t){return Math.sqrt((e[0]-t[0])**2+(e[1]-t[1])**2+(e[2]-t[2])**2)}function o(e){let t=[0,0,0];for(let n=0;n<e.length;n++)t[0]+=e[n][0],t[1]+=e[n][1],t[2]+=e[n][2];return t[0]/=e.length,t[1]/=e.length,t[2]/=e.length,t}function s(e,t){let n=i(e,0,0),r=i(e,e.width-1,0),s=i(e,0,e.height-1),c=i(e,e.width-1,e.height-1),l=t||10;if(a(n,r)<l&&a(r,c)<l&&a(c,s)<l&&a(s,n)<l){let t=o([r,n,c,s]),i=[];for(let n=0;n<e.width*e.height;n++){let r=a(t,[e.data[n*4],e.data[n*4+1],e.data[n*4+2]]);i[n]=r<l?0:255}return i}}function c(e,t){for(let n=0;n<e.width*e.height;n++)e.data[4*n+3]=t[n]}function l(e,t,n){let r=[1,1,1,1,0,1,1,1,1],i=Math.round(Math.sqrt(r.length)),a=Math.floor(i/2),o=[];for(let s=0;s<n;s++)for(let c=0;c<t;c++){let l=s*t+c,u=0;for(let o=0;o<i;o++)for(let l=0;l<i;l++){let d=s+o-a,f=c+l-a;if(d>=0&&d<n&&f>=0&&f<t){let n=d*t+f,a=r[o*i+l];u+=e[n]*a}}o[l]=u===255*8?255:0}return o}function u(e,t,n){let r=[1,1,1,1,1,1,1,1,1],i=Math.round(Math.sqrt(r.length)),a=Math.floor(i/2),o=[];for(let s=0;s<n;s++)for(let c=0;c<t;c++){let l=s*t+c,u=0;for(let o=0;o<i;o++)for(let l=0;l<i;l++){let d=s+o-a,f=c+l-a;if(d>=0&&d<n&&f>=0&&f<t){let n=d*t+f,a=r[o*i+l];u+=e[n]*a}}o[l]=u>=255*4?255:0}return o}function d(e,t,n){let r=[1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9,1/9],i=Math.round(Math.sqrt(r.length)),a=Math.floor(i/2),o=[];for(let s=0;s<n;s++)for(let c=0;c<t;c++){let l=s*t+c,u=0;for(let o=0;o<i;o++)for(let l=0;l<i;l++){let d=s+o-a,f=c+l-a;if(d>=0&&d<n&&f>=0&&f<t){let n=d*t+f,a=r[o*i+l];u+=e[n]*a}}o[l]=u}return o}let f=function(e){let t=this.threshold(),n=s(e,t);return n&&(n=l(n,e.width,e.height),n=u(n,e.width,e.height),n=d(n,e.width,e.height),c(e,n)),e};exports.Mask=f,t.Factory.addGetterSetter(n.Node,`threshold`,0,(0,r.getNumberValidator)(),t.Factory.afterSetFilter)}),xe=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Noise=void 0;let t=N(),n=P(),r=M(),i=function(e){let t=this.noise()*255,n=e.data,r=n.length,i=t/2;for(let e=0;e<r;e+=4)n[e+0]+=i-2*i*Math.random(),n[e+1]+=i-2*i*Math.random(),n[e+2]+=i-2*i*Math.random()};exports.Noise=i,t.Factory.addGetterSetter(n.Node,`noise`,.2,(0,r.getNumberValidator)(),t.Factory.afterSetFilter)}),Se=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Pixelate=void 0;let t=N(),n=O(),r=P(),i=M(),a=function(e){let t=Math.ceil(this.pixelSize()),r=e.width,i=e.height,a=Math.ceil(r/t),o=Math.ceil(i/t),s=e.data;if(t<=0){n.Util.error(`pixelSize value can not be <= 0`);return}for(let e=0;e<a;e+=1)for(let n=0;n<o;n+=1){let a=0,o=0,c=0,l=0,u=e*t,d=u+t,f=n*t,p=f+t,m=0;for(let e=u;e<d;e+=1)if(!(e>=r))for(let t=f;t<p;t+=1){if(t>=i)continue;let n=(r*t+e)*4;a+=s[n+0],o+=s[n+1],c+=s[n+2],l+=s[n+3],m+=1}a/=m,o/=m,c/=m,l/=m;for(let e=u;e<d;e+=1)if(!(e>=r))for(let t=f;t<p;t+=1){if(t>=i)continue;let n=(r*t+e)*4;s[n+0]=a,s[n+1]=o,s[n+2]=c,s[n+3]=l}}};exports.Pixelate=a,t.Factory.addGetterSetter(r.Node,`pixelSize`,8,(0,i.getNumberValidator)(),t.Factory.afterSetFilter)}),Ce=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Posterize=void 0;let t=N(),n=P(),r=M(),i=function(e){let t=Math.round(this.levels()*254)+1,n=e.data,r=n.length,i=255/t;for(let e=0;e<r;e+=1)n[e]=Math.floor(n[e]/i)*i};exports.Posterize=i,t.Factory.addGetterSetter(n.Node,`levels`,.5,(0,r.getNumberValidator)(),t.Factory.afterSetFilter)}),we=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.RGB=void 0;let t=N(),n=P(),r=M(),i=function(e){let t=e.data,n=t.length,r=this.red(),i=this.green(),a=this.blue();for(let e=0;e<n;e+=4){let n=(.34*t[e]+.5*t[e+1]+.16*t[e+2])/255;t[e]=n*r,t[e+1]=n*i,t[e+2]=n*a,t[e+3]=t[e+3]}};exports.RGB=i,t.Factory.addGetterSetter(n.Node,`red`,0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)}),t.Factory.addGetterSetter(n.Node,`green`,0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)}),t.Factory.addGetterSetter(n.Node,`blue`,0,r.RGBComponent,t.Factory.afterSetFilter)}),Te=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.RGBA=void 0;let t=N(),n=P(),r=M(),i=function(e){let t=e.data,n=t.length,r=this.red(),i=this.green(),a=this.blue(),o=this.alpha();for(let e=0;e<n;e+=4){let n=1-o;t[e]=r*o+t[e]*n,t[e+1]=i*o+t[e+1]*n,t[e+2]=a*o+t[e+2]*n}};exports.RGBA=i,t.Factory.addGetterSetter(n.Node,`red`,0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)}),t.Factory.addGetterSetter(n.Node,`green`,0,function(e){return this._filterUpToDate=!1,e>255?255:e<0?0:Math.round(e)}),t.Factory.addGetterSetter(n.Node,`blue`,0,r.RGBComponent,t.Factory.afterSetFilter),t.Factory.addGetterSetter(n.Node,`alpha`,1,function(e){return this._filterUpToDate=!1,e>1?1:e<0?0:e})}),Ee=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Sepia=void 0;let t=function(e){let t=e.data,n=t.length;for(let e=0;e<n;e+=4){let n=t[e+0],r=t[e+1],i=t[e+2];t[e+0]=Math.min(255,n*.393+r*.769+i*.189),t[e+1]=Math.min(255,n*.349+r*.686+i*.168),t[e+2]=Math.min(255,n*.272+r*.534+i*.131)}};exports.Sepia=t}),De=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Solarize=void 0;let t=function(e){let t=e.data,n=e.width,r=e.height,i=n*4,a=r;do{let e=(a-1)*i,r=n;do{let n=e+(r-1)*4,i=t[n],a=t[n+1],o=t[n+2];i>127&&(i=255-i),a>127&&(a=255-a),o>127&&(o=255-o),t[n]=i,t[n+1]=a,t[n+2]=o}while(--r)}while(--a)};exports.Solarize=t}),Oe=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Threshold=void 0;let t=N(),n=P(),r=M(),i=function(e){let t=this.threshold()*255,n=e.data,r=n.length;for(let e=0;e<r;e+=1)n[e]=n[e]<t?0:255};exports.Threshold=i,t.Factory.addGetterSetter(n.Node,`threshold`,.5,(0,r.getNumberValidator)(),t.Factory.afterSetFilter)}),ke=w(exports=>{Object.defineProperty(exports,`__esModule`,{value:!0}),exports.Konva=void 0;let t=W(),n=G(),r=Y(),i=X(),a=Z(),o=ee(),s=te(),c=K(),l=J(),u=Q(),d=ne(),f=re(),p=ie(),m=ae(),h=oe(),g=se(),_=ce(),v=le(),y=ue(),b=de(),x=fe(),S=pe(),C=me(),w=he(),T=ge(),E=_e(),D=ve(),O=ye(),k=be(),A=xe(),j=Se(),M=Ce(),N=we(),P=Te(),F=Ee(),I=De(),L=Oe();exports.Konva=t.Konva.Util._assign(t.Konva,{Arc:n.Arc,Arrow:r.Arrow,Circle:i.Circle,Ellipse:a.Ellipse,Image:o.Image,Label:s.Label,Tag:s.Tag,Line:c.Line,Path:l.Path,Rect:u.Rect,RegularPolygon:d.RegularPolygon,Ring:f.Ring,Sprite:p.Sprite,Star:m.Star,Text:h.Text,TextPath:g.TextPath,Transformer:_.Transformer,Wedge:v.Wedge,Filters:{Blur:y.Blur,Brighten:b.Brighten,Contrast:x.Contrast,Emboss:S.Emboss,Enhance:C.Enhance,Grayscale:w.Grayscale,HSL:T.HSL,HSV:E.HSV,Invert:D.Invert,Kaleidoscope:O.Kaleidoscope,Mask:k.Mask,Noise:A.Noise,Pixelate:j.Pixelate,Posterize:M.Posterize,RGB:N.RGB,RGBA:P.RGBA,Sepia:F.Sepia,Solarize:I.Solarize,Threshold:L.Threshold}})}),Ae=w((exports,t)=>{Object.defineProperty(exports,`__esModule`,{value:!0});let n=ke();t.exports=n.Konva}),je=w(exports=>{
/*!
*  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
*  
*  howler.js v2.2.4
*  howlerjs.com
*
*  (c) 2013-2020, James Simpson of GoldFire Studios
*  goldfirestudios.com
*
*  MIT License
*/
(function(){"use strict";var t=function(){this.init()};t.prototype={init:function(){var e=this||n;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent=`canplaythrough`,e._navigator=typeof window<`u`&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var t=this||n;if(e=parseFloat(e),t.ctx||u(),e!==void 0&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,n.ctx.currentTime);for(var r=0;r<t._howls.length;r++)if(!t._howls[r]._webAudio)for(var i=t._howls[r]._getSoundIds(),a=0;a<i.length;a++){var o=t._howls[r]._soundById(i[a]);o&&o._node&&(o._node.volume=o._volume*e)}return t}return t._volume},mute:function(e){var t=this||n;t.ctx||u(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,n.ctx.currentTime);for(var r=0;r<t._howls.length;r++)if(!t._howls[r]._webAudio)for(var i=t._howls[r]._getSoundIds(),a=0;a<i.length;a++){var o=t._howls[r]._soundById(i[a]);o&&o._node&&(o._node.muted=e?!0:o._muted)}return t},stop:function(){for(var e=this||n,t=0;t<e._howls.length;t++)e._howls[t].stop();return e},unload:function(){for(var e=this||n,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&e.ctx.close!==void 0&&(e.ctx.close(),e.ctx=null,u()),e},codecs:function(e){return(this||n)._codecs[e.replace(/^x-/,``)]},_setup:function(){var e=this||n;if(e.state=e.ctx&&e.ctx.state||`suspended`,e._autoSuspend(),!e.usingWebAudio)if(typeof Audio<`u`)try{var t=new Audio;t.oncanplaythrough===void 0&&(e._canPlayEvent=`canplay`)}catch{e.noAudio=!0}else e.noAudio=!0;try{var t=new Audio;t.muted&&(e.noAudio=!0)}catch{}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||n,t=null;try{t=typeof Audio<`u`?new Audio:null}catch{return e}if(!t||typeof t.canPlayType!=`function`)return e;var r=t.canPlayType(`audio/mpeg;`).replace(/^no$/,``),i=e._navigator?e._navigator.userAgent:``,a=i.match(/OPR\/(\d+)/g),o=a&&parseInt(a[0].split(`/`)[1],10)<33,s=i.indexOf(`Safari`)!==-1&&i.indexOf(`Chrome`)===-1,c=i.match(/Version\/(.*?) /),l=s&&c&&parseInt(c[1],10)<15;return e._codecs={mp3:!!(!o&&(r||t.canPlayType(`audio/mp3;`).replace(/^no$/,``))),mpeg:!!r,opus:!!t.canPlayType(`audio/ogg; codecs="opus"`).replace(/^no$/,``),ogg:!!t.canPlayType(`audio/ogg; codecs="vorbis"`).replace(/^no$/,``),oga:!!t.canPlayType(`audio/ogg; codecs="vorbis"`).replace(/^no$/,``),wav:!!(t.canPlayType(`audio/wav; codecs="1"`)||t.canPlayType(`audio/wav`)).replace(/^no$/,``),aac:!!t.canPlayType(`audio/aac;`).replace(/^no$/,``),caf:!!t.canPlayType(`audio/x-caf;`).replace(/^no$/,``),m4a:!!(t.canPlayType(`audio/x-m4a;`)||t.canPlayType(`audio/m4a;`)||t.canPlayType(`audio/aac;`)).replace(/^no$/,``),m4b:!!(t.canPlayType(`audio/x-m4b;`)||t.canPlayType(`audio/m4b;`)||t.canPlayType(`audio/aac;`)).replace(/^no$/,``),mp4:!!(t.canPlayType(`audio/x-mp4;`)||t.canPlayType(`audio/mp4;`)||t.canPlayType(`audio/aac;`)).replace(/^no$/,``),weba:!!(!l&&t.canPlayType(`audio/webm; codecs="vorbis"`).replace(/^no$/,``)),webm:!!(!l&&t.canPlayType(`audio/webm; codecs="vorbis"`).replace(/^no$/,``)),dolby:!!t.canPlayType(`audio/mp4; codecs="ec-3"`).replace(/^no$/,``),flac:!!(t.canPlayType(`audio/x-flac;`)||t.canPlayType(`audio/flac;`)).replace(/^no$/,``)},e},_unlockAudio:function(){var e=this||n;if(!(e._audioUnlocked||!e.ctx)){e._audioUnlocked=!1,e.autoUnlock=!1,!e._mobileUnloaded&&e.ctx.sampleRate!==44100&&(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var t=function(n){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var r=new Audio;r._unlocked=!0,e._releaseHtml5Audio(r)}catch{e.noAudio=!0;break}for(var i=0;i<e._howls.length;i++)if(!e._howls[i]._webAudio)for(var a=e._howls[i]._getSoundIds(),o=0;o<a.length;o++){var s=e._howls[i]._soundById(a[o]);s&&s._node&&!s._node._unlocked&&(s._node._unlocked=!0,s._node.load())}e._autoResume();var c=e.ctx.createBufferSource();c.buffer=e._scratchBuffer,c.connect(e.ctx.destination),c.start===void 0?c.noteOn(0):c.start(0),typeof e.ctx.resume==`function`&&e.ctx.resume(),c.onended=function(){c.disconnect(0),e._audioUnlocked=!0,document.removeEventListener(`touchstart`,t,!0),document.removeEventListener(`touchend`,t,!0),document.removeEventListener(`click`,t,!0),document.removeEventListener(`keydown`,t,!0);for(var n=0;n<e._howls.length;n++)e._howls[n]._emit(`unlock`)}};return document.addEventListener(`touchstart`,t,!0),document.addEventListener(`touchend`,t,!0),document.addEventListener(`click`,t,!0),document.addEventListener(`keydown`,t,!0),e}},_obtainHtml5Audio:function(){var e=this||n;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var t=new Audio().play();return t&&typeof Promise<`u`&&(t instanceof Promise||typeof t.then==`function`)&&t.catch(function(){console.warn(`HTML5 Audio pool exhausted, returning potentially locked audio object.`)}),new Audio},_releaseHtml5Audio:function(e){var t=this||n;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function(){var e=this;if(!(!e.autoSuspend||!e.ctx||e.ctx.suspend===void 0||!n.usingWebAudio)){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio){for(var r=0;r<e._howls[t]._sounds.length;r++)if(!e._howls[t]._sounds[r]._paused)return e}return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){if(e.autoSuspend){e._suspendTimer=null,e.state=`suspending`;var t=function(){e.state=`suspended`,e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(t,t)}},3e4),e}},_autoResume:function(){var e=this;if(!(!e.ctx||e.ctx.resume===void 0||!n.usingWebAudio))return e.state===`running`&&e.ctx.state!==`interrupted`&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):e.state===`suspended`||e.state===`running`&&e.ctx.state===`interrupted`?(e.ctx.resume().then(function(){e.state=`running`;for(var t=0;t<e._howls.length;t++)e._howls[t]._emit(`resume`)}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):e.state===`suspending`&&(e._resumeAfterSuspend=!0),e}};var n=new t,r=function(e){var t=this;if(!e.src||e.src.length===0){console.error(`An array of source files must be passed with any new Howl.`);return}t.init(e)};r.prototype={init:function(e){var t=this;return n.ctx||u(),t._autoplay=e.autoplay||!1,t._format=typeof e.format==`string`?[e.format]:e.format,t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload=typeof e.preload==`boolean`||e.preload===`metadata`?e.preload:!0,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src=typeof e.src==`string`?[e.src]:e.src,t._volume=e.volume===void 0?1:e.volume,t._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:`GET`,headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:e.xhr&&e.xhr.withCredentials?e.xhr.withCredentials:!1},t._duration=0,t._state=`unloaded`,t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=n.usingWebAudio&&!t._html5,n.ctx!==void 0&&n.ctx&&n.autoUnlock&&n._unlockAudio(),n._howls.push(t),t._autoplay&&t._queue.push({event:`play`,action:function(){t.play()}}),t._preload&&t._preload!==`none`&&t.load(),t},load:function(){var e=this,t=null;if(n.noAudio){e._emit(`loaderror`,null,`No audio support.`);return}typeof e._src==`string`&&(e._src=[e._src]);for(var r=0;r<e._src.length;r++){var a,s;if(e._format&&e._format[r])a=e._format[r];else{if(s=e._src[r],typeof s!=`string`){e._emit(`loaderror`,null,`Non-string found in selected audio sources - ignoring.`);continue}a=/^data:audio\/([^;,]+);/i.exec(s),a||=/\.([^.]+)$/.exec(s.split(`?`,1)[0]),a&&=a[1].toLowerCase()}if(a||console.warn(`No file extension was found. Consider using the "format" property or specify an extension.`),a&&n.codecs(a)){t=e._src[r];break}}if(!t){e._emit(`loaderror`,null,`No codec support for selected audio sources.`);return}return e._src=t,e._state=`loading`,window.location.protocol===`https:`&&t.slice(0,5)===`http:`&&(e._html5=!0,e._webAudio=!1),new i(e),e._webAudio&&o(e),e},play:function(e,t){var r=this,i=null;if(typeof e==`number`)i=e,e=null;else if(typeof e==`string`&&r._state===`loaded`&&!r._sprite[e])return null;else if(e===void 0&&(e=`__default`,!r._playLock)){for(var a=0,o=0;o<r._sounds.length;o++)r._sounds[o]._paused&&!r._sounds[o]._ended&&(a++,i=r._sounds[o]._id);a===1?e=null:i=null}var s=i?r._soundById(i):r._inactiveSound();if(!s)return null;if(i&&!e&&(e=s._sprite||`__default`),r._state!==`loaded`){s._sprite=e,s._ended=!1;var c=s._id;return r._queue.push({event:`play`,action:function(){r.play(c)}}),c}if(i&&!s._paused)return t||r._loadQueue(`play`),s._id;r._webAudio&&n._autoResume();var l=Math.max(0,s._seek>0?s._seek:r._sprite[e][0]/1e3),u=Math.max(0,(r._sprite[e][0]+r._sprite[e][1])/1e3-l),d=u*1e3/Math.abs(s._rate),f=r._sprite[e][0]/1e3,p=(r._sprite[e][0]+r._sprite[e][1])/1e3;s._sprite=e,s._ended=!1;var m=function(){s._paused=!1,s._seek=l,s._start=f,s._stop=p,s._loop=!!(s._loop||r._sprite[e][2])};if(l>=p){r._ended(s);return}var h=s._node;if(r._webAudio){var g=function(){r._playLock=!1,m(),r._refreshBuffer(s);var e=s._muted||r._muted?0:s._volume;h.gain.setValueAtTime(e,n.ctx.currentTime),s._playStart=n.ctx.currentTime,h.bufferSource.start===void 0?s._loop?h.bufferSource.noteGrainOn(0,l,86400):h.bufferSource.noteGrainOn(0,l,u):s._loop?h.bufferSource.start(0,l,86400):h.bufferSource.start(0,l,u),d!==1/0&&(r._endTimers[s._id]=setTimeout(r._ended.bind(r,s),d)),t||setTimeout(function(){r._emit(`play`,s._id),r._loadQueue()},0)};n.state===`running`&&n.ctx.state!==`interrupted`?g():(r._playLock=!0,r.once(`resume`,g),r._clearTimer(s._id))}else{var _=function(){h.currentTime=l,h.muted=s._muted||r._muted||n._muted||h.muted,h.volume=s._volume*n.volume(),h.playbackRate=s._rate;try{var i=h.play();if(i&&typeof Promise<`u`&&(i instanceof Promise||typeof i.then==`function`)?(r._playLock=!0,m(),i.then(function(){r._playLock=!1,h._unlocked=!0,t?r._loadQueue():r._emit(`play`,s._id)}).catch(function(){r._playLock=!1,r._emit(`playerror`,s._id,`Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.`),s._ended=!0,s._paused=!0})):t||(r._playLock=!1,m(),r._emit(`play`,s._id)),h.playbackRate=s._rate,h.paused){r._emit(`playerror`,s._id,`Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.`);return}e!==`__default`||s._loop?r._endTimers[s._id]=setTimeout(r._ended.bind(r,s),d):(r._endTimers[s._id]=function(){r._ended(s),h.removeEventListener(`ended`,r._endTimers[s._id],!1)},h.addEventListener(`ended`,r._endTimers[s._id],!1))}catch(e){r._emit(`playerror`,s._id,e)}};h.src===`data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA`&&(h.src=r._src,h.load());var v=window&&window.ejecta||!h.readyState&&n._navigator.isCocoonJS;if(h.readyState>=3||v)_();else{r._playLock=!0,r._state=`loading`;var y=function(){r._state=`loaded`,_(),h.removeEventListener(n._canPlayEvent,y,!1)};h.addEventListener(n._canPlayEvent,y,!1),r._clearTimer(s._id)}}return s._id},pause:function(e){var t=this;if(t._state!==`loaded`||t._playLock)return t._queue.push({event:`pause`,action:function(){t.pause(e)}}),t;for(var n=t._getSoundIds(e),r=0;r<n.length;r++){t._clearTimer(n[r]);var i=t._soundById(n[r]);if(i&&!i._paused&&(i._seek=t.seek(n[r]),i._rateSeek=0,i._paused=!0,t._stopFade(n[r]),i._node))if(t._webAudio){if(!i._node.bufferSource)continue;i._node.bufferSource.stop===void 0?i._node.bufferSource.noteOff(0):i._node.bufferSource.stop(0),t._cleanBuffer(i._node)}else (!isNaN(i._node.duration)||i._node.duration===1/0)&&i._node.pause();arguments[1]||t._emit(`pause`,i?i._id:null)}return t},stop:function(e,t){var n=this;if(n._state!==`loaded`||n._playLock)return n._queue.push({event:`stop`,action:function(){n.stop(e)}}),n;for(var r=n._getSoundIds(e),i=0;i<r.length;i++){n._clearTimer(r[i]);var a=n._soundById(r[i]);a&&(a._seek=a._start||0,a._rateSeek=0,a._paused=!0,a._ended=!0,n._stopFade(r[i]),a._node&&(n._webAudio?a._node.bufferSource&&(a._node.bufferSource.stop===void 0?a._node.bufferSource.noteOff(0):a._node.bufferSource.stop(0),n._cleanBuffer(a._node)):(!isNaN(a._node.duration)||a._node.duration===1/0)&&(a._node.currentTime=a._start||0,a._node.pause(),a._node.duration===1/0&&n._clearSound(a._node))),t||n._emit(`stop`,a._id))}return n},mute:function(e,t){var r=this;if(r._state!==`loaded`||r._playLock)return r._queue.push({event:`mute`,action:function(){r.mute(e,t)}}),r;if(t===void 0)if(typeof e==`boolean`)r._muted=e;else return r._muted;for(var i=r._getSoundIds(t),a=0;a<i.length;a++){var o=r._soundById(i[a]);o&&(o._muted=e,o._interval&&r._stopFade(o._id),r._webAudio&&o._node?o._node.gain.setValueAtTime(e?0:o._volume,n.ctx.currentTime):o._node&&(o._node.muted=n._muted?!0:e),r._emit(`mute`,o._id))}return r},volume:function(){var e=this,t=arguments,r,i;if(t.length===0)return e._volume;if(t.length===1||t.length===2&&t[1]===void 0){var a=e._getSoundIds(),o=a.indexOf(t[0]);o>=0?i=parseInt(t[0],10):r=parseFloat(t[0])}else t.length>=2&&(r=parseFloat(t[0]),i=parseInt(t[1],10));var s;if(r!==void 0&&r>=0&&r<=1){if(e._state!==`loaded`||e._playLock)return e._queue.push({event:`volume`,action:function(){e.volume.apply(e,t)}}),e;i===void 0&&(e._volume=r),i=e._getSoundIds(i);for(var c=0;c<i.length;c++)s=e._soundById(i[c]),s&&(s._volume=r,t[2]||e._stopFade(i[c]),e._webAudio&&s._node&&!s._muted?s._node.gain.setValueAtTime(r,n.ctx.currentTime):s._node&&!s._muted&&(s._node.volume=r*n.volume()),e._emit(`volume`,s._id))}else return s=i?e._soundById(i):e._sounds[0],s?s._volume:0;return e},fade:function(e,t,r,i){var a=this;if(a._state!==`loaded`||a._playLock)return a._queue.push({event:`fade`,action:function(){a.fade(e,t,r,i)}}),a;e=Math.min(Math.max(0,parseFloat(e)),1),t=Math.min(Math.max(0,parseFloat(t)),1),r=parseFloat(r),a.volume(e,i);for(var o=a._getSoundIds(i),s=0;s<o.length;s++){var c=a._soundById(o[s]);if(c){if(i||a._stopFade(o[s]),a._webAudio&&!c._muted){var l=n.ctx.currentTime,u=l+r/1e3;c._volume=e,c._node.gain.setValueAtTime(e,l),c._node.gain.linearRampToValueAtTime(t,u)}a._startFadeInterval(c,e,t,r,o[s],i===void 0)}}return a},_startFadeInterval:function(e,t,n,r,i,a){var o=this,s=t,c=n-t,l=Math.abs(c/.01),u=Math.max(4,l>0?r/l:r),d=Date.now();e._fadeTo=n,e._interval=setInterval(function(){var i=(Date.now()-d)/r;d=Date.now(),s+=c*i,s=Math.round(s*100)/100,s=c<0?Math.max(n,s):Math.min(n,s),o._webAudio?e._volume=s:o.volume(s,e._id,!0),a&&(o._volume=s),(n<t&&s<=n||n>t&&s>=n)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,o.volume(n,e._id),o._emit(`fade`,e._id))},u)},_stopFade:function(e){var t=this,r=t._soundById(e);return r&&r._interval&&(t._webAudio&&r._node.gain.cancelScheduledValues(n.ctx.currentTime),clearInterval(r._interval),r._interval=null,t.volume(r._fadeTo,e),r._fadeTo=null,t._emit(`fade`,e)),t},loop:function(){var e=this,t=arguments,n,r,i;if(t.length===0)return e._loop;if(t.length===1)if(typeof t[0]==`boolean`)n=t[0],e._loop=n;else return i=e._soundById(parseInt(t[0],10)),i?i._loop:!1;else t.length===2&&(n=t[0],r=parseInt(t[1],10));for(var a=e._getSoundIds(r),o=0;o<a.length;o++)i=e._soundById(a[o]),i&&(i._loop=n,e._webAudio&&i._node&&i._node.bufferSource&&(i._node.bufferSource.loop=n,n&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop,e.playing(a[o])&&(e.pause(a[o],!0),e.play(a[o],!0)))));return e},rate:function(){var e=this,t=arguments,r,i;if(t.length===0)i=e._sounds[0]._id;else if(t.length===1){var a=e._getSoundIds(),o=a.indexOf(t[0]);o>=0?i=parseInt(t[0],10):r=parseFloat(t[0])}else t.length===2&&(r=parseFloat(t[0]),i=parseInt(t[1],10));var s;if(typeof r==`number`){if(e._state!==`loaded`||e._playLock)return e._queue.push({event:`rate`,action:function(){e.rate.apply(e,t)}}),e;i===void 0&&(e._rate=r),i=e._getSoundIds(i);for(var c=0;c<i.length;c++)if(s=e._soundById(i[c]),s){e.playing(i[c])&&(s._rateSeek=e.seek(i[c]),s._playStart=e._webAudio?n.ctx.currentTime:s._playStart),s._rate=r,e._webAudio&&s._node&&s._node.bufferSource?s._node.bufferSource.playbackRate.setValueAtTime(r,n.ctx.currentTime):s._node&&(s._node.playbackRate=r);var l=e.seek(i[c]),u=(e._sprite[s._sprite][0]+e._sprite[s._sprite][1])/1e3-l,d=u*1e3/Math.abs(s._rate);(e._endTimers[i[c]]||!s._paused)&&(e._clearTimer(i[c]),e._endTimers[i[c]]=setTimeout(e._ended.bind(e,s),d)),e._emit(`rate`,s._id)}}else return s=e._soundById(i),s?s._rate:e._rate;return e},seek:function(){var e=this,t=arguments,r,i;if(t.length===0)e._sounds.length&&(i=e._sounds[0]._id);else if(t.length===1){var a=e._getSoundIds(),o=a.indexOf(t[0]);o>=0?i=parseInt(t[0],10):e._sounds.length&&(i=e._sounds[0]._id,r=parseFloat(t[0]))}else t.length===2&&(r=parseFloat(t[0]),i=parseInt(t[1],10));if(i===void 0)return 0;if(typeof r==`number`&&(e._state!==`loaded`||e._playLock))return e._queue.push({event:`seek`,action:function(){e.seek.apply(e,t)}}),e;var s=e._soundById(i);if(s)if(typeof r==`number`&&r>=0){var c=e.playing(i);c&&e.pause(i,!0),s._seek=r,s._ended=!1,e._clearTimer(i),!e._webAudio&&s._node&&!isNaN(s._node.duration)&&(s._node.currentTime=r);var l=function(){c&&e.play(i,!0),e._emit(`seek`,i)};if(c&&!e._webAudio){var u=function(){e._playLock?setTimeout(u,0):l()};setTimeout(u,0)}else l()}else if(e._webAudio){var d=e.playing(i)?n.ctx.currentTime-s._playStart:0,f=s._rateSeek?s._rateSeek-s._seek:0;return s._seek+(f+d*Math.abs(s._rate))}else return s._node.currentTime;return e},playing:function(e){var t=this;if(typeof e==`number`){var n=t._soundById(e);return n?!n._paused:!1}for(var r=0;r<t._sounds.length;r++)if(!t._sounds[r]._paused)return!0;return!1},duration:function(e){var t=this,n=t._duration,r=t._soundById(e);return r&&(n=t._sprite[r._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,r=0;r<t.length;r++)t[r]._paused||e.stop(t[r]._id),e._webAudio||(e._clearSound(t[r]._node),t[r]._node.removeEventListener(`error`,t[r]._errorFn,!1),t[r]._node.removeEventListener(n._canPlayEvent,t[r]._loadFn,!1),t[r]._node.removeEventListener(`ended`,t[r]._endFn,!1),n._releaseHtml5Audio(t[r]._node)),delete t[r]._node,e._clearTimer(t[r]._id);var i=n._howls.indexOf(e);i>=0&&n._howls.splice(i,1);var o=!0;for(r=0;r<n._howls.length;r++)if(n._howls[r]._src===e._src||e._src.indexOf(n._howls[r]._src)>=0){o=!1;break}return a&&o&&delete a[e._src],n.noAudio=!1,e._state=`unloaded`,e._sounds=[],e=null,null},on:function(e,t,n,r){var i=this,a=i[`_on`+e];return typeof t==`function`&&a.push(r?{id:n,fn:t,once:r}:{id:n,fn:t}),i},off:function(e,t,n){var r=this,i=r[`_on`+e],a=0;if(typeof t==`number`&&(n=t,t=null),t||n)for(a=0;a<i.length;a++){var o=n===i[a].id;if(t===i[a].fn&&o||!t&&o){i.splice(a,1);break}}else if(e)r[`_on`+e]=[];else{var s=Object.keys(r);for(a=0;a<s.length;a++)s[a].indexOf(`_on`)===0&&Array.isArray(r[s[a]])&&(r[s[a]]=[])}return r},once:function(e,t,n){var r=this;return r.on(e,t,n,1),r},_emit:function(e,t,n){for(var r=this,i=r[`_on`+e],a=i.length-1;a>=0;a--)(!i[a].id||i[a].id===t||e===`load`)&&(setTimeout(function(e){e.call(this,t,n)}.bind(r,i[a].fn),0),i[a].once&&r.off(e,i[a].fn,i[a].id));return r._loadQueue(e),r},_loadQueue:function(e){var t=this;if(t._queue.length>0){var n=t._queue[0];n.event===e&&(t._queue.shift(),t._loadQueue()),e||n.action()}return t},_ended:function(e){var t=this,r=e._sprite;if(!t._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(t._ended.bind(t,e),100),t;var i=!!(e._loop||t._sprite[r][2]);if(t._emit(`end`,e._id),!t._webAudio&&i&&t.stop(e._id,!0).play(e._id),t._webAudio&&i){t._emit(`play`,e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=n.ctx.currentTime;var a=(e._stop-e._start)*1e3/Math.abs(e._rate);t._endTimers[e._id]=setTimeout(t._ended.bind(t,e),a)}return t._webAudio&&!i&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,t._clearTimer(e._id),t._cleanBuffer(e._node),n._autoSuspend()),!t._webAudio&&!i&&t.stop(e._id,!0),t},_clearTimer:function(e){var t=this;if(t._endTimers[e]){if(typeof t._endTimers[e]!=`function`)clearTimeout(t._endTimers[e]);else{var n=t._soundById(e);n&&n._node&&n._node.removeEventListener(`ended`,t._endTimers[e],!1)}delete t._endTimers[e]}return t},_soundById:function(e){for(var t=this,n=0;n<t._sounds.length;n++)if(e===t._sounds[n]._id)return t._sounds[n];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new i(e)},_drain:function(){var e=this,t=e._pool,n=0,r=0;if(!(e._sounds.length<t)){for(r=0;r<e._sounds.length;r++)e._sounds[r]._ended&&n++;for(r=e._sounds.length-1;r>=0;r--){if(n<=t)return;e._sounds[r]._ended&&(e._webAudio&&e._sounds[r]._node&&e._sounds[r]._node.disconnect(0),e._sounds.splice(r,1),n--)}}},_getSoundIds:function(e){var t=this;if(e===void 0){for(var n=[],r=0;r<t._sounds.length;r++)n.push(t._sounds[r]._id);return n}else return[e]},_refreshBuffer:function(e){var t=this;return e._node.bufferSource=n.ctx.createBufferSource(),e._node.bufferSource.buffer=a[t._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,n.ctx.currentTime),t},_cleanBuffer:function(e){var t=this,r=n._navigator&&n._navigator.vendor.indexOf(`Apple`)>=0;if(!e.bufferSource)return t;if(n._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),r))try{e.bufferSource.buffer=n._scratchBuffer}catch{}return e.bufferSource=null,t},_clearSound:function(e){var t=/MSIE |Trident\//.test(n._navigator&&n._navigator.userAgent);t||(e.src=`data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA`)}};var i=function(e){this._parent=e,this.init()};i.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite=`__default`,e._id=++n._counter,t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,r=n._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node=n.ctx.createGain===void 0?n.ctx.createGainNode():n.ctx.createGain(),e._node.gain.setValueAtTime(r,n.ctx.currentTime),e._node.paused=!0,e._node.connect(n.masterGain)):n.noAudio||(e._node=n._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener(`error`,e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(n._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener(`ended`,e._endFn,!1),e._node.src=t._src,e._node.preload=t._preload===!0?`auto`:t._preload,e._node.volume=r*n.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite=`__default`,e._id=++n._counter,e},_errorListener:function(){var e=this;e._parent._emit(`loaderror`,e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener(`error`,e._errorFn,!1)},_loadListener:function(){var e=this,t=e._parent;t._duration=Math.ceil(e._node.duration*10)/10,Object.keys(t._sprite).length===0&&(t._sprite={__default:[0,t._duration*1e3]}),t._state!==`loaded`&&(t._state=`loaded`,t._emit(`load`),t._loadQueue()),e._node.removeEventListener(n._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,t=e._parent;t._duration===1/0&&(t._duration=Math.ceil(e._node.duration*10)/10,t._sprite.__default[1]===1/0&&(t._sprite.__default[1]=t._duration*1e3),t._ended(e)),e._node.removeEventListener(`ended`,e._endFn,!1)}};var a={},o=function(e){var t=e._src;if(a[t]){e._duration=a[t].duration,l(e);return}if(/^data:[^;]+;base64,/.test(t)){for(var n=atob(t.split(`,`)[1]),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);c(r.buffer,e)}else{var o=new XMLHttpRequest;o.open(e._xhr.method,t,!0),o.withCredentials=e._xhr.withCredentials,o.responseType=`arraybuffer`,e._xhr.headers&&Object.keys(e._xhr.headers).forEach(function(t){o.setRequestHeader(t,e._xhr.headers[t])}),o.onload=function(){var t=(o.status+``)[0];if(t!==`0`&&t!==`2`&&t!==`3`){e._emit(`loaderror`,null,`Failed loading audio file with status: `+o.status+`.`);return}c(o.response,e)},o.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete a[t],e.load())},s(o)}},s=function(e){try{e.send()}catch{e.onerror()}},c=function(e,t){var r=function(){t._emit(`loaderror`,null,`Decoding audio data failed.`)},i=function(e){e&&t._sounds.length>0?(a[t._src]=e,l(t,e)):r()};typeof Promise<`u`&&n.ctx.decodeAudioData.length===1?n.ctx.decodeAudioData(e).then(i).catch(r):n.ctx.decodeAudioData(e,i,r)},l=function(e,t){t&&!e._duration&&(e._duration=t.duration),Object.keys(e._sprite).length===0&&(e._sprite={__default:[0,e._duration*1e3]}),e._state!==`loaded`&&(e._state=`loaded`,e._emit(`load`),e._loadQueue())},u=function(){if(n.usingWebAudio){try{typeof AudioContext<`u`?n.ctx=new AudioContext:typeof webkitAudioContext<`u`?n.ctx=new webkitAudioContext:n.usingWebAudio=!1}catch{n.usingWebAudio=!1}n.ctx||(n.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(n._navigator&&n._navigator.platform),t=n._navigator&&n._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),r=t?parseInt(t[1],10):null;if(e&&r&&r<9){var i=/safari/.test(n._navigator&&n._navigator.userAgent.toLowerCase());n._navigator&&!i&&(n.usingWebAudio=!1)}n.usingWebAudio&&(n.masterGain=n.ctx.createGain===void 0?n.ctx.createGainNode():n.ctx.createGain(),n.masterGain.gain.setValueAtTime(n._muted?0:n._volume,n.ctx.currentTime),n.masterGain.connect(n.ctx.destination)),n._setup()}};typeof define==`function`&&define.amd&&define([],function(){return{Howler:n,Howl:r}}),exports!==void 0&&(exports.Howler=n,exports.Howl=r),typeof global<`u`?(global.HowlerGlobal=t,global.Howler=n,global.Howl=r,global.Sound=i):typeof window<`u`&&(window.HowlerGlobal=t,window.Howler=n,window.Howl=r,window.Sound=i)})(),function(){"use strict";HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var n=t._howls.length-1;n>=0;n--)t._howls[n].stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,n){var r=this;if(!r.ctx||!r.ctx.listener)return r;if(t=typeof t==`number`?t:r._pos[1],n=typeof n==`number`?n:r._pos[2],typeof e==`number`)r._pos=[e,t,n],r.ctx.listener.positionX===void 0?r.ctx.listener.setPosition(r._pos[0],r._pos[1],r._pos[2]):(r.ctx.listener.positionX.setTargetAtTime(r._pos[0],Howler.ctx.currentTime,.1),r.ctx.listener.positionY.setTargetAtTime(r._pos[1],Howler.ctx.currentTime,.1),r.ctx.listener.positionZ.setTargetAtTime(r._pos[2],Howler.ctx.currentTime,.1));else return r._pos;return r},HowlerGlobal.prototype.orientation=function(e,t,n,r,i,a){var o=this;if(!o.ctx||!o.ctx.listener)return o;var s=o._orientation;if(t=typeof t==`number`?t:s[1],n=typeof n==`number`?n:s[2],r=typeof r==`number`?r:s[3],i=typeof i==`number`?i:s[4],a=typeof a==`number`?a:s[5],typeof e==`number`)o._orientation=[e,t,n,r,i,a],o.ctx.listener.forwardX===void 0?o.ctx.listener.setOrientation(e,t,n,r,i,a):(o.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),o.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),o.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),o.ctx.listener.upX.setTargetAtTime(r,Howler.ctx.currentTime,.1),o.ctx.listener.upY.setTargetAtTime(i,Howler.ctx.currentTime,.1),o.ctx.listener.upZ.setTargetAtTime(a,Howler.ctx.currentTime,.1));else return s;return o},Howl.prototype.init=function(e){return function(t){var n=this;return n._orientation=t.orientation||[1,0,0],n._stereo=t.stereo||null,n._pos=t.pos||null,n._pannerAttr={coneInnerAngle:t.coneInnerAngle===void 0?360:t.coneInnerAngle,coneOuterAngle:t.coneOuterAngle===void 0?360:t.coneOuterAngle,coneOuterGain:t.coneOuterGain===void 0?0:t.coneOuterGain,distanceModel:t.distanceModel===void 0?`inverse`:t.distanceModel,maxDistance:t.maxDistance===void 0?1e4:t.maxDistance,panningModel:t.panningModel===void 0?`HRTF`:t.panningModel,refDistance:t.refDistance===void 0?1:t.refDistance,rolloffFactor:t.rolloffFactor===void 0?1:t.rolloffFactor},n._onstereo=t.onstereo?[{fn:t.onstereo}]:[],n._onpos=t.onpos?[{fn:t.onpos}]:[],n._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,n){var r=this;if(!r._webAudio)return r;if(r._state!==`loaded`)return r._queue.push({event:`stereo`,action:function(){r.stereo(t,n)}}),r;var i=Howler.ctx.createStereoPanner===void 0?`spatial`:`stereo`;if(n===void 0)if(typeof t==`number`)r._stereo=t,r._pos=[t,0,0];else return r._stereo;for(var a=r._getSoundIds(n),o=0;o<a.length;o++){var s=r._soundById(a[o]);if(s)if(typeof t==`number`)s._stereo=t,s._pos=[t,0,0],s._node&&(s._pannerAttr.panningModel=`equalpower`,(!s._panner||!s._panner.pan)&&e(s,i),i===`spatial`?s._panner.positionX===void 0?s._panner.setPosition(t,0,0):(s._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),s._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),s._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):s._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),r._emit(`stereo`,s._id);else return s._stereo}return r},Howl.prototype.pos=function(t,n,r,i){var a=this;if(!a._webAudio)return a;if(a._state!==`loaded`)return a._queue.push({event:`pos`,action:function(){a.pos(t,n,r,i)}}),a;if(n=typeof n==`number`?n:0,r=typeof r==`number`?r:-.5,i===void 0)if(typeof t==`number`)a._pos=[t,n,r];else return a._pos;for(var o=a._getSoundIds(i),s=0;s<o.length;s++){var c=a._soundById(o[s]);if(c)if(typeof t==`number`)c._pos=[t,n,r],c._node&&((!c._panner||c._panner.pan)&&e(c,`spatial`),c._panner.positionX===void 0?c._panner.setPosition(t,n,r):(c._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime))),a._emit(`pos`,c._id);else return c._pos}return a},Howl.prototype.orientation=function(t,n,r,i){var a=this;if(!a._webAudio)return a;if(a._state!==`loaded`)return a._queue.push({event:`orientation`,action:function(){a.orientation(t,n,r,i)}}),a;if(n=typeof n==`number`?n:a._orientation[1],r=typeof r==`number`?r:a._orientation[2],i===void 0)if(typeof t==`number`)a._orientation=[t,n,r];else return a._orientation;for(var o=a._getSoundIds(i),s=0;s<o.length;s++){var c=a._soundById(o[s]);if(c)if(typeof t==`number`)c._orientation=[t,n,r],c._node&&(c._panner||(c._pos||=a._pos||[0,0,-.5],e(c,`spatial`)),c._panner.orientationX===void 0?c._panner.setOrientation(t,n,r):(c._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),c._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),c._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime))),a._emit(`orientation`,c._id);else return c._orientation}return a},Howl.prototype.pannerAttr=function(){var t=this,n=arguments,r,i,a;if(!t._webAudio)return t;if(n.length===0)return t._pannerAttr;if(n.length===1)if(typeof n[0]==`object`)r=n[0],i===void 0&&(r.pannerAttr||={coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel,maxDistance:r.maxDistance,refDistance:r.refDistance,rolloffFactor:r.rolloffFactor,panningModel:r.panningModel},t._pannerAttr={coneInnerAngle:r.pannerAttr.coneInnerAngle===void 0?t._coneInnerAngle:r.pannerAttr.coneInnerAngle,coneOuterAngle:r.pannerAttr.coneOuterAngle===void 0?t._coneOuterAngle:r.pannerAttr.coneOuterAngle,coneOuterGain:r.pannerAttr.coneOuterGain===void 0?t._coneOuterGain:r.pannerAttr.coneOuterGain,distanceModel:r.pannerAttr.distanceModel===void 0?t._distanceModel:r.pannerAttr.distanceModel,maxDistance:r.pannerAttr.maxDistance===void 0?t._maxDistance:r.pannerAttr.maxDistance,refDistance:r.pannerAttr.refDistance===void 0?t._refDistance:r.pannerAttr.refDistance,rolloffFactor:r.pannerAttr.rolloffFactor===void 0?t._rolloffFactor:r.pannerAttr.rolloffFactor,panningModel:r.pannerAttr.panningModel===void 0?t._panningModel:r.pannerAttr.panningModel});else return a=t._soundById(parseInt(n[0],10)),a?a._pannerAttr:t._pannerAttr;else n.length===2&&(r=n[0],i=parseInt(n[1],10));for(var o=t._getSoundIds(i),s=0;s<o.length;s++)if(a=t._soundById(o[s]),a){var c=a._pannerAttr;c={coneInnerAngle:r.coneInnerAngle===void 0?c.coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle===void 0?c.coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain===void 0?c.coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel===void 0?c.distanceModel:r.distanceModel,maxDistance:r.maxDistance===void 0?c.maxDistance:r.maxDistance,refDistance:r.refDistance===void 0?c.refDistance:r.refDistance,rolloffFactor:r.rolloffFactor===void 0?c.rolloffFactor:r.rolloffFactor,panningModel:r.panningModel===void 0?c.panningModel:r.panningModel};var l=a._panner;l||(a._pos||=t._pos||[0,0,-.5],e(a,`spatial`),l=a._panner),l.coneInnerAngle=c.coneInnerAngle,l.coneOuterAngle=c.coneOuterAngle,l.coneOuterGain=c.coneOuterGain,l.distanceModel=c.distanceModel,l.maxDistance=c.maxDistance,l.refDistance=c.refDistance,l.rolloffFactor=c.rolloffFactor,l.panningModel=c.panningModel}return t},Sound.prototype.init=function(e){return function(){var t=this,n=t._parent;t._orientation=n._orientation,t._stereo=n._stereo,t._pos=n._pos,t._pannerAttr=n._pannerAttr,e.call(this),t._stereo?n.stereo(t._stereo):t._pos&&n.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this,n=t._parent;return t._orientation=n._orientation,t._stereo=n._stereo,t._pos=n._pos,t._pannerAttr=n._pannerAttr,t._stereo?n.stereo(t._stereo):t._pos?n.pos(t._pos[0],t._pos[1],t._pos[2],t._id):t._panner&&(t._panner.disconnect(0),t._panner=void 0,n._refreshBuffer(t)),e.call(this)}}(Sound.prototype.reset);var e=function(e,t){t||=`spatial`,t===`spatial`?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,e._panner.positionX===void 0?e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]):(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)),e._panner.orientationX===void 0?e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2]):(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime))):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}()}),Me=E(je()),Ne=class{sounds=new Map;isMuted=!1;constructor(){this.createBasicSounds()}createBasicSounds(){this.createBeepSound(`click`,800,.1,`sine`),this.createBeepSound(`spawn`,400,.2,`square`),this.createBeepSound(`destroy`,200,.3,`sawtooth`),this.createBeepSound(`warning`,600,.5,`triangle`),this.createBeepSound(`gameOver`,150,1,`sine`)}createBeepSound(e,t,n,r){let i=new(window.AudioContext||window.webkitAudioContext),a=()=>{let e=i.createOscillator(),a=i.createGain();e.connect(a),a.connect(i.destination),e.frequency.setValueAtTime(t,i.currentTime),e.type=r,a.gain.setValueAtTime(0,i.currentTime),a.gain.linearRampToValueAtTime(.1,i.currentTime+.01),a.gain.exponentialRampToValueAtTime(.001,i.currentTime+n),e.start(i.currentTime),e.stop(i.currentTime+n)},o=new Me.Howl({src:[`data:audio/wav;base64,`],volume:.3,onplay:a});this.sounds.set(e,o)}play(e,t=1){if(this.isMuted)return;let n=this.sounds.get(e);n&&this.playGeneratedSound(e,t)}playGeneratedSound(e,t){try{let n=new(window.AudioContext||window.webkitAudioContext),r=400,i=.2,a=`sine`;switch(e){case`click`:r=800,i=.1,a=`sine`;break;case`spawn`:r=400,i=.2,a=`square`;break;case`destroy`:r=200,i=.3,a=`sawtooth`;break;case`warning`:r=600,i=.5,a=`triangle`;break;case`gameOver`:r=150,i=1,a=`sine`;break}let o=n.createOscillator(),s=n.createGain();o.connect(s),s.connect(n.destination),o.frequency.setValueAtTime(r,n.currentTime),o.type=a,s.gain.setValueAtTime(0,n.currentTime),s.gain.linearRampToValueAtTime(.1*t,n.currentTime+.01),s.gain.exponentialRampToValueAtTime(.001,n.currentTime+i),o.start(n.currentTime),o.stop(n.currentTime+i)}catch(e){console.warn(`Audio playback failed:`,e)}}toggleMute(){return this.isMuted=!this.isMuted,this.isMuted}setMute(e){this.isMuted=e}getMuteStatus(){return this.isMuted}},$=E(Ae());const Pe={class:`game-container`},Fe={key:0,class:`control-panel`},Ie={class:`game-stats`},Le={class:`stat-item`},Re={class:`stat-item`},ze={class:`value`},Be={class:`stat-item`},Ve={class:`value`},He={class:`control-buttons`},Ue=[`disabled`],We=[`disabled`],Ge={class:`difficulty-controls`},Ke=[`onClick`],qe={key:1,class:`instructions`},Je={key:2,class:`game-over`},Ye={class:`game-over-content`},Xe={class:`final-score`},Ze={class:`final-stats`};var Qe=c({__name:`GameApp`,setup(t){let r=h(!1),s=h(!1),c=h(!0),v=h(!1),y=h(0),b=h(60),x=h(0),S=h(0),C=h(1),w=h(),T=null,E=null,D=null,O=new Ne,k=n(()=>{let e={rows:8,cols:12,cellSize:60,spawnInterval:2e3,blockDuration:4e3},t=C.value;return{...e,spawnInterval:Math.max(500,e.spawnInterval-(t-1)*300),blockDuration:Math.max(2e3,e.blockDuration-(t-1)*500)}}),A=n(()=>{let e=k.value,t=window.innerWidth,n=window.innerHeight,r=e.cellSize,i=e.cols,a=e.rows;t<768?(r=45,i=8,a=6):t<1024&&(r=50,i=10,a=7);let o=t-40,s=n-200,c=i*r,l=a*r;if(c>o){let e=o/c;r*=e}if(l>s){let e=s/l;r*=e}return{...e,cellSize:Math.floor(r),cols:i,rows:a}}),j=n(()=>S.value>0?Math.round(x.value/S.value*100):0),M=m(new Map),N=null,P=null,F=null,I=()=>{if(!w.value)return;let e=w.value,t=window.innerWidth,n=window.innerHeight;T=new $.default.Stage({container:e,width:t,height:n,listening:!0}),E=new $.default.Layer,T.add(E),D=new $.default.Layer,T.add(D),L(),console.log(`Konva Stage 初始化完成`)},L=()=>{if(!E)return;let e=A.value,t=(window.innerWidth-e.cols*e.cellSize)/2,n=(window.innerHeight-e.rows*e.cellSize)/2;E.destroyChildren();let r=new $.default.Rect({x:0,y:0,width:window.innerWidth,height:window.innerHeight,fill:`#0f172a`});E.add(r);for(let r=0;r<=e.cols;r++){let i=new $.default.Line({points:[t+r*e.cellSize,n,t+r*e.cellSize,n+e.rows*e.cellSize],stroke:`#334155`,strokeWidth:1,opacity:.3});E.add(i)}for(let r=0;r<=e.rows;r++){let i=new $.default.Line({points:[t,n+r*e.cellSize,t+e.cols*e.cellSize,n+r*e.cellSize],stroke:`#334155`,strokeWidth:1,opacity:.3});E.add(i)}let i=new $.default.Rect({x:t-2,y:n-2,width:e.cols*e.cellSize+4,height:e.rows*e.cellSize+4,stroke:`#00ff00`,strokeWidth:2,cornerRadius:5});E.add(i),E.draw()},R=()=>{if(!E||!r.value)return;let e=A.value,t=(window.innerWidth-e.cols*e.cellSize)/2,n=(window.innerHeight-e.rows*e.cellSize)/2,i=[];for(let t=0;t<e.rows;t++)for(let n=0;n<e.cols;n++){let e=`${t}-${n}`;M.has(e)||i.push({row:t,col:n})}if(i.length===0)return;let a=i[Math.floor(Math.random()*i.length)],{row:o,col:s}=a,c=`${o}-${s}`,l=`normal`,u=Math.random();u<.1?l=`bonus`:u<.15&&(l=`danger`);let d={normal:`#ffffff`,bonus:`#ffd700`,danger:`#ff4757`},f=new $.default.Rect({x:t+s*e.cellSize+2,y:n+o*e.cellSize+2,width:e.cellSize-4,height:e.cellSize-4,fill:d[l],stroke:`#00ff00`,strokeWidth:2,cornerRadius:4,shadowColor:`#000000`,shadowBlur:4,shadowOpacity:.5}),p=new $.default.Rect({x:t+s*e.cellSize+2,y:n+o*e.cellSize+e.cellSize-8,width:e.cellSize-4,height:4,fill:`#00ff00`,cornerRadius:2});f.on(`click tap`,e=>{console.log(`方塊被點擊:`,c),e.cancelBubble=!0,z(c)}),f.on(`mouseenter`,()=>{f.scaleX(1.05),f.scaleY(1.05),E?.draw()}),f.on(`mouseleave`,()=>{f.scaleX(1),f.scaleY(1),E?.draw()}),E.add(f),E.add(p);let m={id:c,row:o,col:s,type:l,rect:f,timer:p,timeLeft:e.blockDuration,isActive:!0};M.set(c,m),S.value++,O.play(`spawn`),f.scaleX(0),f.scaleY(0);let h=new $.default.Tween({node:f,duration:.3,scaleX:1,scaleY:1,easing:$.default.Easings.BackEaseOut});h.play(),E.draw(),console.log(`生成方塊: ${c}, 類型: ${l}`)},z=e=>{let t=M.get(e);if(!t||!t.isActive)return;console.log(`點擊方塊: ${e}, 類型: ${t.type}`),t.isActive=!1,x.value++;let n={normal:1,bonus:5,danger:-2}[t.type];y.value+=n,O.play(t.type===`danger`?`error`:`click`),B(t,n),V(e)},B=(e,t)=>{if(!D)return;let n=new $.default.Text({x:e.rect.x()+e.rect.width()/2,y:e.rect.y(),text:t>0?`+${t}`:`${t}`,fontSize:24,fontFamily:`Arial`,fill:t>0?`#00ff00`:`#ff4757`,align:`center`,offsetX:12});D.add(n);let r=new $.default.Tween({node:n,duration:1,y:n.y()-50,opacity:0,onFinish:()=>{n.destroy(),D?.draw()}});r.play(),D.draw()},V=e=>{let t=M.get(e);if(!t)return;let n=new $.default.Tween({node:t.rect,duration:.2,scaleX:0,scaleY:0,onFinish:()=>{t.rect.destroy(),t.timer.destroy(),E?.draw()}}),r=new $.default.Tween({node:t.timer,duration:.2,scaleX:0,scaleY:0});n.play(),r.play(),M.delete(e)},H=()=>{r.value&&(M.forEach((e,t)=>{if(!e.isActive)return;e.timeLeft-=100;let n=e.timeLeft/A.value.blockDuration,r=Math.max(0,(A.value.cellSize-4)*n);e.timer.width(r),n<.3?e.timer.fill(`#ff4757`):n<.6&&e.timer.fill(`#ffa502`),e.timeLeft<=0&&(V(t),O.play(`timeout`))}),E?.draw())},U=()=>{r.value||(r.value=!0,v.value=!1,b.value=60,M.clear(),L(),N=window.setInterval(()=>{b.value--,b.value<=0&&G()},1e3),P=window.setInterval(R,A.value.spawnInterval),F=window.setInterval(H,100),O.play(`start`),console.log(`遊戲開始`))},W=()=>{r.value=!1,q(),O.play(`stop`),console.log(`遊戲停止`)},G=()=>{r.value=!1,v.value=!0,q(),O.play(`gameOver`),console.log(`遊戲結束，最終分數:`,y.value)},K=()=>{W(),y.value=0,x.value=0,S.value=0,b.value=60,v.value=!1,M.forEach(e=>{e.rect.destroy(),e.timer.destroy()}),M.clear(),L(),console.log(`遊戲重置`)},q=()=>{N&&(clearInterval(N),N=null),P&&(clearInterval(P),P=null),F&&(clearInterval(F),F=null)},J=e=>{C.value=e,O.play(`click`)},Y=()=>{document.fullscreenElement?(document.exitFullscreen(),s.value=!1):(document.documentElement.requestFullscreen(),s.value=!0)},X=()=>{T&&(T.width(window.innerWidth),T.height(window.innerHeight),L())},Z=e=>{switch(e.code){case`Space`:e.preventDefault(),r.value?W():U();break;case`KeyR`:e.preventDefault(),K();break;case`KeyF`:e.preventDefault(),Y();break;case`KeyH`:e.preventDefault(),c.value=!c.value;break}};return d(async()=>{await l(),I(),window.addEventListener(`resize`,X),document.addEventListener(`keydown`,Z),document.addEventListener(`fullscreenchange`,()=>{s.value=!!document.fullscreenElement}),console.log(`GameApp 組件掛載完成`)}),f(()=>{q(),window.removeEventListener(`resize`,X),document.removeEventListener(`keydown`,Z),T?.destroy(),console.log(`GameApp 組件卸載完成`)}),(t,n)=>(p(),o(`div`,Pe,[c.value?(p(),o(`div`,Fe,[i(`div`,Ie,[i(`div`,Le,[n[1]||=i(`span`,{class:`label`},`時間`,-1),i(`span`,{class:u([`value`,{warning:b.value<10}])},_(b.value)+`s`,3)]),i(`div`,Re,[n[2]||=i(`span`,{class:`label`},`分數`,-1),i(`span`,ze,_(y.value),1)]),i(`div`,Be,[n[3]||=i(`span`,{class:`label`},`命中率`,-1),i(`span`,Ve,_(j.value)+`%`,1)])]),i(`div`,He,[i(`button`,{onClick:U,disabled:r.value,class:`btn primary`},_(r.value?`遊戲中`:`開始`),9,Ue),i(`button`,{onClick:W,disabled:!r.value,class:`btn`},`停止`,8,We),i(`button`,{onClick:K,class:`btn`},`重置`),i(`button`,{onClick:Y,class:`btn`},_(s.value?`退出全螢幕`:`全螢幕`),1)]),i(`div`,Ge,[n[4]||=i(`span`,{class:`label`},`難度:`,-1),(p(),o(e,null,g(5,e=>i(`button`,{key:e,onClick:t=>J(e),class:u([{active:C.value===e},`level-btn`])},_(e),11,Ke)),64))])])):a(``,!0),i(`button`,{onClick:n[0]||=e=>c.value=!c.value,class:`toggle-btn`},_(c.value?`隱藏`:`顯示`),1),i(`div`,{ref_key:`gameCanvas`,ref:w,class:`game-canvas`},null,512),!r.value&&!s.value?(p(),o(`div`,qe,n[5]||=[i(`h3`,null,`遊戲說明`,-1),i(`p`,null,`🎯 點擊白色方塊得 1 分`,-1),i(`p`,null,`🏆 點擊金色方塊得 5 分`,-1),i(`p`,null,`❌ 點擊紅色方塊扣 2 分`,-1),i(`p`,null,`⏰ 方塊會在時間到時消失`,-1)])):a(``,!0),v.value?(p(),o(`div`,Je,[i(`div`,Ye,[n[6]||=i(`h2`,null,`遊戲結束!`,-1),i(`div`,Xe,`最終分數: `+_(y.value),1),i(`div`,Ze,[i(`div`,null,`總方塊數: `+_(S.value),1),i(`div`,null,`命中方塊: `+_(x.value),1),i(`div`,null,`命中率: `+_(j.value)+`%`,1)]),i(`button`,{onClick:K,class:`btn primary`},`再玩一次`)])])):a(``,!0)]))}}),$e=t(Qe,[[`__scopeId`,`data-v-365e55d7`]]);const et=r($e);et.use(s()),et.mount(`#app`);